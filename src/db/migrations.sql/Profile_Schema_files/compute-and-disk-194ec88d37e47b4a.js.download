try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="0e79bf41-58d2-4847-acf6-9fddd6ad0bdd",e._sentryDebugIdIdentifier="sentry-dbid-0e79bf41-58d2-4847-acf6-9fddd6ad0bdd")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[12421],{18065:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ti});var s=a(80263),i=a(32981),r=a(60045),n=a(88712),l=a(97507),o=a(76196),d=a(53239),c=a(87494),u=a(73969),m=a(22891),p=a(37873),h=a(41273),f=a(86541),x=a(86549),g=a(16294),y=a(56947),v=a(24523),b=a(30659);async function j(e,t){let{projectRef:a}=e;if(!a)throw Error("Project ref is required");let{data:s,error:i}=await (0,v.Jt)("/platform/projects/{ref}/disk/custom-config",{params:{path:{ref:a}},signal:t});return i&&(0,v.H4)(i),s}let S=function(e){let{projectRef:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.I)({queryKey:b.n.diskAutoscaleConfig(t),queryFn:e=>{let{signal:a}=e;return j({projectRef:t},a)},enabled:a&&void 0!==t,...s})};var N=a(32144),w=a(80251);async function z(e){let{projectRef:t,growthPercent:a,maxSizeGb:s,minIncrementGb:i}=e;if(!t)throw Error("projectRef is required");let{data:r,error:n}=await (0,v.bE)("/platform/projects/{ref}/disk/custom-config",{params:{path:{ref:t}},body:{growth_percent:a,max_size_gb:s,min_increment_gb:i}});return n&&(0,v.H4)(n),r}let k=function(){let{onSuccess:e,onError:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,N.jE)();return(0,w.n)({mutationFn:e=>z(e),async onSuccess(t,a,i){let{projectRef:r}=a;await s.invalidateQueries({queryKey:b.n.diskAutoscaleConfig(r)}),await (null==e?void 0:e(t,a,i))},async onError(e,a,s){void 0===t?u.oR.error("Failed to update disk autoscale config: ".concat(e.message)):t(e,a,s)},...a})};async function P(e,t){let{projectRef:a}=e;if(!a)throw Error("Project ref is required");let{data:s,error:i}=await (0,v.Jt)("/platform/projects/{ref}/disk/util",{params:{path:{ref:a}},signal:t});return i&&(0,v.H4)(i),s}let I=function(e){let{projectRef:t}=e,{enabled:a=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.I)({queryKey:b.n.diskUtilization(t),queryFn:e=>{let{signal:a}=e;return P({projectRef:t},a)},enabled:a&&void 0!==t,...s})};var _=a(37115),D=a(63351),T=a(31805),V=a(78937),C=a(55139),M=a(80090),A=a(84512),R=a(9620),O=a(85039),B=a(65887),F=a(75878),G=a(66755),E=a(80100),L=a(99779),q=a(44725),Z=a(21650);let Y=e=>{let{formState:t}=e;return(0,s.jsx)(n.N,{mode:"wait","data-sentry-element":"AnimatePresence","data-sentry-component":"FormFooterChangeBadge","data-sentry-source-file":"FormFooterChangeBadge.tsx",children:Object.keys(t.dirtyFields).length>0&&(0,s.jsx)(l.P.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.2},children:(0,s.jsx)(l.P.div,{animate:{scale:[1,1.05,1],transition:{duration:.3}},children:(0,s.jsx)(Z.E,{variant:"default",children:(0,s.jsx)(l.P.span,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.1},className:"text-sm",children:1===Object.keys(t.dirtyFields).length?"1 change to review":"".concat(Object.keys(t.dirtyFields).length," changes to review")},Object.keys(t.dirtyFields).length)})})})})};var H=a(10663),U=a(63324),W=a(40029),J=a(28667);let $=H.Ik({storageType:H.k5(["io2","gp3"]).describe("Type of storage: io2 or gp3"),totalSize:H.ai().int("Value must be an integer").describe("Allocated disk size in GB"),provisionedIOPS:H.ai().describe("Provisioned IOPS for storage type"),throughput:H.ai().optional().describe("Throughput in MB/s for gp3"),computeSize:H.Ie(e=>!0).describe("Compute size"),growthPercent:H.ai().int("Value must be an integer").min(10,"Growth percent must be at least 10%").max(100,"Growth percent cannot exceed 100%").optional().nullable(),minIncrementGb:H.ai().int("Value must be an integer").min(1,"Minimum increment must be at least 1 GB").max(200,"Minimum increment cannot exceed 200 GB").optional().nullable(),maxSizeGb:H.ai().int("Value must be an integer").max(6e4,"Maximum size cannot exceed 60TB").optional().nullable()});var Q=a(49697),X=a(95137),K=a(60793);let ee=e=>{let{visible:t,title:a,description:i}=e;return(0,s.jsx)(n.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskMangementRestartRequiredSection","data-sentry-source-file":"DiskManagementRestartRequiredSection.tsx",children:t&&(0,s.jsx)(l.P.div,{initial:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15},className:"w-full",children:(0,s.jsxs)(X.OO,{className:"bg-surface-100 text-sm text-foreground-light flex items-center gap-4 relative w-full rounded-md border-spacing-0 border",children:[(0,s.jsx)("div",{className:"w-12 h-12",children:(0,s.jsxs)("div",{className:"relative w-10 h-10 m-1 bg-alternative text-foreground border rounded-full flex items-center justify-center",children:[(0,s.jsx)(Q.A,{strokeWidth:1}),(0,s.jsx)(K.id,{className:"absolute -right-1.5 -top-1.5"})]})}),(0,s.jsxs)("div",{className:"flex flex-col gap-0 flex-grow",children:[(0,s.jsx)("p",{className:"text-sm text-foreground",children:a}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:i})]})]})})})};var et=a(23729),ea=a(6436),es=a(78511),ei=a(20033),er=a(30404);let en=e=>{let{beforePrice:t,afterPrice:a,show:i,tooltip:r,className:d,free:c}=e;return(0,s.jsx)(n.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"BillingChangeBadge","data-sentry-source-file":"BillingChangeBadge.tsx",children:void 0!==t&&void 0!==a&&i&&(0,s.jsx)(l.P.div,{initial:{opacity:0,x:-4,height:0},animate:{opacity:1,x:0,height:"auto"},exit:{opacity:0,x:-4,height:0},transition:{type:"spring",stiffness:800,damping:40,duration:.3},children:(0,s.jsx)(Z.E,{variant:"default",className:(0,E.cn)(c?"bg-violet-200 border-violet-900 text-violet-1100":"bg-alternative","bg-opacity-100 text-warning",d),children:(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-xs font-mono text-foreground-muted",translate:"no",children:(0,ea.vv)(t)}),(0,s.jsx)(o.A,{size:12,strokeWidth:2,className:"text-foreground-muted"}),(0,s.jsx)(l.P.span,{className:(0,E.cn)(c?"text-violet-1100":"text-foreground","text-xs font-mono"),animate:{scale:[1,1.1,1]},transition:{duration:.12},translate:"no",children:"".concat((0,ea.vv)(a),"/month")},a)]})}),void 0!==r&&(0,s.jsx)(er.ZI,{side:"bottom",children:r})]})})})})};var el=a(22223),eo=a(89584),ed=a(22830),ec=a(48555);let eu={timeRemaining:{label:"timeRemaining",color:"hsl(var(--warning-default))"},hand:{label:"hand",color:"hsl(var(--warning-default))"}},em=e=>{let{progress:t}=e;return(0,s.jsxs)("div",{className:"relative w-12 h-12","data-sentry-component":"CountdownTimerRadial","data-sentry-source-file":"CountdownTimerRadial.tsx",children:[(0,s.jsx)(ec.at,{config:eu,className:"absolute w-12 h-12","data-sentry-element":"ChartContainer","data-sentry-source-file":"CountdownTimerRadial.tsx",children:(0,s.jsxs)(el.D,{data:[{timeRemaining:100,fill:"var(--color-timeRemaining)"}],startAngle:90,endAngle:90-360*t/100,innerRadius:21,outerRadius:14,"data-sentry-element":"RadialBarChart","data-sentry-source-file":"CountdownTimerRadial.tsx",children:[(0,s.jsx)(eo.z,{gridType:"circle",radialLines:!1,stroke:"none",className:"first:fill-foreground-muted/50 last:fill-background-200",polarRadius:[16,11],"data-sentry-element":"PolarGrid","data-sentry-source-file":"CountdownTimerRadial.tsx"}),(0,s.jsx)(ed.Z,{dataKey:"timeRemaining",cornerRadius:2,"data-sentry-element":"RadialBar","data-sentry-source-file":"CountdownTimerRadial.tsx"})]})}),(0,s.jsx)(ec.at,{config:eu,className:"absolute top-1 left-1 w-10 h-10","data-sentry-element":"ChartContainer","data-sentry-source-file":"CountdownTimerRadial.tsx",children:(0,s.jsx)(el.D,{data:[{hand:100,fill:"var(--color-hand)"}],startAngle:80-360*t/100,endAngle:140-360*t/100,innerRadius:14,outerRadius:5,"data-sentry-element":"RadialBarChart","data-sentry-source-file":"CountdownTimerRadial.tsx",children:(0,s.jsx)(ed.Z,{dataKey:"hand",cornerRadius:2,isAnimationActive:!0,"data-sentry-element":"RadialBar","data-sentry-source-file":"CountdownTimerRadial.tsx"})})})]})},ep=e=>{let{visible:t}=e,[a,i]=(0,d.useState)(100),[r,o]=(0,d.useState)(!1),[c,u]=(0,d.useState)(!1);return(0,d.useEffect)(()=>{let e=()=>{o(!0),i(100);let t=setInterval(()=>{i(a=>a<=0?(clearInterval(t),u(!0),setTimeout(()=>{u(!1),i(100),e()},300),0):a-1)},100);return()=>clearInterval(t)},t=setTimeout(e,1e3);return()=>clearTimeout(t)},[]),(0,s.jsx)(n.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskMangementCoolDownSection","data-sentry-source-file":"DiskManagementCoolDownSection.tsx",children:t&&(0,s.jsx)(l.P.div,{initial:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15},className:"w-full",children:(0,s.jsxs)(X.OO,{className:"bg-surface-100 text-sm text-foreground-light flex items-center gap-4 relative w-full border rounded-md",children:[(0,s.jsx)("div",{className:"w-12 h-12",children:(0,s.jsx)(n.N,{children:r&&(0,s.jsx)(l.P.div,{initial:{scale:.8,opacity:0,y:-8},animate:{scale:c?1.2:1,opacity:1,y:c?-8:0},exit:{scale:.8,opacity:0,y:-8},transition:{duration:c?.3:.8,type:"spring",bounce:.6},children:(0,s.jsx)(em,{progress:a})},"countdown-timer")})}),(0,s.jsxs)("div",{className:"flex flex-col gap-0 flex-grow",children:[(0,s.jsx)("p",{className:"text-sm text-foreground",children:"For 6 hours you will not be able to change any disk attributes."}),(0,s.jsx)("p",{className:"text-sm text-foreground-light",children:"There is a cooldown period enforced for any disk attribute modifications"})]})]})})})},eh=()=>(0,s.jsxs)(es.Hj,{"data-sentry-element":"TableRow","data-sentry-component":"TableHeaderRow","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,s.jsx)(es.nd,{className:"w-[140px] pl-5","data-sentry-element":"TableHead","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Disk attribute"}),(0,s.jsx)(es.nd,{className:"text-right","data-sentry-element":"TableHead","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"-"}),(0,s.jsx)(es.nd,{className:"w-[100px]","data-sentry-element":"TableHead","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Unit"}),(0,s.jsx)(es.nd,{className:"text-right pr-5","data-sentry-element":"TableHead","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Price Change"})]}),ef=e=>{let{attribute:t,defaultValue:a,newValue:i,unit:r,beforePrice:n,afterPrice:l,hidePrice:d=!1,priceTooltip:c,upgradeIncluded:u=!1}=e;return(0,s.jsxs)(es.Hj,{"data-sentry-element":"TableRow","data-sentry-component":"TableDataRow","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,s.jsx)(es.nA,{className:"pl-5","data-sentry-element":"TableCell","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:(0,s.jsx)("div",{className:"flex flex-row gap-2 items-center",children:(0,s.jsx)("span",{children:t})})}),(0,s.jsx)(es.nA,{className:"text-right font-mono","data-sentry-element":"TableCell","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:a!==i?(0,s.jsx)(Z.E,{variant:"default",className:"bg-alternative bg-opacity-100",children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-xs font-mono text-foreground-muted",children:a.toString()}),(0,s.jsx)(o.A,{size:12,strokeWidth:2,className:"text-foreground-muted"}),(0,s.jsx)("span",{className:"text-xs font-mono text-foreground",children:i.toString()})]})}):(0,s.jsxs)("span",{className:"text-xs font-mono",children:[(0,s.jsx)("span",{className:"text-foreground-muted"}),a]})}),(0,s.jsx)(es.nA,{className:"text-xs font-mono","data-sentry-element":"TableCell","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:r}),(0,s.jsx)(es.nA,{className:"text-right pr-5","data-sentry-element":"TableCell","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:!u&&d?(0,s.jsx)("span",{className:"text-xs font-mono",children:"-"}):n!==l||u?(0,s.jsx)(en,{show:!0,beforePrice:n,afterPrice:l,tooltip:c,free:u}):(0,s.jsx)("span",{className:"text-xs font-mono",translate:"no",children:(0,ea.vv)(n)})})]})},ex=e=>{var t,a,i,n,l,o,c,u,m,p,h,f,x,g,y,v,b,j,S,N,w,z,k,P,I,_,D,T,C,O,B,F,G,E,q,Z,Y,H,U,$,Q,ea,er,en;let{isDialogOpen:el,setIsDialogOpen:eo,disabled:ed,form:ec,numReplicas:eu,loading:em,onSubmit:ex,message:eg,buttonSize:ey="medium"}=e,{data:ev}=(0,R.YA)(),{data:eb}=(0,A.s)(),ej=(0,R.br)(),{formState:eS,getValues:eN}=ec,{can:ew}=(0,M.Qp)(r.aG.UPDATE,"projects",{resource:{project_id:null==ev?void 0:ev.id}}),{data:ez}=(0,V.Q)({projectRef:null==ev?void 0:ev.ref}),ek=null!=(B=null==eb?void 0:eb.plan.id)?B:"free",eP=!!Object.keys(ec.formState.dirtyFields).length,eI="Price change includes primary database and ".concat(eu," replica").concat(eu>1?"s":""),e_=(0,d.useMemo)(()=>{var e;return null!=(e=null==ez?void 0:ez.available_addons)?e:[]},[ez]),eD=(0,d.useMemo)(()=>(0,W.$C)(e_,null==ev?void 0:ev.cloud_provider),[e_,null==ev?void 0:ev.cloud_provider]),eT=(0,W.Uk)({availableOptions:eD,oldComputeSize:(null==(t=ec.formState.defaultValues)?void 0:t.computeSize)||"ci_micro",newComputeSize:ec.getValues("computeSize"),plan:null!=(F=null==eb?void 0:eb.plan.id)?F:"free"}),eV=(0,W.WC)({planId:ek,oldSize:(null==(a=eS.defaultValues)?void 0:a.totalSize)||0,oldStorageType:null==(i=eS.defaultValues)?void 0:i.storageType,newSize:eN("totalSize"),newStorageType:eN("storageType"),numReplicas:eu}),eC=(0,W.t5)({oldStorageType:null==(n=ec.formState.defaultValues)?void 0:n.storageType,oldProvisionedIOPS:(null==(l=ec.formState.defaultValues)?void 0:l.provisionedIOPS)||0,newStorageType:ec.getValues("storageType"),newProvisionedIOPS:ec.getValues("provisionedIOPS"),numReplicas:eu}),eM=(0,W.ou)({storageType:ec.getValues("storageType"),newThroughput:ec.getValues("throughput")||0,oldThroughput:(null==(o=ec.formState.defaultValues)?void 0:o.throughput)||0,numReplicas:eu}),eA=(null==(c=ec.formState.defaultValues)?void 0:c.computeSize)!==ec.getValues("computeSize"),eR=!ej&&(null==(u=ec.formState.defaultValues)?void 0:u.totalSize)!==ec.getValues("totalSize"),eO=!ej&&(null==(m=ec.formState.defaultValues)?void 0:m.storageType)!==ec.getValues("storageType"),eB=!ej&&(null==(p=ec.formState.defaultValues)?void 0:p.throughput)!==ec.getValues("throughput"),eF=!ej&&(null==(h=ec.formState.defaultValues)?void 0:h.provisionedIOPS)!==ec.getValues("provisionedIOPS"),eG=!ej&&(null==(f=ec.formState.defaultValues)?void 0:f.growthPercent)!==ec.getValues("growthPercent"),eE=!ej&&(null==(x=ec.formState.defaultValues)?void 0:x.minIncrementGb)!==ec.getValues("minIncrementGb"),eL=!ej&&(null==(g=ec.formState.defaultValues)?void 0:g.maxSizeGb)!==ec.getValues("maxSizeGb"),eq=eF||eB&&"gp3"===ec.getValues("storageType")||eR;return(0,s.jsxs)(X.lG,{open:el,onOpenChange:eo,"data-sentry-element":"Dialog","data-sentry-component":"DiskManagementReviewAndSubmitDialog","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,s.jsx)(X.zM,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:(0,s.jsx)(et.G,{size:ey,htmlType:"submit",type:"primary",onClick:async e=>{e.preventDefault(),await ec.trigger()&&eo(!0)},disabled:ed||!eP,tooltip:{content:{side:"bottom",text:ew?ed?"Current form values are invalid":void 0:"You need additional permissions to update disk configuration"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Review changes"})}),(0,s.jsxs)(X.Cf,{className:"min-w-[620px]","data-sentry-element":"DialogContent","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,s.jsxs)(X.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,s.jsx)(X.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Review changes"}),(0,s.jsx)(X.rr,{"data-sentry-element":"DialogDescription","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Changes will be applied shortly once confirmed."})]}),(0,s.jsx)(X.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx"}),(eA||eq)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-2 p-5",children:[(0,s.jsx)(ee,{visible:eA,title:"Resizing your Compute will trigger a project restart",description:"Project will restart automatically on confirmation."}),(0,s.jsx)(ep,{visible:eq})]}),(0,s.jsx)(X.pf,{})]}),(0,s.jsxs)(es.XI,{"data-sentry-element":"Table","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,s.jsx)(es.A0,{className:"font-mono uppercase text-xs [&_th]:h-auto [&_th]:pb-2 [&_th]:pt-4","data-sentry-element":"TableHeader","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:(0,s.jsx)(eh,{"data-sentry-element":"TableHeaderRow","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx"})}),(0,s.jsxs)(es.BF,{className:"[&_td]:py-0 [&_tr]:h-[50px] [&_tr]:border-dotted","data-sentry-element":"TableBody","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[eA&&(0,s.jsx)(ef,{attribute:"Compute size",defaultValue:(0,W.ku)(null!=(G=null==(y=ec.formState.defaultValues)?void 0:y.computeSize)?G:"ci_nano"),newValue:(0,W.ku)(ec.getValues("computeSize")),unit:"-",beforePrice:Number(eT.oldPrice),afterPrice:Number(eT.newPrice),upgradeIncluded:(null==eb?void 0:eb.plan.id)!=="free"&&(null==ev?void 0:ev.infra_compute_size)==="nano"&&"ci_micro"===ec.getValues("computeSize")}),eO&&(0,s.jsx)(ef,{hidePrice:!0,attribute:"Storage Type",defaultValue:null!=(E=null==(v=ec.formState.defaultValues)?void 0:v.storageType)?E:"",newValue:ec.getValues("storageType"),unit:"-",beforePrice:0,afterPrice:0}),(eF||eO)&&(0,s.jsx)(ef,{attribute:"IOPS",defaultValue:null!=(q=null==(j=ec.formState.defaultValues)||null==(b=j.provisionedIOPS)?void 0:b.toLocaleString())?q:0,newValue:null==(S=ec.getValues("provisionedIOPS"))?void 0:S.toLocaleString(),unit:"IOPS",beforePrice:Number(eC.oldPrice),afterPrice:Number(eC.newPrice),priceTooltip:eu>0?eI:void 0}),"gp3"===ec.getValues("storageType")&&eB&&(0,s.jsx)(ef,{attribute:"Throughput",defaultValue:null!=(Z=null==(w=ec.formState.defaultValues)||null==(N=w.throughput)?void 0:N.toLocaleString())?Z:0,newValue:null!=(Y=null==(z=ec.getValues("throughput"))?void 0:z.toLocaleString())?Y:0,unit:"MB/s",beforePrice:Number(eM.oldPrice),afterPrice:Number(eM.newPrice),priceTooltip:eu>0?eI:void 0}),(eR||eO)&&(0,s.jsx)(ef,{attribute:"Disk size",defaultValue:null!=(H=null==(P=ec.formState.defaultValues)||null==(k=P.totalSize)?void 0:k.toLocaleString())?H:0,newValue:null==(I=ec.getValues("totalSize"))?void 0:I.toLocaleString(),unit:"GB",beforePrice:Number(eV.oldPrice),afterPrice:Number(eV.newPrice),priceTooltip:eu>0?eI:void 0}),eG&&(0,s.jsx)(ef,{attribute:"Growth percent",defaultValue:null!=(U=null==(_=ec.formState.defaultValues)?void 0:_.growthPercent)?U:J.SZ.growthPercent,newValue:null!=($=ec.getValues("growthPercent"))?$:J.SZ.growthPercent,unit:"%",beforePrice:0,afterPrice:0}),eE&&(0,s.jsx)(ef,{attribute:"Min increment",defaultValue:null!=(Q=null==(D=ec.formState.defaultValues)?void 0:D.minIncrementGb)?Q:J.SZ.minIncrementSize,newValue:null!=(ea=ec.getValues("minIncrementGb"))?ea:J.SZ.minIncrementSize,unit:"GB",beforePrice:0,afterPrice:0}),eL&&(0,s.jsx)(ef,{attribute:"Max disk size",defaultValue:null!=(er=null==(C=ec.formState.defaultValues)||null==(T=C.maxSizeGb)?void 0:T.toLocaleString())?er:J.SZ.maxSizeGb,newValue:null!=(en=null==(O=ec.getValues("maxSizeGb"))?void 0:O.toLocaleString())?en:J.SZ.maxSizeGb,unit:"GB",beforePrice:0,afterPrice:0})]})]}),eu>0&&(0,s.jsx)("div",{className:"border-t px-4 py-2 text-sm text-foreground-lighter",children:eI}),(0,s.jsxs)(X.Es,{"data-sentry-element":"DialogFooter","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:[(0,s.jsx)(L.$,{block:!0,size:"large",type:"default",onClick:()=>eo(!1),"data-sentry-element":"Button","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Cancel"}),(0,s.jsx)(L.$,{block:!0,type:"warning",size:"large",htmlType:"submit",loading:em,onClick:async()=>{await ex(ec.getValues())},"data-sentry-element":"Button","data-sentry-source-file":"DiskManagementReviewAndSubmitDialog.tsx",children:"Confirm changes"})]}),eg&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(X.pf,{}),(0,s.jsx)(X.OO,{children:(0,s.jsxs)(ei.Fc,{variant:"error"===eg.type?"destructive":"default",className:"",children:[(0,s.jsx)(K.id,{}),(0,s.jsx)(ei.XL,{children:eg.message})]})})]})]})]})};var eg=a(27371),ey=a(73640),ev=a(44053);let eb=function(e){let{message:t="error",type:a,children:i}=e;return(0,s.jsx)(n.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"FormMessage","data-sentry-source-file":"FormMessage.tsx",children:t&&(0,s.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:(0,s.jsx)(q.Z,{type:"error"===a?"destructive":"default",className:"mt-2",title:t,children:i})})})},ej=(0,d.forwardRef)((e,t)=>{let{children:a,label:i}=e;return(0,s.jsxs)("div",{ref:t,className:"flex -space-x-px",children:[a,(0,s.jsx)("div",{className:"border border-strong bg-surface-300 rounded-r-md px-3 flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-foreground-lighter text-xs font-mono",children:i})})]})});ej.displayName="InputPostTab";let eS=e=>{let{form:t}=e,{ref:a}=(0,m.g)(),{control:i,setValue:r,formState:{errors:n}}=t,{totalSize:l,growthPercent:o,maxSizeGb:d,minIncrementGb:c}=t.watch(),{error:u,isLoading:p,isError:h}=S({projectRef:a}),f=null!=o?o:J.SZ.growthPercent,x=null!=c?c:J.SZ.minIncrementSize,g=n.maxSizeGb?J.SZ.maxSizeGb:null!=d?d:J.SZ.maxSizeGb,y=Math.floor(f/100*l),v=Math.min(Math.max(Math.floor(l*f/100),x),200)+l,b=v<g?v:g,j=b-l;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(B.zB,{name:"growthPercent",control:i,render:e=>{var t;let{field:a}=e;return(0,s.jsxs)(ev.M,{layout:"horizontal",label:"Autoscale growth percent",id:a.name,labelOptional:"Percentage of current disk size to grow",description:n.growthPercent?void 0:"This amounts to ".concat(y," GB based on the current disk size of ").concat(l," GB"),className:"[&>div>span]:text-foreground-lighter",children:[(0,s.jsx)(ej,{label:"%",children:p?(0,s.jsx)("div",{className:(0,E.cn)((0,eg.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,s.jsx)(ey.E,{className:"w-10 h-4"})}):(0,s.jsx)(B.MJ,{children:(0,s.jsx)(eg.p,{...a,type:"number",className:"flex-grow font-mono rounded-r-none max-w-20",value:null!=(t=a.value)?t:void 0,disabled:h,onChange:e=>{r("growthPercent",""===e.target.value?null:e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})},placeholder:String(J.SZ.growthPercent)})})}),u&&(0,s.jsx)(eb,{type:"error",message:u.message})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"AutoScaleFields.tsx"}),(0,s.jsx)(B.zB,{name:"minIncrementGb",control:i,render:e=>{var t;let{field:a}=e;return(0,s.jsxs)(ev.M,{layout:"horizontal",label:"Minimum increment",id:a.name,labelOptional:"Minimum value to autoscale disk size by",description:c&&c>y&&!n.minIncrementGb?"This value takes precedence as the minimum increment is larger than the growth percent":void 0,className:"[&>div>span]:text-foreground-lighter",children:[(0,s.jsx)(ej,{label:"GB",children:p?(0,s.jsx)("div",{className:(0,E.cn)((0,eg.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,s.jsx)(ey.E,{className:"w-10 h-4"})}):(0,s.jsx)(B.MJ,{children:(0,s.jsx)(eg.p,{...a,type:"number",className:"flex-grow font-mono rounded-r-none max-w-32",value:null!=(t=a.value)?t:void 0,disabled:h,onChange:e=>{r("minIncrementGb",""===e.target.value?null:e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})},placeholder:String(J.SZ.minIncrementSize)})})}),u&&(0,s.jsx)(eb,{type:"error",message:u.message})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"AutoScaleFields.tsx"}),(0,s.jsx)(B.zB,{name:"maxSizeGb",control:i,render:e=>{var t;let{field:a}=e;return(0,s.jsxs)(ev.M,{layout:"horizontal",label:"Maximum disk size",id:a.name,labelOptional:"Maximum size that the disk can grow to",className:"[&>div>span]:text-foreground-lighter",children:[(0,s.jsx)(ej,{label:"GB",children:p?(0,s.jsx)("div",{className:(0,E.cn)((0,eg.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,s.jsx)(ey.E,{className:"w-10 h-4"})}):(0,s.jsx)(B.MJ,{children:(0,s.jsx)(eg.p,{...a,type:"number",className:"flex-grow font-mono rounded-r-none max-w-32",value:null!=(t=a.value)?t:void 0,disabled:h,onChange:e=>{r("maxSizeGb",""===e.target.value?null:e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})},placeholder:String(J.SZ.maxSizeGb)})})}),u&&(0,s.jsx)(eb,{type:"error",message:u.message})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"AutoScaleFields.tsx"}),(0,s.jsxs)(q.Z,{type:"default",showIcon:!1,className:"[&>div]:text-foreground-light",children:["Disk size will automatically be expanded by"," ",(0,s.jsxs)("span",{className:"text-foreground",children:[String(j).length>4?j.toFixed(2):j," ","GB"]})," ","to a total of ",(0,s.jsxs)("span",{className:"text-foreground",children:[b," GB"]})," ","when the database reaches 90% of the disk size"]})]})};var eN=a(11743),ew=a(25422),ez=a(82270),ek=a(27695),eP=a(10723),eI=a(2657),e_=a(56217),eD=a(21290),eT=a(6538),eV=a(12487);function eC(e){var t,a,i,n;let{form:l,disabled:o}=e,{ref:c}=(0,m.g)(),{data:u}=(0,A.s)(),{data:p,isLoading:f}=(0,R.YA)(),x=(0,eI.x)("project_addons:show_compute_price"),{computeSize:g,storageType:y}=l.watch(),{data:v,isLoading:b,error:j}=(0,V.Q)({projectRef:c}),S=f||b,{control:N,formState:w,setValue:z,trigger:k}=l,P=(0,d.useMemo)(()=>{var e;return null!=(e=null==v?void 0:v.available_addons)?e:[]},[v]),I=(0,d.useMemo)(()=>(0,W.$C)(P,null==p?void 0:p.cloud_provider),[P,null==p?void 0:p.cloud_provider]),_=null==v?void 0:v.selected_addons.find(e=>"pitr"===e.type),D=(0,W.Uk)({availableOptions:I,oldComputeSize:(null==(t=l.formState.defaultValues)?void 0:t.computeSize)||"ci_micro",newComputeSize:l.getValues("computeSize"),plan:null!=(a=null==u?void 0:u.plan.id)?a:"free"}),T=(0,W.QV)(null!=(i=null==u?void 0:u.plan.id)?i:"free",null!=(n=null==p?void 0:p.infra_compute_size)?n:"nano");return(0,s.jsx)(B.zB,{name:"computeSize",control:N,render:e=>{let{field:t}=e;return(0,s.jsx)(eD.p,{...t,onValueChange:e=>{z("computeSize",e,{shouldDirty:!0,shouldValidate:!0}),k("provisionedIOPS"),k("throughput")},defaultValue:t.value,disabled:o,children:(0,s.jsx)(ev.M,{layout:"horizontal",label:"Compute size",id:t.name,className:"gap-5",labelOptional:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(en,{className:"mb-2",show:w.isDirty&&w.dirtyFields.computeSize&&!w.errors.computeSize,beforePrice:Number(D.oldPrice),afterPrice:Number(D.newPrice),free:!!T&&"ci_micro"===g}),(0,s.jsx)("p",{className:"text-foreground-lighter",children:"Hardware resources allocated to your Postgres database"}),(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsx)(h.A,{abbrev:!1,href:"".concat(O.aq,"/guides/platform/compute-and-disk")})}),(0,s.jsx)(eV.Y,{showIcon:!1,type:"default",className:"mt-3 border-violet-900 bg-violet-200 [&_h5]:text-violet-1100",visible:T&&"ci_nano"===l.watch("computeSize"),title:"Upgrade to Micro Compute",description:"This Project is already paying for Micro Compute. You can upgrade to Micro Compute at any time when convenient."})]}),children:(0,s.jsx)("div",{className:j?"":"grid gap-4 grid-cols-[repeat(auto-fit,minmax(min(100%,13em),1fr))]",children:S?Array(10).fill(0).map((e,t)=>(0,s.jsx)(ey.E,{className:"w-full h-[110px] rounded-md"},t)):j?(0,s.jsx)(eb,{message:"Failed to load Compute size options",type:"error",children:(0,s.jsx)("p",{children:null==j?void 0:j.message})}):(0,s.jsxs)(s.Fragment,{children:[I.map(e=>{var t,a,i,r,n,l;let d=(0,e_.g)(null==p?void 0:p.cloud_provider),c="ci_micro"===e.identifier&&!!_,m=(null==u?void 0:u.plan.id)!=="free"&&(null==p?void 0:p.infra_compute_size)!=="nano"&&"ci_nano"===e.identifier||c,h=(null==u?void 0:u.plan.id)!=="free"&&(null==p?void 0:p.infra_compute_size)==="nano"&&"ci_nano"===e.identifier?null==(t=I.find(e=>"ci_micro"===e.identifier))?void 0:t.price:e.price;return(0,s.jsx)(eD.e,{showIndicator:!1,id:e.identifier,value:e.identifier,className:(0,E.cn)("relative text-sm text-left flex flex-col gap-0 px-0 py-3 [&_label]:w-full group] w-full h-[110px]",m&&"opacity-50"),disabled:o||m,label:(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsxs)("div",{children:[T&&"ci_micro"===e.identifier&&(0,s.jsx)("div",{className:"absolute -top-4 -right-3 text-violet-1100 flex items-center gap-1 bg-surface-75 py-0.5 px-2 rounded-full border border-violet-900",children:(0,s.jsx)("span",{children:"No additional charge"})}),(0,s.jsxs)("div",{className:"w-full flex flex-col gap-3 justify-between",children:[(0,s.jsxs)("div",{className:"relative px-3 opacity-50 group-data-[state=checked]:opacity-100 flex justify-between",children:[(0,s.jsx)(eT.R,{className:"inline-flex font-semibold",infraComputeSize:e.name}),(0,s.jsx)("div",{className:"flex items-center space-x-1",children:m?(0,s.jsx)("div",{className:"bg border rounded-lg h-7 w-7 flex items-center justify-center",children:(0,s.jsx)(eN.A,{size:14})}):x&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"text-foreground text-sm font-semibold",translate:"no",children:["$",h]}),(0,s.jsxs)("span",{className:"text-foreground-light translate-y-[1px]",children:[" ","/"," ","monthly"===e.price_interval?"month":"hour"]})]})})]}),(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("div",{className:"px-3 text-sm flex flex-col gap-1",children:[(0,s.jsxs)("div",{className:"text-foreground-light flex gap-2 items-center",children:[(0,s.jsx)(ew.A,{strokeWidth:1,size:14,className:"text-foreground-lighter"}),(0,s.jsxs)("span",{children:["ci_nano"===e.identifier&&"Up to ",null!=(n=null==(a=e.meta)?void 0:a.memory_gb)?n:0," GB memory"]})]}),(0,s.jsxs)("div",{className:"text-foreground-light flex gap-2 items-center",children:[(0,s.jsx)(ez.A,{strokeWidth:1,size:14,className:"text-foreground-lighter"}),(0,s.jsxs)("span",{children:[null!=(l=null==(i=e.meta)?void 0:i.cpu_cores)?l:0,(null==(r=e.meta)?void 0:r.cpu_cores)!=="Shared"&&"-core ".concat(d)," ","CPU"]})]})]})})]})]})}),c&&(0,s.jsxs)(er.ZI,{side:"bottom",className:"w-64 text-center",children:["Project has PITR enabled which requires a minimum of Small compute. Please"," ",(0,s.jsx)(eP.g,{href:"/project/_/settings/addons?panel=pitr",children:"disable PITR"})," ","first before selecting Micro"]})]})},e.identifier)}),(0,s.jsx)(eD.e,{id:"larger-compute",showIndicator:!1,value:"larger-compute",onClick:e=>e.preventDefault(),className:(0,E.cn)("relative text-sm text-left flex flex-col gap-0 px-0 py-3 [&_label]:w-full group] w-full h-[110px]"),label:(0,s.jsx)(ek.Y,{queryParams:{projectRef:c,category:r.S.SALES_ENQUIRY,subject:"Enquiry about larger instance sizes"},children:(0,s.jsxs)("div",{className:"w-full flex flex-col gap-3 justify-between",children:[(0,s.jsxs)("div",{className:"relative px-3 flex justify-between",children:[(0,s.jsx)(eT.R,{infraComputeSize:">16XL"}),(0,s.jsx)("div",{className:"flex items-center space-x-1 opacity-50 ",children:(0,s.jsx)("span",{className:"text-foreground-light text-sm",children:"Contact Us"})})]}),(0,s.jsx)("div",{className:"w-full",children:(0,s.jsxs)("div",{className:"px-3 text-sm flex flex-col gap-1",children:[(0,s.jsxs)("div",{className:"text-foreground-light flex gap-2 items-center",children:[(0,s.jsx)(ew.A,{strokeWidth:1,size:14,className:"text-foreground-lighter"}),(0,s.jsx)("span",{children:"Custom memory"})]}),(0,s.jsxs)("div",{className:"text-foreground-light flex gap-2 items-center",children:[(0,s.jsx)(ez.A,{strokeWidth:1,size:14,className:"text-foreground-lighter"}),(0,s.jsx)("span",{children:"Custom CPU"})]})]})})]})})},"larger-compute")]})})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-component":"ComputeSizeField","data-sentry-source-file":"ComputeSizeField.tsx"})}var eM=a(53434),eA=a.n(eM),eR=a(59129);let eO=e=>{var t,a;let{isDirty:i,totalSize:r,usedSize:o,newTotalSize:d,oldStorageType:c,newStorageType:u}=e,{ref:p}=(0,m.g)(),{data:h}=(0,D.Vh)({projectRef:p}),f=(null!=h?h:[]).filter(e=>e.identifier!==p),x=r*(null==(t=J.zN[c])?void 0:t.storage),g=d*(null==(a=J.zN[u])?void 0:a.storage);return 0===f.length?null:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(n.N,{"data-sentry-element":"AnimatePresence","data-sentry-source-file":"DiskManagementReadReplicas.tsx",children:i&&(0,s.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:(0,s.jsxs)(ei.Fc,{variant:"default",className:"bg-transparent",children:[(0,s.jsx)(K.mo,{}),(0,s.jsx)(ei.XL,{children:"Read replicas are provisioned with extra 25% disk size to account for WAL files"}),(0,s.jsxs)(ei.TN,{children:["Each replica will have a disk size of ",d,"GB, and are billed separately",(0,s.jsx)("ul",{className:"list-disc pl-4 my-3 flex flex-col gap-2",children:f.map((e,t)=>(0,s.jsx)("li",{className:"marker:text-foreground-light",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{children:["ID: ",(0,eR.s)(e.identifier)," (",e.region,"):"]}),(0,s.jsx)(en,{show:!0,beforePrice:x,afterPrice:g})]})},t))})]})]})})})})},eB=e=>{var t,a,i,r;let{isDirty:o,oldIOPS:d,newIOPS:c,oldStorageType:u,newStorageType:p}=e,{ref:h}=(0,m.g)(),{data:f}=(0,D.Vh)({projectRef:h}),x=(null!=f?f:[]).filter(e=>e.identifier!==h),g=(d-(null==(t=J.No[u])?void 0:t.includedIops))*(null==(a=J.zN[u])?void 0:a.iops),y=(c-(null==(i=J.No[p])?void 0:i.includedIops))*(null==(r=J.zN[p])?void 0:r.iops);return 0===x.length?null:(0,s.jsx)(n.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskManagementIOPSReadReplicas","data-sentry-source-file":"DiskManagementReadReplicas.tsx",children:o&&(0,s.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:(0,s.jsxs)(ei.Fc,{variant:"default",className:"bg-transparent",children:[(0,s.jsx)(K.mo,{}),(0,s.jsx)(ei.XL,{children:"Read replica IOPS will also be updated to the same value"}),(0,s.jsx)(ei.TN,{children:(0,s.jsx)("ul",{className:"list-disc pl-4 my-3 flex flex-col gap-2",children:x.map((e,t)=>(0,s.jsx)("li",{className:"marker:text-foreground-light",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{children:["ID: ",(0,eR.s)(e.identifier)," (",e.region,"):"]}),(0,s.jsx)(en,{show:!0,beforePrice:g,afterPrice:y})]})},t))})})]})})})},eF=e=>{var t,a;let{isDirty:i,oldThroughput:r,newThroughput:o,oldStorageType:d,newStorageType:c}=e,{ref:u}=(0,m.g)(),{data:p}=(0,D.Vh)({projectRef:u}),h=(null!=p?p:[]).filter(e=>e.identifier!==u),f=d===J.y6.GP3?(r-J.No[d].includedThroughput)*(null==(t=J.zN[d])?void 0:t.throughput):0,x=c===J.y6.GP3?(o-J.No[c].includedThroughput)*(null==(a=J.zN[c])?void 0:a.throughput):0;return 0===h.length?null:(0,s.jsx)(n.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskManagementThroughputReadReplicas","data-sentry-source-file":"DiskManagementReadReplicas.tsx",children:i&&(0,s.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:(0,s.jsxs)(ei.Fc,{variant:"default",className:"bg-transparent",children:[(0,s.jsx)(K.mo,{}),(0,s.jsx)(ei.XL,{children:"Read replica throughput will also be updated to the same value"}),(0,s.jsx)(ei.TN,{children:(0,s.jsx)("ul",{className:"list-disc pl-4 my-3 flex flex-col gap-2",children:h.map((e,t)=>(0,s.jsx)("li",{className:"marker:text-foreground-light",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{children:["ID: ",(0,eR.s)(e.identifier)," (",e.region,"):"]}),(0,s.jsx)(en,{show:!0,beforePrice:f,afterPrice:x})]})},t))})})]})})})};var eG=a(79050),eE=a(80356),eL=a(796),eq=a(59356);async function eZ(e,t){let{projectRef:a,connectionString:s}=e;if(!a)throw Error("Project ref is required");if(!s)throw Error("Connection string is required");let{result:i}=await (0,eq.E)({projectRef:a,connectionString:s,sql:"\n    SELECT\n  (\n    SELECT\n      SUM(pg_database_size(pg_database.datname)) AS db_size_bytes\n    FROM\n      pg_database\n  ),\n  (\n    SELECT SUM(size)\n    FROM\n      pg_ls_waldir()\n  ) AS wal_size_bytes"},t);return i[0]}let eY=function(e){let{projectRef:t,connectionString:a}=e,{enabled:s=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,y.I)({queryKey:b.n.diskBreakdown(t),queryFn:e=>{let{signal:s}=e;return eZ({projectRef:t,connectionString:a},s)},enabled:s&&void 0!==t,...i})},eH=e=>{var t,a,i,r,o;let{form:c}=e,{ref:u}=(0,m.g)(),{resolvedTheme:p}=(0,eL.D)(),{formState:h,watch:f}=c,x=null==p?void 0:p.includes("dark"),{data:g}=(0,R.YA)(),{data:y}=I({projectRef:u}),{data:v}=eY({projectRef:u,connectionString:null==g?void 0:g.connectionString}),b=(0,d.useMemo)(()=>{var e,t,a,s,i,r,n;return{availableBytes:null!=(e=null==y?void 0:y.metrics.fs_avail_bytes)?e:0,totalUsedBytes:null!=(t=null==y?void 0:y.metrics.fs_used_bytes)?t:0,totalDiskSizeBytes:null==y?void 0:y.metrics.fs_size_bytes,dbSizeBytes:Math.max(0,null!=(a=null==v?void 0:v.db_size_bytes)?a:0),walSizeBytes:Math.max(0,null!=(s=null==v?void 0:v.wal_size_bytes)?s:0),systemBytes:Math.max(0,(null!=(i=null==y?void 0:y.metrics.fs_used_bytes)?i:0)-(null!=(r=null==v?void 0:v.db_size_bytes)?r:0)-(null!=(n=null==v?void 0:v.wal_size_bytes)?n:0))}},[y,v]),j=void 0!==h.dirtyFields.totalSize&&v,S=f("totalSize"),N=(null==(t=h.defaultValues)?void 0:t.totalSize)||0,w=Math.round((null!=(a=null==b?void 0:b.totalUsedBytes)?a:0)/O.GB*100)/100,z=Math.min(w/N*100,100),k=Math.round((null!=(i=null==b?void 0:b.dbSizeBytes)?i:0)/O.GB*100)/100,P=0===N?0:Math.min(k/N*100,100),_=Math.min(k/S*100,100),D=Math.round((null!=(r=null==b?void 0:b.walSizeBytes)?r:0)/O.GB*100)/100,T=0===N?0:Math.min(D/N*100,100),V=Math.min(D/S*100,100),C=Math.round((null!=(o=null==b?void 0:b.systemBytes)?o:0)/O.GB*100)/100,M=0===N?0:Math.min(C/N*100,100),A=Math.min(C/S*100,100),B=100*J.nU,F=100*J.nU;return(0,s.jsxs)("div",{className:"flex flex-col gap-2","data-sentry-component":"DiskSpaceBar","data-sentry-source-file":"DiskSpaceBar.tsx",children:[(0,s.jsx)("div",{className:"flex items-center h-6 gap-3",children:(0,s.jsxs)("span",{className:"text-foreground-light text-sm font-mono flex items-center gap-2",children:[w.toFixed(2),(0,s.jsx)("span",{children:"GB used of "}),(0,s.jsx)("span",{className:"text-foreground font-semibold -mt-[2px]",children:(0,s.jsx)(eG.Ay,{value:S,style:{lineHeight:.8},className:"font-mono","data-sentry-element":"MotionNumber","data-sentry-source-file":"DiskSpaceBar.tsx"})})," ","GB"]})}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)("div",{className:(0,E.cn)("h-[35px] relative border rounded-sm w-full transition",j?"bg-selection border border-brand":"bg-surface-300"),children:[(0,s.jsx)(n.N,{"data-sentry-element":"AnimatePresence","data-sentry-source-file":"DiskSpaceBar.tsx",children:(0,s.jsx)(l.P.div,{initial:{rotateY:90,zIndex:2},animate:{rotateY:0,zIndex:1},exit:{rotateY:-90,zIndex:2},transition:{duration:.3},style:{transformOrigin:"left center",backfaceVisibility:"hidden"},className:"absolute inset-0 rounded-sm overflow-hidden","data-sentry-element":"motion.div","data-sentry-source-file":"DiskSpaceBar.tsx",children:(0,s.jsxs)("div",{className:"h-full flex",children:[(0,s.jsx)("div",{className:"relative overflow-hidden transition-all duration-500 ease-in-out bg-foreground",style:{width:"".concat(j?_:P,"%")},children:(0,s.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:"repeating-linear-gradient(\n                            -45deg,\n                            ".concat(x?"rgba(0,0,0,0.1)":"rgba(255,255,255,0.1)",",\n                            ").concat(x?"rgba(0,0,0,0.1) 1px":"rgba(255,255,255,0.1) 1px",",\n                            transparent 1px,\n                            transparent 4px\n                          )")}})}),(0,s.jsx)("div",{className:"relative overflow-hidden transition-all duration-500 ease-in-out bg-_secondary",style:{width:"".concat(j?V:T,"%")}}),(0,s.jsx)("div",{className:"relative overflow-hidden transition-all duration-500 ease-in-out bg-destructive-500",style:{width:"".concat(j?A:M,"%")}}),!j&&(0,s.jsx)("div",{className:"bg-transparent-800 border-r transition-all duration-500 ease-in-out",style:{width:"".concat(B-z<=0?0:B-z,"%")}})]})},"currentBar")}),(0,s.jsx)(n.N,{"data-sentry-element":"AnimatePresence","data-sentry-source-file":"DiskSpaceBar.tsx",children:j&&(0,s.jsx)(l.P.span,{initial:{opacity:0,x:4},animate:{opacity:1,x:0},exit:{opacity:0,x:4},transition:{duration:.12,delay:.12},className:(0,E.cn)((0,Z.e)({variant:"success"}),"absolute right-1 top-[5px]"),children:"New disk size"})})]}),(0,s.jsx)(n.N,{initial:!0,"data-sentry-element":"AnimatePresence","data-sentry-source-file":"DiskSpaceBar.tsx",children:!j&&(0,s.jsx)(l.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},transition:{duration:.1},className:"absolute h-8 w-full -mx-[2px]",children:(0,s.jsxs)("div",{className:"absolute top-0 -left-0 h-full flex items-center transition-all duration-500 ease-in-out",style:{left:"".concat(j?F:B,"%")},children:[(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsxs)("div",{className:"absolute right-full bottom-0 border mr-2 px-2 py-1 bg-surface-400 rounded text-xs text-foreground-light whitespace-nowrap flex items-center gap-x-1",children:["Autoscaling ",(0,s.jsx)(eE.A,{size:12})]})}),(0,s.jsxs)(er.ZI,{side:"bottom",className:"w-[310px] flex flex-col gap-y-1",children:[(0,s.jsx)("p",{children:"Supabase expands your disk storage automatically when the database reached 90% of the disk size. However, any disk modifications, including auto-scaling, can only take place once every 6 hours."}),(0,s.jsxs)("p",{children:["If within those 6 hours you reach 95% of the disk space, your project"," ",(0,s.jsx)("span",{className:"text-destructive-600",children:"will enter read-only mode."})]})]})]}),(0,s.jsx)("div",{className:"w-px h-full bg-border"})]})},"currentSize")})]}),!j&&(0,s.jsxs)("div",{className:"flex items-center space-x-3 text-xs text-foreground-lighter",children:[(0,s.jsx)(eU,{name:"Database",size:b.dbSizeBytes,color:"bg-foreground",description:"Total space on disk used by your database (tables, indexes, data, ...)."}),(0,s.jsx)(eU,{name:"WAL",size:b.walSizeBytes,color:"bg-_secondary",description:"Total space on disk used by the write-ahead log."}),(0,s.jsx)(eU,{name:"System",size:b.systemBytes,color:"bg-destructive-500",description:"Reserved space for the system to ensure your database runs smoothly. You cannot modify this."}),(0,s.jsx)(eU,{name:"Available space",size:b.availableBytes,color:"bg-border",description:"Total available space on the disk left."})]}),(0,s.jsxs)("p",{className:"text-xs text-foreground-lighter my-4",children:[(0,s.jsx)("span",{className:"font-semibold",children:"Note:"})," Disk Size refers to the total space your project occupies on disk, including the database itself (currently"," ",(0,s.jsx)("span",{children:(0,ea.z3)(null==b?void 0:b.dbSizeBytes,2,"GB")}),"), additional files like the write-ahead log (currently"," ",(0,s.jsx)("span",{children:(0,ea.z3)(null==b?void 0:b.walSizeBytes,2,"GB")}),"), and other system resources (currently ",(0,s.jsx)("span",{children:(0,ea.z3)(null==b?void 0:b.systemBytes,2,"GB")}),"). Data can take 5 minutes to refresh."]})]})},eU=e=>{let{name:t,description:a,color:i,size:r}=e;return(0,s.jsxs)(er.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"LegendItem","data-sentry-source-file":"DiskSpaceBar.tsx",children:[(0,s.jsx)(er.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"DiskSpaceBar.tsx",children:(0,s.jsxs)("div",{className:"flex items-center hover:cursor-help z-10",children:[(0,s.jsx)("div",{className:(0,E.cn)("w-2 h-2 rounded-full mr-2",i)}),(0,s.jsx)("span",{children:t})]})}),(0,s.jsxs)(er.ZI,{side:"bottom",className:"flex flex-col gap-y-1 max-w-xs","data-sentry-element":"TooltipContent","data-sentry-source-file":"DiskSpaceBar.tsx",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:(0,E.cn)("w-2 h-2 rounded-full mr-2",i)}),(0,s.jsxs)("span",{children:[t," - ",(0,ea.z3)(r,2,"GB")]})]}),(0,s.jsx)("p",{children:a})]})]})};function eW(e){let{actions:t,form:a}=e,{watch:i}=a,r=i("totalSize"),o=i("storageType")===J.y6.GP3&&r>J.No[J.y6.GP3].maxStorage,d=J.EH.find(e=>e.type===J.y6.IO2);return(0,s.jsx)(n.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskTypeRecommendationSection","data-sentry-source-file":"DiskTypeRecommendationSection.tsx",children:o&&(0,s.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15},children:(0,s.jsx)(q.Z,{type:"default",title:"You will need to use ".concat(null==d?void 0:d.name," to use a larger Disk size"),children:(0,s.jsx)("div",{className:"flex flex-col gap-2",children:t&&(0,s.jsx)("div",{children:t})})})})})}function eJ(e){let{isDirty:t,onClick:a}=e;return(0,s.jsx)(n.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"InputResetButton","data-sentry-source-file":"InputResetButton.tsx",children:t&&(0,s.jsx)(l.P.div,{initial:{opacity:0,scale:.95,x:-2},animate:{opacity:1,scale:1,x:0},exit:{opacity:0,scale:.95,x:-2},transition:{duration:.12},children:(0,s.jsx)(L.$,{htmlType:"button",type:"default",size:"small",className:"px-2 text-foreground-light",onClick:a,children:(0,s.jsx)(Q.A,{className:"h-4 w-4","aria-hidden":"true"})})},"reset-disksize")})}function e$(e){var t,a,i,r,n,l,o;let{form:d,disableInput:c,setAdvancedSettingsOpenState:u}=e,{ref:p}=(0,m.g)(),{control:f,formState:g,setValue:y,trigger:v,getValues:b,resetField:j,watch:S}=d,{data:N}=(0,A.s)(),{data:w}=(0,R.YA)(),{isLoading:z,error:k,isError:P}=(0,x.Gc)({projectRef:p},{enabled:w&&"FLY"!==w.cloud_provider}),{data:_,error:D,isError:T}=I({projectRef:p},{enabled:w&&"FLY"!==w.cloud_provider}),V=D||k,C=T||P,M=10>eA().utc().diff(eA().utc(null==w?void 0:w.inserted_at),"minute")||(null==w?void 0:w.status)==="COMING_UP",F=S("storageType"),G=S("totalSize"),q=null!=(n=null==N?void 0:N.plan.id)?n:"free",{includedDiskGB:Z}=null!=(l=null===J.Jh||void 0===J.Jh?void 0:J.Jh[q])?l:{},Y=Z[F],H=(0,W.WC)({planId:q,oldSize:(null==(t=g.defaultValues)?void 0:t.totalSize)||0,oldStorageType:null==(a=g.defaultValues)?void 0:a.storageType,newSize:b("totalSize"),newStorageType:b("storageType")}),U=!!g.dirtyFields.totalSize,$=Math.round((null!=(o=null==_?void 0:_.metrics.fs_used_bytes)?o:0)/O.GB*100)/100;return(0,s.jsxs)("div",{id:"disk-size",className:"grid @xl:grid-cols-12 gap-5","data-sentry-component":"DiskSizeField","data-sentry-source-file":"DiskSizeField.tsx",children:[(0,s.jsxs)("div",{className:"col-span-4",children:[(0,s.jsx)(B.zB,{name:"totalSize",control:f,render:e=>{let{field:t}=e;return(0,s.jsx)(ev.M,{label:"Disk Size",layout:"vertical",id:t.name,children:(0,s.jsxs)("div",{className:"relative flex gap-2 items-center",children:[(0,s.jsx)(ej,{label:"GB",children:z?(0,s.jsx)("div",{className:(0,E.cn)((0,eg.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,s.jsx)(ey.E,{className:"w-10 h-4"})}):(0,s.jsx)(B.MJ,{children:(0,s.jsx)(eg.p,{type:"number",id:t.name,...t,disabled:c||C,className:"w-32 font-mono rounded-r-none",onWheel:e=>e.currentTarget.blur(),onChange:e=>{y("totalSize",e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0}),v("provisionedIOPS"),v("throughput")},min:Y})})}),(0,s.jsx)(eJ,{isDirty:U,onClick:()=>{j("totalSize"),v("provisionedIOPS")}})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"DiskSizeField.tsx"}),(0,s.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,s.jsx)(en,{className:"mt-1",beforePrice:Number(H.oldPrice),afterPrice:Number(H.newPrice),show:g.isDirty&&!g.errors.totalSize&&H.oldPrice!==H.newPrice,"data-sentry-element":"BillingChangeBadge","data-sentry-source-file":"DiskSizeField.tsx"}),(0,s.jsxs)("span",{className:"text-foreground-lighter text-sm",children:[Y>0&&(null==N?void 0:N.plan.id)&&"Your plan includes ".concat(Y," GB of disk size for ").concat(F,"."),(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsx)(h.A,{abbrev:!1,href:"".concat(O.aq,"/guides/platform/database-size"),"data-sentry-element":"DocsButton","data-sentry-source-file":"DiskSizeField.tsx"})})]}),(0,s.jsx)(eW,{form:d,actions:(0,s.jsx)(L.$,{type:"default",onClick:()=>{y("storageType","io2"),v("provisionedIOPS"),v("totalSize"),u(!0)},children:"Change to High Performance SSD"}),"data-sentry-element":"DiskTypeRecommendationSection","data-sentry-source-file":"DiskSizeField.tsx"})]})]}),(0,s.jsxs)("div",{className:"col-span-8",children:[(0,s.jsx)(eH,{form:d,"data-sentry-element":"DiskSpaceBar","data-sentry-source-file":"DiskSizeField.tsx"}),M?(0,s.jsx)(eb,{message:"Disk size data is not available for ~10 minutes after project creation",type:"error"}):V&&(0,s.jsx)(eb,{message:"Failed to load disk size data",type:"error",children:null==V?void 0:V.message}),(0,s.jsx)(eO,{isDirty:void 0!==g.dirtyFields.totalSize,totalSize:1.25*((null==(i=g.defaultValues)?void 0:i.totalSize)||0),usedSize:$,newTotalSize:1.25*G,oldStorageType:null==(r=g.defaultValues)?void 0:r.storageType,newStorageType:b("storageType"),"data-sentry-element":"DiskManagementDiskSizeReadReplicas","data-sentry-source-file":"DiskSizeField.tsx"})]})]})}function eQ(e){let{actions:t,form:a}=e,{watch:i}=a,r=i("computeSize"),o=i("provisionedIOPS"),d=(0,W.u1)(o),c=o>(0,W.T2)(null!=r?r:"ci_micro")&&!J.JM.includes(r);return(0,s.jsx)(n.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"ComputeSizeRecommendationSection","data-sentry-source-file":"ComputeSizeRecommendationSection.tsx",children:c&&(0,s.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.15},children:(0,s.jsx)(q.Z,{type:"default",title:"Your Compute size can only support a baseline IOPS of ".concat(J.QL[r]),children:(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"text-sm text-foreground-light",children:["To achieve sustained IOPS performance we recommend using the"," ",(0,s.jsx)("span",{className:"text-foreground",children:(0,W.ku)(d)})," ","compute size."]})}),t&&(0,s.jsx)("div",{children:t})]})})})})}function eX(e){var t,a,i;let{form:r,disableInput:n}=e,{ref:l}=(0,m.g)(),{control:o,formState:d,setValue:c,trigger:u,getValues:p,watch:h}=r,f=h("storageType"),g=h("computeSize"),y=null!=(i=h("provisionedIOPS"))?i:0,{isLoading:v,error:b,isError:j}=(0,x.Gc)({projectRef:l}),S=(0,W.t5)({oldStorageType:null==(t=d.defaultValues)?void 0:t.storageType,oldProvisionedIOPS:(null==(a=d.defaultValues)?void 0:a.provisionedIOPS)||0,newStorageType:p("storageType"),newProvisionedIOPS:p("provisionedIOPS")}),N=J.JM.includes(g)&&"gp3"===f;return(0,s.jsx)(B.zB,{control:o,name:"provisionedIOPS",render:e=>{var t,a,i,l,o;let{field:m}=e,h=(0,W.u1)(y);return(0,s.jsxs)(ev.M,{layout:"horizontal",label:"IOPS",id:m.name,description:(0,s.jsxs)("span",{className:"flex flex-col gap-y-2",children:[(0,s.jsx)("p",{children:"Use higher IOPS for high-throughput apps."}),(0,s.jsx)(eQ,{form:r,actions:(0,s.jsxs)(L.$,{type:"default",onClick:()=>{c("computeSize",null!=h?h:"ci_nano"),u("provisionedIOPS")},children:["Update to ",(0,W.ku)(h)]})}),!d.errors.provisionedIOPS&&(0,s.jsx)(eB,{isDirty:void 0!==d.dirtyFields.provisionedIOPS,oldIOPS:null!=(o=null==(t=d.defaultValues)?void 0:t.provisionedIOPS)?o:0,newIOPS:m.value,oldStorageType:null==(a=d.defaultValues)?void 0:a.storageType,newStorageType:p("storageType")})]}),labelOptional:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(en,{show:(f!==(null==(i=d.defaultValues)?void 0:i.storageType)||"gp3"===f&&m.value!==(null==(l=d.defaultValues)?void 0:l.provisionedIOPS))&&!d.errors.provisionedIOPS&&!N,beforePrice:Number(S.oldPrice),afterPrice:Number(S.newPrice),className:"mb-2"}),(0,s.jsx)("p",{className:"text-foreground-lighter",children:"Input/output operations per second."})]}),children:[(0,s.jsx)(ej,{label:"IOPS",children:v?(0,s.jsx)("div",{className:(0,E.cn)((0,eg.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,s.jsx)(ey.E,{className:"w-10 h-4"})}):(0,s.jsx)(B.MJ,{children:(0,s.jsx)(eg.p,{type:"number",className:"flex-grow font-mono rounded-r-none max-w-32",...m,value:m.value,disabled:n||N||j,onChange:e=>{c("provisionedIOPS",e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})}})})}),b&&(0,s.jsx)(eb,{type:"error",message:b.message})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-component":"IOPSField","data-sentry-source-file":"IOPSField.tsx"})}var eK=a(66329);let e0=["ap-east-1","ap-northeast-1","ap-northeast-2","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","eu-central-1","eu-north-1","eu-west-1","eu-west-2","us-east-1","us-east-2","us-west-1","us-west-2"];function e1(e){var t;let{form:a,disableInput:i}=e,{control:r,trigger:n}=a,{data:l}=(0,R.YA)(),{ref:o}=(0,m.g)(),d=e0.includes(null!=(t=null==l?void 0:l.region)?t:""),{isLoading:c,error:u,isError:p}=(0,x.Gc)({projectRef:o});return(0,s.jsx)(B.zB,{name:"storageType",control:r,render:e=>{let{field:t}=e;return(0,s.jsxs)(ev.M,{layout:"horizontal",label:"Storage type",children:[(0,s.jsxs)(eK.l6,{...t,onValueChange:async e=>{t.onChange(e),"gp3"===e?!a.getFieldState("provisionedIOPS").isDirty&&(!a.getValues("provisionedIOPS")||a.getValues("provisionedIOPS")<J.No[J.y6.GP3].minIops)&&a.setValue("provisionedIOPS",J.No[J.y6.GP3].minIops):!a.getFieldState("provisionedIOPS").isDirty&&(!a.getValues("provisionedIOPS")||a.getValues("provisionedIOPS")<J.No[J.y6.IO2].minIops)&&a.setValue("provisionedIOPS",J.No[J.y6.IO2].minIops),await n("provisionedIOPS"),await n("totalSize")},defaultValue:t.value,disabled:i||p,children:[c?(0,s.jsx)(ey.E,{className:(0,E.cn)((0,L.r)({size:"small"}),"h-14 min-w-[420px] duration-[2s]")}):(0,s.jsx)(B.MJ,{children:(0,s.jsx)(eK.bq,{className:"h-14 max-w-[420px]",children:(0,s.jsx)(eK.yv,{})})}),(0,s.jsx)(eK.gC,{children:(0,s.jsx)(s.Fragment,{children:J.EH.map(e=>{let t="io2"===e.type&&!d;return(0,s.jsxs)(er.m_,{children:[(0,s.jsx)(er.k$,{asChild:!0,children:(0,s.jsx)(eK.eb,{disabled:i||t,value:e.type,className:(0,E.cn)(t&&"!pointer-events-auto"),children:(0,s.jsxs)("div",{className:"flex flex-col gap-0 items-start",children:[(0,s.jsxs)("div",{className:"flex gap-3 items-center",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:e.name})," ",(0,s.jsx)("div",{children:(0,s.jsx)(Z.E,{variant:"outline",className:"font-mono bg-alternative bg-opacity-100",children:e.type})})]}),(0,s.jsx)("p",{className:"text-foreground-light",children:e.description})]})},e.type)}),t&&(0,s.jsxs)(er.ZI,{side:"right",className:"w-64",children:["IO2 Volume Type is not available in your project's region (",null==l?void 0:l.region,"). More information available"," ",(0,s.jsx)(eP.g,{href:"https://docs.aws.amazon.com/ebs/latest/userguide/provisioned-iops.html#io2-bx-considerations",children:"here"}),"."]})]},e.type)})})})]}),u&&(0,s.jsx)(eb,{type:"error",message:u.message})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-component":"StorageTypeField","data-sentry-source-file":"StorageTypeField.tsx"})}function e2(e){var t,a;let{form:i,disableInput:r}=e,{ref:o}=(0,m.g)(),{control:c,formState:u,setValue:p,getValues:h,watch:f}=i,g=f("storageType"),y=f("totalSize"),v=f("computeSize"),b=null==(t=u.defaultValues)?void 0:t.throughput,{isLoading:j,error:S}=(0,x.Gc)({projectRef:o}),N=(0,W.ou)({storageType:i.getValues("storageType"),newThroughput:i.getValues("throughput")||0,oldThroughput:(null==(a=i.formState.defaultValues)?void 0:a.throughput)||0}),w=J.JM.includes(v)&&"gp3"===g;return(0,d.useEffect)(()=>{if("io2"===g)p("throughput",void 0);else if("gp3"===g){let e=i.getValues("throughput"),{minThroughput:t,maxThroughput:a}=J.No[J.y6.GP3];(!e||e<t||e>a)&&p("throughput",t)}},[g,y,p,i]),(0,s.jsx)(n.N,{initial:!1,"data-sentry-element":"AnimatePresence","data-sentry-component":"ThroughputField","data-sentry-source-file":"ThroughputField.tsx",children:"gp3"===h("storageType")&&(0,s.jsx)(l.P.div,{initial:{opacity:0,x:-4,height:0},animate:{opacity:1,x:0,height:"auto"},exit:{opacity:0,x:-4,height:0},transition:{duration:.1},style:{overflow:"hidden"},children:(0,s.jsx)(B.zB,{name:"throughput",control:c,render:e=>{var t,a;let{field:i}=e;return(0,s.jsxs)(ev.M,{label:"Throughput",layout:"horizontal",description:(0,s.jsxs)("span",{className:"flex flex-col gap-y-2",children:[(0,s.jsx)("p",{children:"Higher throughput suits applications with high data transfer needs."}),!u.errors.throughput&&(0,s.jsx)(eF,{isDirty:void 0!==u.dirtyFields.throughput,oldThroughput:null!=b?b:0,newThroughput:null!=(a=i.value)?a:0,oldStorageType:null==(t=u.defaultValues)?void 0:t.storageType,newStorageType:h("storageType")})]}),labelOptional:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(en,{show:u.isDirty&&u.dirtyFields.throughput&&!u.errors.throughput,beforePrice:Number(N.oldPrice),afterPrice:Number(N.newPrice),className:"mb-2"}),(0,s.jsx)("p",{className:"text-foreground-lighter",children:"Amount of data read/written per second."})]}),children:[(0,s.jsx)(ej,{label:"MB/s",children:j?(0,s.jsx)("div",{className:(0,E.cn)((0,eg.L)({size:"small"}),"w-32 font-mono rounded-r-none"),children:(0,s.jsx)(ey.E,{className:"w-10 h-4"})}):(0,s.jsx)(B.MJ,{children:(0,s.jsx)(eg.p,{type:"number",...i,value:i.value,onChange:e=>{p("throughput",e.target.valueAsNumber,{shouldDirty:!0,shouldValidate:!0})},className:"flex-grow font-mono rounded-r-none max-w-32",disabled:r||w||"io2"===g})})}),S&&(0,s.jsx)(eb,{type:"error",message:S.message})]})}})},"throughPutContainer")})}let e3=e=>{let{seconds:t}=e,a=Math.floor(t/3600),i=Math.floor(t%3600/60),r={minimumIntegerDigits:2},n=e=>e.toString().padStart(2,"0");return(0,s.jsxs)("span",{className:"inline-flex gap-2","data-sentry-component":"CountdownTimerSpan","data-sentry-source-file":"CountdownTimerSpan.tsx",children:[(0,s.jsx)("span",{className:"text-foreground-lighter text-sm p-0",children:"Time remaining: "}),(0,s.jsxs)("span",{className:"text-foreground text-sm font-mono flex items-center gap-0",children:[(0,s.jsx)(eG.Ay,{format:r,value:Number(n(a)),"data-sentry-element":"MotionNumber","data-sentry-source-file":"CountdownTimerSpan.tsx"}),"hr",(0,s.jsx)(eG.Ay,{format:r,value:Number(n(i)),"data-sentry-element":"MotionNumber","data-sentry-source-file":"CountdownTimerSpan.tsx"}),"m",(0,s.jsx)(eG.Ay,{format:r,value:Number(n(t%60)),"data-sentry-element":"MotionNumber","data-sentry-source-file":"CountdownTimerSpan.tsx"})]})]})};var e5=a(78039);function e4(){let{ref:e}=(0,m.g)(),[t,a]=(0,d.useState)(0),{remainingDuration:i,error:r,isSuccess:o}=(0,x.Zj)({projectRef:e}),c=t/g.Xz*100;return(0,d.useEffect)(()=>{i>0&&a(i)},[i]),(0,d.useEffect)(()=>{if(t<=0)return;let e=setInterval(()=>{a(Math.max(0,t-1))},1e3);return()=>clearInterval(e)},[t]),(0,s.jsxs)(n.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"DiskCountdownRadial","data-sentry-source-file":"DiskCountdownRadial.tsx",children:[t>0&&o&&(0,s.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:(0,s.jsx)(e5.Zp,{className:"px-2 rounded bg-surface-100",children:(0,s.jsxs)(e5.Wu,{className:"py-3 flex gap-3 px-3 items-start",children:[(0,s.jsx)(em,{progress:c}),(0,s.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-foreground text-sm p-0",children:"6-hour cooldown period is in progress"}),(0,s.jsx)("p",{className:"text-foreground-lighter text-sm p-0",children:"You can't modify your disk configuration again until the 6-hour cool down period ends."})]}),(0,s.jsx)(e3,{seconds:t})]})]})})}),r&&(0,s.jsx)(eb,{message:r.message,type:"error"})]})}var e6=a(52555),e9=a.n(e6);function e8(){let{data:e}=(0,A.s)(),{data:t}=(0,R.YA)(),a=(null==e?void 0:e.plan.id)!=="free"&&!(null==e?void 0:e.usage_billing_enabled)&&(null==t?void 0:t.cloud_provider)!=="FLY";return(0,s.jsx)(n.N,{"data-sentry-element":"AnimatePresence","data-sentry-component":"SpendCapDisabledSection","data-sentry-source-file":"SpendCapDisabledSection.tsx",children:a&&(0,s.jsx)(l.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:(0,s.jsxs)(q.Z,{type:"default",children:[(0,s.jsx)(ei.XL,{children:"Disable spend cap to manage Disk configuration"}),(0,s.jsx)(ei.TN,{children:"To access disk management features, you need to disable your spend cap. These features offer more flexibility and control over your database disk size."}),(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsx)(e9(),{href:"/org/".concat(null==e?void 0:e.slug,"/billing?panel=costControl"),className:(0,E.cn)((0,L.r)({type:"default",size:"tiny"})),children:"Disable spend cap"})})]})})})}var e7=a(49510);function te(){var e,t,a,y;let{ref:v}=(0,m.g)(),{data:b}=(0,R.YA)(),{data:j}=(0,A.s)(),{setProjectStatus:N}=(0,_.l1)(),{data:w}=(0,C.p)({ref:v}),z=null==(e=null!=w?w:[])?void 0:e.find(e=>e.project===(null==b?void 0:b.ref)),P=null==z?void 0:z.is_readonly_mode_enabled,Z=(0,R.lh)(),H=(0,R.BA)(),Q=(0,R.br)(),{can:X,isSuccess:K}=(0,M.Qp)(r.aG.UPDATE,"projects",{resource:{project_id:null==b?void 0:b.id}}),{hasAccess:et}=(0,e7.e)("instances.compute_update"),[ea,es]=(0,d.useState)(!1),[ei,er]=(0,d.useState)(!1),[en,el]=(0,d.useState)(null),[eo,ed]=(0,d.useState)(!1),{data:ec,isSuccess:eu}=(0,D.Vh)({projectRef:v}),{data:em,isSuccess:ep}=(0,x.Gc)({projectRef:v},{refetchInterval:ei,refetchOnWindowFocus:!1,onSuccess:e=>{var t;let{type:a,iops:s,throughput_mbps:i,size_gb:r}=null!=(t=null==e?void 0:e.attributes)?t:{size_gb:0};"requested_modification"in e?er(2e3):!1!==ei&&(eM.reset({storageType:a,provisionedIOPS:s,throughput:i,totalSize:r}),er(!1),u.oR.success("Disk configuration changes have been successfully applied!"))},enabled:null!=b&&Z}),{isSuccess:eh}=(0,V.Q)({projectRef:v}),{isWithinCooldownWindow:ef,isSuccess:eg}=(0,x.Zj)({projectRef:v,enabled:null!=b&&Z}),{data:ey,isSuccess:ev}=I({projectRef:v},{enabled:null!=b&&Z}),{data:eb,isSuccess:ej}=S({projectRef:v},{enabled:null!=b&&Z}),eN=(null==b?void 0:b.infra_compute_size)?(0,W.$6)(null==b?void 0:b.infra_compute_size):void 0,{type:ew,iops:ez,throughput_mbps:ek,size_gb:eP}=null!=(a=null==em?void 0:em.attributes)?a:{size_gb:0,iops:0},{growth_percent:eI,max_size_gb:e_,min_increment_gb:eD}=null!=eb?eb:{},eT={storageType:null!=ew?ew:J.y6.GP3,provisionedIOPS:ez,throughput:ek,totalSize:eP,computeSize:eN,growthPercent:eI,minIncrementGb:eD,maxSizeGb:e_},eM=(0,c.mN)({resolver:(0,i.u)((e=>{let{defaultTotalSize:t,cloudProvider:a}=e,s="FLY"!==a&&"AWS_NIMBUS"!==a;return $.superRefine((e,a)=>{let{storageType:i,totalSize:r,provisionedIOPS:n,throughput:l,maxSizeGb:o}=e;if(s&&r<8&&a.addIssue({code:U.eq.custom,message:"Allocated disk size must be at least 8 GB.",path:["totalSize"]}),s&&r<t&&a.addIssue({code:U.eq.custom,message:"Disk size cannot be reduced in size. Reduce your database size and then head to the Infrastructure settings and go through a Postgres version upgrade to right-size your disk.",path:["totalSize"]}),s&&o&&o<r&&a.addIssue({code:U.eq.custom,message:"Max disk size cannot be lower than the current disk size. Must be at least ".concat((0,W.ZV)(r)," GB."),path:["maxSizeGb"]}),s&&"io2"===i){n>J.No[J.y6.IO2].maxIops&&a.addIssue({code:U.eq.custom,message:"IOPS can not exceed ".concat((0,W.ZV)(J.No[J.y6.IO2].maxIops)," for io2 Disk type. Please reach out to support if you need higher IOPS than this."),path:["provisionedIOPS"]});let e=(0,W.Fu)(r);if(n<J.No[J.y6.IO2].minIops)a.addIssue({code:U.eq.custom,message:"Provisioned IOPS must be at least ".concat((0,W.ZV)(J.No[J.y6.IO2].minIops)),path:["provisionedIOPS"]});else if(n>e)if(r>=8){let t=(0,W.it)(n);t>r&&a.addIssue({code:U.eq.custom,message:"Larger Disk size of at least ".concat((0,W.ZV)(t)," GB required. Current max is ").concat((0,W.ZV)(e)," IOPS."),path:["provisionedIOPS"]})}else a.addIssue({code:U.eq.custom,message:"Invalid IOPS value due to small disk size",path:["provisionedIOPS"]});void 0!==l&&a.addIssue({code:U.eq.custom,message:"Throughput is not configurable for io2.",path:["throughput"]}),r>J.No[J.y6.IO2].maxStorage&&a.addIssue({code:U.eq.custom,message:"Allocated disksize must not exceed ".concat((0,W.ZV)(J.No[J.y6.IO2].maxStorage)," GB "),path:["totalSize"]})}if(s&&"gp3"===i){let e=(0,W.HE)(r);if(n>J.No[J.y6.GP3].maxIops&&a.addIssue({code:U.eq.custom,message:"IOPS can not exceed ".concat((0,W.ZV)(J.No[J.y6.GP3].maxIops)," for GP3 Disk. Change the Disk type to io2 for higher IOPS support."),path:["provisionedIOPS"]}),n<J.No[J.y6.GP3].minIops)a.addIssue({code:U.eq.custom,message:"IOPS must be at least ".concat((0,W.ZV)(J.No[J.y6.GP3].minIops)),path:["provisionedIOPS"]});else if(n>e)if(r>=8){let t=(0,W.CQ)(n);a.addIssue({code:U.eq.custom,message:"Larger Disk size of at least ".concat((0,W.ZV)(t)," GB required. Current max is ").concat((0,W.ZV)(e)," IOPS."),path:["provisionedIOPS"]})}else a.addIssue({code:U.eq.custom,message:"Invalid IOPS value due to invalid disk size",path:["provisionedIOPS"]});if(void 0!==l){let e=Math.min(.25*n,1e3);if(l>J.No.gp3.maxThroughput&&a.addIssue({code:U.eq.custom,message:"Throughput can not exceed ".concat((0,W.ZV)(e)," MB/s"),path:["throughput"]}),l>e){let e=(0,W.a6)(l);a.addIssue({code:U.eq.custom,message:"Need at least ".concat((0,W.ZV)(e)," IOPS to support ").concat((0,W.ZV)(l)," MB/s."),path:["throughput"]})}l<J.No[J.y6.GP3].minThroughput&&a.addIssue({code:U.eq.custom,message:"Throughput must be at least ".concat((0,W.ZV)(J.No[J.y6.GP3].minThroughput)," MB/s"),path:["throughput"]})}r>J.No[J.y6.GP3].maxStorage&&a.addIssue({code:U.eq.custom,message:"Allocated disksize must not exceed ".concat((0,W.ZV)(J.No[J.y6.GP3].maxStorage)," GB"),path:["totalSize"]})}})})({defaultTotalSize:eT.totalSize,cloudProvider:null==b?void 0:b.cloud_provider})),defaultValues:eT,mode:"onBlur",reValidateMode:"onChange"}),{computeSize:eA}=eM.watch();(0,d.useEffect)(()=>{eA&&(null==b?void 0:b.infra_compute_size)&&ea&&J.eQ.includes(eA)&&(eM.setValue("storageType",J.y6.GP3),eM.setValue("throughput",J.No.gp3.minThroughput),eM.setValue("provisionedIOPS",J.No.gp3.minIops))},[eA,ea,b]);let eR=eh&&ep&&ev&&eu&&ej&&eg,eO=(null==em?void 0:em.requested_modification)!==void 0,eB=(null!=ec?ec:[]).filter(e=>e.identifier!==v),eF=!et,{formState:eG}=eM,eE=Math.round((null!=(y=null==ey?void 0:ey.metrics.fs_used_bytes)?y:0)/O.GB*100)/100,eL=(null==(t=eG.defaultValues)?void 0:t.totalSize)||0,eq=J.eQ.includes(eM.watch("computeSize"))&&!et,eZ=(null==b?void 0:b.parent_project_ref)!==void 0,eY=eO||eF||ef||!X||!Z,eH=!!Object.keys(eM.formState.dirtyFields).length,eU=(null==b?void 0:b.status)===O.BU.RESIZING,eW=eO&&!eU,eJ=K&&!X,{mutateAsync:eQ,isLoading:eK}=(0,g._J)({onError:()=>{},onSuccess:()=>er(2e3)}),{mutateAsync:e0,isLoading:e3}=(0,T.F)({onError:()=>{},onSuccess:()=>{v&&N({ref:v,status:O.BU.RESIZING})}}),{mutateAsync:e5,isLoading:e6}=k({onError:()=>{}}),e9=async e=>{let t=!1;el(null);try{var a,s,i,r,n,l,o,d;Q||e.storageType===(null==(a=eM.formState.defaultValues)?void 0:a.storageType)&&e.provisionedIOPS===(null==(s=eM.formState.defaultValues)?void 0:s.provisionedIOPS)&&e.throughput===(null==(i=eM.formState.defaultValues)?void 0:i.throughput)&&e.totalSize===(null==(r=eM.formState.defaultValues)?void 0:r.totalSize)||(t=!0,await eQ({ref:v,provisionedIOPS:e.provisionedIOPS,storageType:e.storageType,totalSize:e.totalSize,throughput:e.throughput})),Q||e.growthPercent===(null==(n=eM.formState.defaultValues)?void 0:n.growthPercent)&&e.minIncrementGb===(null==(l=eM.formState.defaultValues)?void 0:l.minIncrementGb)&&e.maxSizeGb===(null==(o=eM.formState.defaultValues)?void 0:o.maxSizeGb)||await e5({projectRef:v,growthPercent:e.growthPercent,minIncrementGb:e.minIncrementGb,maxSizeGb:e.maxSizeGb}),e.computeSize!==(null==(d=eM.formState.defaultValues)?void 0:d.computeSize)&&await e0({projectRef:v,variant:e.computeSize,type:"compute_instance",suppressToast:!0}),es(!1),eM.reset(e),u.oR.success("Successfully updated disk settings!".concat(t?" The requested changes will be applied to your disk shortly.":""))}catch(e){el({message:e instanceof Error?e.message:"An unknown error occurred",type:"error"})}};return(0,d.useEffect)(()=>{(ep||eR)&&eM.reset(eT,{})},[eR,ep]),(0,s.jsx)(B.lV,{...eM,"data-sentry-element":"Form_Shadcn_","data-sentry-component":"DiskManagementForm","data-sentry-source-file":"DiskManagementForm.tsx",children:(0,s.jsxs)("form",{onSubmit:eM.handleSubmit(e9),className:"flex flex-col gap-8",children:[(0,s.jsxs)(p.eh,{className:"relative flex flex-col gap-10",bottomPadding:!0,"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"DiskManagementForm.tsx",children:[(0,s.jsx)(eV.Y,{type:"default",visible:!et,title:"Compute and Disk configuration is not available on the Free Plan",actions:(0,s.jsx)(f.I,{source:"diskManagementConfigure",plan:"Pro"}),description:"You will need to upgrade to at least the Pro Plan to configure compute and disk","data-sentry-element":"NoticeBar","data-sentry-source-file":"DiskManagementForm.tsx"}),eU||eW||eJ?(0,s.jsxs)("div",{className:"relative flex flex-col gap-10",children:[(0,s.jsx)(ee,{visible:eU,title:"Your project will now automatically restart.",description:"Your project will be unavailable for up to 2 mins."}),(0,s.jsx)(eV.Y,{type:"default",visible:eW,title:"Disk configuration changes have been requested",description:"The requested changes will be applied to your disk shortly"}),(0,s.jsx)(eV.Y,{type:"default",visible:eJ,title:"You do not have permission to update disk configuration",description:"Please contact your organization administrator to update your disk configuration"})]}):null,(0,s.jsx)(F.w,{"data-sentry-element":"Separator","data-sentry-source-file":"DiskManagementForm.tsx"}),(0,s.jsx)(eC,{form:eM,disabled:eF,"data-sentry-element":"ComputeSizeField","data-sentry-source-file":"DiskManagementForm.tsx"}),!(Z||Q)&&(0,s.jsx)(F.w,{}),(0,s.jsx)(e8,{"data-sentry-element":"SpendCapDisabledSection","data-sentry-source-file":"DiskManagementForm.tsx"}),(0,s.jsx)(eV.Y,{type:"default",visible:!(Z||Q),title:"Disk configuration is only available for projects in the AWS cloud provider",description:H?"Configuring your disk for AWS (Revamped) projects is unavailable for now.":eZ?"Delete and recreate your Preview Branch to configure disk size. It was deployed on an older branching infrastructure.":"The Fly Postgres offering is deprecated - please migrate your instance to the AWS cloud prov to configure your disk.","data-sentry-element":"NoticeBar","data-sentry-source-file":"DiskManagementForm.tsx"}),Z&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,s.jsx)(e4,{}),!P&&eE/eL*100>=90&&ef&&(0,s.jsx)(q.Z,{type:"destructive",title:"Database size is currently over 90% of disk size",description:"Your project will enter read-only mode once you reach 95% of the disk space to prevent your database from exceeding the disk limitations",children:(0,s.jsx)(h.A,{abbrev:!1,className:"mt-2",href:"".concat(O.aq,"/guides/platform/database-size#read-only-mode")})}),P&&(0,s.jsx)(q.Z,{type:"destructive",title:"Project is currently in read-only mode",description:"You will need to manually override read-only mode and reduce the database size to below 95% of the disk size",children:(0,s.jsx)(h.A,{abbrev:!1,className:"mt-2",href:"".concat(O.aq,"/guides/platform/database-size#disabling-read-only-mode")})})]}),(0,s.jsx)(e$,{form:eM,disableInput:eY,setAdvancedSettingsOpenState:ed}),(0,s.jsx)(F.w,{}),(0,s.jsxs)(G.Nt,{className:"-space-y-px",open:eo,onOpenChange:()=>ed(e=>!e),children:[(0,s.jsxs)(G.R6,{className:"px-8 py-3 w-full border flex items-center gap-6 rounded-t data-[state=closed]:rounded-b group justify-between",children:[(0,s.jsxs)("div",{className:"flex flex-col items-start",children:[(0,s.jsx)("span",{className:"text-sm text-foreground",children:"Advanced disk settings"}),(0,s.jsx)("span",{className:"text-sm text-foreground-light text-left",children:"Specify additional settings for your disk, including autoscaling configuration, IOPS, throughput, and disk type."})]}),(0,s.jsx)(o.A,{size:16,className:"text-foreground-light transition-all group-data-[state=open]:rotate-90",strokeWidth:1})]}),(0,s.jsxs)(G.Ke,{className:(0,E.cn)("flex flex-col gap-8 py-8 transition-all","data-[state=open]:border data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down"),children:[(0,s.jsx)("div",{className:"px-8 flex flex-col gap-y-8",children:(0,s.jsx)(eS,{form:eM})}),(0,s.jsx)(F.w,{}),(0,s.jsxs)("div",{className:"px-8 flex flex-col gap-y-8",children:[(0,s.jsx)(eV.Y,{type:"default",visible:eq,title:"Adjusting disk configuration requires LARGE Compute size or above",description:"Increase your compute size to adjust your disk's storage type, ".concat("gp3"===eM.getValues("storageType")?"IOPS, ":""," and throughput"),actions:(0,s.jsx)(L.$,{type:"default",onClick:()=>{eM.setValue("computeSize","ci_large")},children:"Change to LARGE Compute"})}),(0,s.jsx)(e1,{form:eM,disableInput:eq||eY}),(0,s.jsx)(eX,{form:eM,disableInput:eq||eY}),(0,s.jsx)(e2,{form:eM,disableInput:eq||eY})]})]})]})]})]}),(0,s.jsx)(n.N,{"data-sentry-element":"AnimatePresence","data-sentry-source-file":"DiskManagementForm.tsx",children:eH?(0,s.jsx)(l.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.1,delay:.2},className:"z-10 w-full left-0 right-0 sticky bottom-0 bg-surface-100 border-t h-16 items-center flex",children:(0,s.jsxs)("div",{className:(0,E.cn)(p.bV,p.BS,"flex items-center gap-3 justify-end"),children:[(0,s.jsx)(Y,{formState:eG}),(0,s.jsx)(L.$,{type:"default",onClick:()=>eM.reset(),disabled:!eH,size:"medium",children:"Cancel"}),(0,s.jsx)(ex,{loading:eK||e3||e6,disabled:eJ,form:eM,numReplicas:eB.length,isDialogOpen:ea,onSubmit:e9,setIsDialogOpen:es,message:en})]})}):null})]})})}var tt=a(10508),ta=a(43479);let ts=()=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"compute-and-disk.tsx",children:(0,s.jsxs)(p.Uw,{"data-sentry-element":"ScaffoldHeader","data-sentry-source-file":"compute-and-disk.tsx",children:[(0,s.jsx)(p.Dm,{"data-sentry-element":"ScaffoldTitle","data-sentry-source-file":"compute-and-disk.tsx",children:"Compute and Disk"}),(0,s.jsx)(p.dX,{"data-sentry-element":"ScaffoldDescription","data-sentry-source-file":"compute-and-disk.tsx",children:"Configure the compute and disk settings for your project."})]})}),(0,s.jsx)(te,{"data-sentry-element":"DiskManagementForm","data-sentry-source-file":"compute-and-disk.tsx"})]});ts.getLayout=e=>(0,s.jsx)(tt.A,{children:(0,s.jsx)(ta.A,{children:e})});let ti=ts},21290:(e,t,a)=>{"use strict";a.d(t,{e:()=>d,p:()=>o});var s=a(80263),i=a(10115),r=a(37724),n=a(53239),l=a(80100);let o=n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(i.bL,{className:(0,l.cn)("grid gap-2",a),...r,ref:t})});o.displayName=i.bL.displayName;let d=n.forwardRef((e,t)=>{let{image:a,label:n,showIndicator:o=!0,...d}=e;return(0,s.jsxs)(i.q7,{ref:t,...d,className:(0,l.cn)("flex flex-col gap-2","w-48","bg-overlay","rounded-md","border","p-2","hover:border-foreground-muted","hover:z-[1] focus-visible:z-[1]","data-[state=checked]:z-[1]","data-[state=checked]:ring-2 data-[state=checked]:ring-border","data-[state=checked]:bg-surface-200 dark:data-[state=checked]:bg-surface-300","data-[state=checked]:border-foreground/50","transition-colors","group",d.className),children:[d.children,(0,s.jsxs)("label",{className:"flex gap-2 w-full",id:d.id,htmlFor:d.value,children:[o&&(0,s.jsx)("div",{className:" aspect-square h-4 w-4  rounded-full border group-data-[state=checked]:border-foreground-muted group-focus:border-foreground-muted group-hover:border-foreground-muted ring-offset-background  group-focus:outline-none  group-focus-visible:ring-2 group-focus-visible:ring-ring group-focus-visible:ring-offset-2  group-disabled:cursor-not-allowed group-disabled:opacity-50 flex items-center justify-center transition ",children:(0,s.jsx)(i.C1,{className:"flex items-center justify-center",children:(0,s.jsx)(r.A,{className:"h-2.5 w-2.5 fill-current text-current"})})}),(0,s.jsx)("div",{className:(0,l.cn)("w-full","text-xs transition-colors text-left","text-light","group-hover:text-foreground group-data-[state=checked]:text-foreground",d.disabled?"cursor-not-allowed":"cursor-pointer"),children:n})]})]})});d.displayName=i.q7.displayName},31647:(e,t,a)=>{"use strict";a.d(t,{x:()=>n});var s=a(80263),i=a(53239),r=a(80100);let n=i.forwardRef((e,t)=>{let{className:a,containerClassName:n,children:l,stickyLastColumn:o,...d}=e,c=i.useRef(null),{hasHorizontalScroll:u,canScrollLeft:m,canScrollRight:p}=(e=>{let[t,a]=i.useState(!1),[s,r]=i.useState(!1),[n,l]=i.useState(!1);return i.useEffect(()=>{let s=e.current;if(!s)return;let i=()=>{let e=s.scrollWidth>s.clientWidth;if(a(e),e){let e=s.scrollLeft>0,t=s.scrollLeft<s.scrollWidth-s.clientWidth;r(e),l(t)}else r(!1),l(!1)},n=()=>{if(t){let e=s.scrollLeft>0,t=s.scrollLeft<s.scrollWidth-s.clientWidth;r(e),l(t)}};return i(),s.addEventListener("scroll",n),window.addEventListener("resize",i),()=>{s.removeEventListener("scroll",n),window.removeEventListener("resize",i)}},[e,t]),{hasHorizontalScroll:t,canScrollLeft:s,canScrollRight:n}})(c),h=(0,r.cn)("[&_td:last-child]:before:absolute [&_td:last-child]:before:top-0 [&_td:last-child]:before:-left-6","[&_td:last-child]:before:bottom-0 [&_td:last-child]:before:w-6 [&_td:last-child]:before:bg-gradient-to-l","[&_td:last-child]:before:from-black/5 dark:[&_td:last-child]:before:from-black/20 [&_td:last-child]:before:to-transparent","[&_td:last-child]:before:opacity-0 [&_td:last-child]:before:transition-all [&_td:last-child]:before:duration-400","[&_td:last-child]:before:easing-[0.24, 0.25, 0.05, 1] [&_td:last-child]:before:z-[60]","[&_th:last-child]:before:absolute [&_th:last-child]:before:top-0 [&_th:last-child]:before:-left-6","[&_th:last-child]:before:bottom-0 [&_th:last-child]:before:w-6 [&_th:last-child]:before:bg-gradient-to-l","[&_th:last-child]:before:from-black/5 dark:[&_th:last-child]:before:from-black/20 [&_th:last-child]:before:to-transparent","[&_th:last-child]:before:opacity-0 [&_th:last-child]:before:transition-all [&_th:last-child]:before:duration-400","[&_th:last-child]:before:easing-[0.24, 0.25, 0.05, 1] [&_th:last-child]:before:z-[60]");return(0,s.jsxs)("div",{className:(0,r.cn)(n,"relative"),children:[(0,s.jsx)("div",{className:(0,r.cn)("absolute inset-0 pointer-events-none z-50","before:absolute before:top-0 before:right-0 before:bottom-0 before:w-6 before:bg-gradient-to-l before:from-black/5 dark:before:from-black/20 before:to-transparent before:opacity-0 before:transition-all before:duration-400 before:easing-[0.24, 0.25, 0.05, 1]","after:absolute after:top-0 after:left-0 after:bottom-0 after:w-6 after:bg-gradient-to-r after:from-black/5 dark:after:from-black/20 after:to-transparent after:opacity-0 after:transition-all after:duration-400 after:easing-[0.24, 0.25, 0.05, 1]",u&&"hover:before:opacity-100 hover:after:opacity-100",p&&"before:opacity-100",m&&"after:opacity-100")}),(0,s.jsx)("div",{ref:c,className:(0,r.cn)("w-full overflow-auto",o&&["[&_tr>*:last-child]:sticky [&_tr>*:last-child]:z-50 [&_tr>*:last-child]:right-0","[&_tr:hover>*:last-child]:bg-transparent","[&_th>*:last-child]:bg-surface-100",h],u&&"[&_tr:hover>td:last-child]:!bg-surface-200",p&&"[&_td]:before:opacity-100 [&_tr>*:last-child]:before:opacity-100 [&_th:last-child]:before:opacity-100",a),...d,children:l})]})});n.displayName="ShadowScrollArea"},49510:(e,t,a)=>{"use strict";a.d(t,{e:()=>c});var s=a(56947),i=a(24523),r=a(19965);async function n(e,t){let{slug:a}=e;if(!a)throw Error("slug is required");let{data:s,error:r}=await (0,i.Jt)("/platform/organizations/{slug}/entitlements",{params:{path:{slug:a}},signal:t});return r&&(0,i.H4)(r),s}let l=function(e){let{slug:t}=e,{enabled:a=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,s.I)({queryKey:[r.O.entitlements(t)],queryFn:e=>{let{signal:a}=e;return n({slug:t},a)},enabled:a&&void 0!==t,...i,staleTime:18e5})};var o=a(53239),d=a(84512);function c(e,t,a){var s;let i=!t&&(null==a?void 0:a.enabled)!==!1,{data:r,isLoading:n,isSuccess:c}=(0,d.s)({enabled:i}),u=t||(null==r?void 0:r.slug),m=(null==a?void 0:a.enabled)!==!1&&!!u,{data:p,isLoading:h,isSuccess:f}=l({slug:u},{enabled:m}),{entitlement:x}=(0,o.useMemo)(()=>{if(!u)return{entitlement:null};let t=null==p?void 0:p.entitlements.find(t=>t.feature.key===e);return{entitlement:null!=t?t:null}},[p,e,u]),g=i?n:h,y=i?c&&f:f;return{hasAccess:null!=(s=null==x?void 0:x.hasAccess)&&s,isLoading:g,isSuccess:y,getEntitlementNumericValue:()=>(function(e){let t=null==e?void 0:e.config;return t&&e.type&&"numeric"===e.type?t.value:void 0})(x),isEntitlementUnlimited:()=>(function(e){let t=null==e?void 0:e.config;return!!(t&&e.type&&"numeric"===e.type)&&t.unlimited})(x),getEntitlementSetValues:()=>(function(e){let t=null==e?void 0:e.config;return t&&e.type&&"set"===e.type?t.set:[]})(x)}}},74713:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/settings/compute-and-disk",function(){return a(18065)}])},78511:(e,t,a)=>{"use strict";a.d(t,{A0:()=>o,BF:()=>d,Gg:()=>c,Hj:()=>u,XI:()=>l,nA:()=>p,nd:()=>m,r6:()=>h});var s=a(80263),i=a(53239),r=a(80100),n=a(31647);let l=i.forwardRef((e,t)=>{let{className:a,containerProps:i,...l}=e;return(0,s.jsx)(n.x,{...i,children:(0,s.jsx)("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",a),...l})})});l.displayName="Table";let o=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b [&>tr]:bg-200",a),...i})});o.displayName="TableHeader";let d=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",a),...i})});d.displayName="TableBody";let c=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)("tfoot",{ref:t,className:(0,r.cn)("bg-primary font-medium text-primary-foreground",a),...i})});c.displayName="TableFooter";let u=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)("tr",{ref:t,className:(0,r.cn)("border-b [&>td]:hover:bg-surface-200 data-[state=selected]:bg-muted",a),...i})});u.displayName="TableRow";let m=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)("th",{ref:t,className:(0,r.cn)("h-10 px-4 text-left align-middle heading-meta whitespace-nowrap text-foreground-lighter [&:has([role=checkbox])]:pr-0",a),...i})});m.displayName="TableHead";let p=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)("td",{ref:t,className:(0,r.cn)("transition-colors p-4 align-middle [&:has([role=checkbox])]:pr-0",a),...i})});p.displayName="TableCell";let h=i.forwardRef((e,t)=>{let{className:a,...i}=e;return(0,s.jsx)("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-foreground-muted",a),...i})});h.displayName="TableCaption"}},e=>{e.O(0,[60858,15599,16110,44952,36538,43833,47992,36159,76984,72391,74004,40545,596,10508,48340,75187,29471,81733,34338,90636,46593,38792],()=>e(e.s=74713)),_N_E=e.O()}]);