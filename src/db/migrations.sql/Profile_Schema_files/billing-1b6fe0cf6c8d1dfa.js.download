try{!function(){var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:{},a=(new e.Error).stack;a&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[a]="14412063-3666-4b9e-967a-1f0c4a0c5931",e._sentryDebugIdIdentifier="sentry-dbid-14412063-3666-4b9e-967a-1f0c4a0c5931")}()}catch(e){}(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[59522],{354:(e,a,t)=>{"use strict";t.d(a,{A:()=>r});var n=t(80263),s=t(30404);let r=e=>{let{projectUpdateDisabled:a,projectNotActive:t=!1,children:r,tooltip:l}=e;return(0,n.jsxs)(s.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"ProjectUpdateDisabledTooltip","data-sentry-source-file":"ProjectUpdateDisabledTooltip.tsx",children:[(0,n.jsx)(s.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"ProjectUpdateDisabledTooltip.tsx",children:r}),(a||t)&&(0,n.jsx)(s.ZI,{side:"bottom",className:"w-72 text-center",children:a?l||"Subscription changes are currently disabled. Our engineers are working on a fix.":t?"Unable to update subscription as project is currently not active":""})]})}},8e3:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(86848).A)("OctagonAlert",[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M15.312 2a2 2 0 0 1 1.414.586l4.688 4.688A2 2 0 0 1 22 8.688v6.624a2 2 0 0 1-.586 1.414l-4.688 4.688a2 2 0 0 1-1.414.586H8.688a2 2 0 0 1-1.414-.586l-4.688-4.688A2 2 0 0 1 2 15.312V8.688a2 2 0 0 1 .586-1.414l4.688-4.688A2 2 0 0 1 8.688 2z",key:"1fd625"}]])},11203:(e,a,t)=>{var n=t(40293);e.exports=function(e){return(null==e?0:e.length)?n(e,1):[]}},13655:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(86848).A)("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]])},13916:(e,a,t)=>{"use strict";t.d(a,{x:()=>o});var n=t(80263),s=t(53239),r=t(30404),l=t(21162),i=t(80100);let o=(0,s.forwardRef)((e,a)=>{let{...t}=e;return(0,n.jsxs)(r.m_,{children:[(0,n.jsx)(r.k$,{asChild:!0,children:(0,n.jsx)(l._2,{ref:a,...t,className:(0,i.cn)(t.className,"!pointer-events-auto"),onClick:e=>{!t.disabled&&t.onClick&&t.onClick(e)},children:t.children})}),t.disabled&&void 0!==t.tooltip.content.text&&(0,n.jsx)(r.ZI,{...t.tooltip.content,children:t.tooltip.content.text})]})});o.displayName="DropdownMenuItemTooltip"},16097:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(86848).A)("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]])},29948:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(86848).A)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},31626:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(86848).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},37253:(e,a,t)=>{var n=t(48550),s=t(92479),r=t(50084);e.exports=s(function(e,a){return r(e)?n(e,a):[]})},40314:(e,a,t)=>{"use strict";t.d(a,{A:()=>y});var n=t(80263),s=t(47023),r=t(11203),l=t.n(r),i=t(53239),o=t(23157),d=t(15471),c=t(50298),u=t(7981),m=t(80100),p=t(7760);let x=(0,i.createContext)({onChange:e=>{},selected:void 0});var h=t(23892);function g(e){let{children:a,className:t,buttonClassName:r,descriptionText:h,error:g,icon:y,id:f="",name:v="",label:j,labelOptional:b,layout:N,value:w,onChange:_,onFocus:S,onBlur:C,style:A,size:M="medium",defaultValue:I,validation:P,disabled:E,optionsWidth:k}=e,[F,T]=(0,i.useState)(void 0),[L,B]=(0,i.useState)({}),D=(0,u.A)("listbox"),R=(0,i.useRef)(null),{formContextOnChange:z,values:U,errors:q,handleBlur:O,touched:G,fieldLevelValidation:K}=(0,p.x)();U&&!w&&(w=U[f||v],I=U[f||v]),g||(q&&!g&&(g=q[f||v]),g=G&&G[f||v]?g:void 0),(0,i.useEffect)(()=>{void 0!==w&&T(w)},[w]),(0,i.useEffect)(()=>{function e(){var e;document.documentElement.style.setProperty("--width-listbox","".concat(k||(null==(e=R.current)?void 0:e.offsetWidth),"px"))}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{var e;let t=l()(a);function n(e){return t.find(a=>a.props.value===e)}if(w){T(w);let e=n(w);B((null==e?void 0:e.props)?e.props:void 0);return}if(F){let e=n(F);B((null==e?void 0:e.props)?e.props:void 0);return}if(I){T(I);let e=n(F);B((null==e?void 0:e.props)?e.props:void 0);return}B(null==(e=t[0])?void 0:e.props)},[F]);let H=[D.container,D.base,r],V=[D.addOnBefore];return g&&H.push(D.variants.error),g||H.push(D.variants.standard),y&&V.push(D.with_icon),M&&H.push(D.size[M]),E&&H.push(D.disabled),(0,n.jsx)(o.H,{label:j,labelOptional:b,layout:N,id:f,error:g,descriptionText:h,className:t,style:A,size:M,"data-sentry-element":"FormLayout","data-sentry-component":"Listbox","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsxs)(s.bL,{"data-sentry-element":"DropdownMenuPrimitive.Root","data-sentry-source-file":"Listbox2.tsx",children:[(0,n.jsx)(s.l9,{asChild:!0,disabled:E,"data-sentry-element":"DropdownMenuPrimitive.Trigger","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsxs)("button",{"data-size":M,ref:R,className:(0,m.cn)(H),onBlur:function(e){O&&O(e),C&&C(e)},onFocus:S,name:v,id:f,children:[(0,n.jsxs)("span",{className:(0,m.cn)(V),children:[y&&(0,n.jsx)(c.A,{size:M,icon:y}),(null==L?void 0:L.addOnBefore)&&(0,n.jsx)(L.addOnBefore,{}),(0,n.jsx)("span",{className:D.label,children:null==L?void 0:L.label})]}),(0,n.jsx)("span",{className:D.chevron_container,children:(0,n.jsx)("svg",{className:D.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-sentry-element":"svg","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd","data-sentry-element":"path","data-sentry-source-file":"Listbox2.tsx"})})}),g&&(0,n.jsx)("div",{className:D.actions_container,children:g&&(0,n.jsx)(d.A,{size:M})})]})}),(0,n.jsx)(s.UC,{sideOffset:6,loop:!0,side:"bottom",align:"center",className:D.options_container,"data-sentry-element":"DropdownMenuPrimitive.Content","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsx)("div",{children:(0,n.jsx)(x.Provider,{value:{onChange:function(e){_&&_(e),T(e);let a={};a.target={type:"select",name:v,id:f,value:e,checked:void 0},z&&z(a),P&&K(f,P(e))},selected:F},"data-sentry-element":"SelectContext.Provider","data-sentry-source-file":"Listbox2.tsx",children:a})})})]})})}g.Option=function(e){let{id:a,value:t,label:r,disabled:l=!1,children:i,className:o="",addOnBefore:d}=e,c=(0,u.A)("listbox");return(0,n.jsx)(x.Consumer,{"data-sentry-element":"SelectContext.Consumer","data-sentry-component":"SelectOption","data-sentry-source-file":"Listbox2.tsx",children:e=>{let{onChange:r,selected:u}=e,p=u===t;return(0,n.jsxs)(s.q7,{className:(0,m.cn)(c.option,p?c.option_active:" ",l?c.option_disabled:" ",o),onSelect:()=>l?{}:r(t),children:[(0,n.jsxs)("div",{className:c.option_inner,children:[d&&d({active:p,selected:u}),(0,n.jsx)("span",{children:"function"==typeof i?i({active:p,selected:u}):i})]}),p?(0,n.jsx)("span",{className:(0,m.cn)(c.option_check,p?c.option_check_active:""),children:(0,n.jsx)(h.A,{className:c.option_check_icon,"aria-hidden":"true"})}):null]},a)}})};let y=g},42459:(e,a,t)=>{"use strict";t.d(a,{c:()=>d});var n=t(80263),s=t(52555),r=t.n(s),l=t(80100),i=t(99779),o=t(44725);let d=e=>{let{urlBack:a,fullHeight:t=!0}=e;return(0,n.jsx)("div",{className:(0,l.cn)("w-full flex items-center justify-center",t&&"h-full"),"data-sentry-component":"UnknownInterface","data-sentry-source-file":"UnknownInterface.tsx",children:(0,n.jsx)(o.Z,{type:"note",className:"max-w-xl",title:"Looking for something?",description:"We couldn't find the page that you're looking for","data-sentry-element":"Admonition","data-sentry-source-file":"UnknownInterface.tsx",children:(0,n.jsx)(i.$,{asChild:!0,type:"default",className:"mt-2","data-sentry-element":"Button","data-sentry-source-file":"UnknownInterface.tsx",children:(0,n.jsx)(r(),{href:a,"data-sentry-element":"Link","data-sentry-source-file":"UnknownInterface.tsx",children:"Head back"})})})})}},48550:(e,a,t)=>{var n=t(45558),s=t(10116),r=t(59568),l=t(71057),i=t(10876),o=t(99582);e.exports=function(e,a,t,d){var c=-1,u=s,m=!0,p=e.length,x=[],h=a.length;if(!p)return x;t&&(a=l(a,i(t))),d?(u=r,m=!1):a.length>=200&&(u=o,m=!1,a=new n(a));e:for(;++c<p;){var g=e[c],y=null==t?g:t(g);if(g=d||0!==g?g:0,m&&y==y){for(var f=h;f--;)if(a[f]===y)continue e;x.push(g)}else u(a,y,d)||x.push(g)}return x}},50795:(e,a,t)=>{"use strict";t.d(a,{I:()=>r});var n=t(80263),s=t(99779);let r=e=>{let{form:a,hasChanges:t,handleReset:r,helper:l,disabled:i=!1,isSubmitting:o,submitText:d="Save"}=e,c=o||i||!t&&void 0!==t;return(0,n.jsxs)("div",{className:["flex w-full items-center gap-2",l?"justify-between":"justify-end"].join(" "),"data-sentry-component":"FormActions","data-sentry-source-file":"FormActions.tsx",children:[l&&(0,n.jsx)("span",{className:"text-sm text-foreground-lighter",children:l}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(s.$,{disabled:c,type:"default",htmlType:"reset",onClick:()=>r(),"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:"Cancel"}),(0,n.jsx)(s.$,{form:a,type:"primary",htmlType:"submit",disabled:c,loading:o,"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:d})]})]})}},51058:(e,a,t)=>{"use strict";t.d(a,{$:()=>i});var n=t(80251),s=t(73969),r=t(24523);async function l(e){let{projectRef:a,orgSlug:t,reasons:n,message:s,exitAction:l}=e,{data:i,error:o}=await (0,r.bE)("/platform/feedback/downgrade",{body:{...void 0!==a&&{projectRef:a},...void 0!==t&&{orgSlug:t},reasons:n,additionalFeedback:s,exitAction:l}});return o&&(0,r.H4)(o),i}let i=function(){let{onError:e,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,n.n)({mutationFn:e=>l(e),async onError(a,t,n){void 0===e?s.oR.error("Failed to submit exit survey: ".concat(a.message)):e(a,t,n)},...a})}},54831:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(86848).A)("Loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]])},55315:(e,a,t)=>{var n=t(71057);e.exports=function(e,a){return n(a,function(a){return e[a]})}},56409:(e,a,t)=>{"use strict";t.d(a,{A:()=>i});var n=t(56947),s=t(24523),r=t(19965);async function l(e,a){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:n,error:r}=await (0,s.Jt)("/platform/organizations/{slug}/members/reached-free-project-limit",{params:{path:{slug:t}},signal:a});return r&&(0,s.H4)(r),n}let i=function(e){let{slug:a}=e,{enabled:t=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)({queryKey:r.O.freeProjectLimitCheck(a),queryFn:e=>{let{signal:t}=e;return l({slug:a},t)},enabled:t&&void 0!==a,...s})}},61741:(e,a,t)=>{var n=t(55315),s=t(24967);e.exports=function(e){return null==e?[]:n(e,s(e))}},66711:(e,a,t)=>{"use strict";t.d(a,{A:()=>n});let n=(0,t(86848).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},68840:(e,a,t)=>{"use strict";t.d(a,{YX:()=>d,_4:()=>c,ge:()=>i,lB:()=>l});var n=t(80263),s=t(53239),r=t(80100);let l=e=>{let{children:a,header:t,footer:s}=e;return(0,n.jsxs)(i,{"data-sentry-element":"FormPanelContainer","data-sentry-component":"FormPanel","data-sentry-source-file":"FormPanel.tsx",children:[t&&(0,n.jsx)(o,{children:t}),(0,n.jsx)(d,{className:"divide-y","data-sentry-element":"FormPanelContent","data-sentry-source-file":"FormPanel.tsx",children:a}),s&&(0,n.jsx)(c,{children:s})]})},i=(0,s.forwardRef)((e,a)=>{let{children:t,...s}=e;return(0,n.jsx)("div",{ref:a,...s,className:(0,r.cn)("bg-surface-100 border overflow-hidden rounded-md shadow max-w-full",s.className),children:t})});i.displayName=i.displayName;let o=(0,s.forwardRef)((e,a)=>{let{children:t,...s}=e;return(0,n.jsx)("div",{ref:a,...s,className:(0,r.cn)("border-default border-b px-8 py-4",s.className),children:t})});o.displayName=o.displayName;let d=(0,s.forwardRef)((e,a)=>{let{children:t,...s}=e;return(0,n.jsx)("div",{ref:a,...s,className:(0,r.cn)("divide-border flex flex-col gap-0",s.className),children:t})});d.displayName=d.displayName;let c=(0,s.forwardRef)((e,a)=>{let{children:t,...s}=e;return(0,n.jsx)("div",{ref:a,...s,className:(0,r.cn)("border-t",s.className),children:t})});c.displayName=c.displayName},78039:(e,a,t)=>{"use strict";t.d(a,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>l,aR:()=>i,wL:()=>u});var n=t(80263),s=t(53239),r=t(80100);let l=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:a,className:(0,r.cn)("overflow-hidden rounded-lg border bg-surface-100 text-card-foreground shadow-sm",t),...s})});l.displayName="Card";let i=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:a,className:(0,r.cn)("flex flex-col space-y-1.5 py-4 px-6 border-b",t),...s})});i.displayName="CardHeader";let o=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("h3",{ref:a,className:(0,r.cn)("text-xs font-mono uppercase",t),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("p",{ref:a,className:(0,r.cn)("text-sm text-foreground-muted",t),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:a,className:(0,r.cn)("py-4 px-6 border-b last:border-none",t),...s})});c.displayName="CardContent";let u=s.forwardRef((e,a)=>{let{className:t,...s}=e;return(0,n.jsx)("div",{ref:a,className:(0,r.cn)(" flex items-center py-4 px-6",t),...s})});u.displayName="CardFooter"},78228:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>tE});var n=t(80263),s=t(53239),r=t(22891),l=t(37873),i=t(96698),o=t(2657),d=t(84512),c=t(80100),u=t(60045),m=t(90376);let p=(0,t(86848).A)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var x=t(73969),h=t(83458),g=t(99265),y=t(91419),f=t(796),v=t(6217),j=t(80251),b=t(24523);async function N(e){let{slug:a,hcaptchaToken:t}=e,{data:n,error:s}=await (0,b.bE)("/platform/organizations/{slug}/payments/setup-intent",{params:{path:{slug:a}},body:{hcaptchaToken:t}});return s&&(0,b.H4)(s),n}let w=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,j.n)({mutationFn:e=>N(e),async onSuccess(a,t,n){await (null==e?void 0:e(a,t,n))},async onError(e,t,n){void 0===a?x.oR.error("Failed to setup intent: ".concat(e.message)):a(e,t,n)},...t})};var _=t(85039),S=t(32144),C=t(88895),A=t(19965),M=t(56947),I=t(80090);async function P(e,a){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:n,error:s}=await (0,b.Jt)("/platform/organizations/{slug}/customer",{params:{path:{slug:t}},signal:a});return s&&(0,b.H4)(s),n}let E=function(e){let{slug:a}=e,{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{can:s}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.customer");return(0,M.I)({queryKey:A.O.customerProfile(a),queryFn:e=>{let{signal:t}=e;return P({slug:a},t)},enabled:r.pe&&t&&s&&void 0!==a,...n})};async function k(e){let{slug:a,address:t,billing_name:n}=e;if(!a)return console.error("Slug is required");let{data:s,error:r}=await (0,b.yJ)("/platform/organizations/{slug}/customer",{params:{path:{slug:a}},body:{address:null!=t?t:void 0,billing_name:n}});if(r)throw(0,b.H4)(r);return s}let F=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,S.jE)();return(0,j.n)({mutationFn:e=>k(e),async onSuccess(a,t,s){let{address:r,slug:l,billing_name:i}=t;n.setQueriesData({queryKey:A.O.customerProfile(l)},e=>e?{...e,billing_name:i,address:r}:e),await (null==e?void 0:e(a,t,s))},async onError(e,t,n){void 0===a?x.oR.error("Failed to update customer profile: ".concat(e.message)):a(e,t,n)},...t})};async function T(e){let{slug:a,paymentMethodId:t}=e;if(!a)throw Error("Slug is required");let{data:n,error:s}=await (0,b.yJ)("/platform/organizations/{slug}/payments/default",{body:{payment_method_id:t},params:{path:{slug:a}}});if(s)throw(0,b.H4)(s);return n}let L=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,S.jE)();return(0,j.n)({mutationFn:e=>T(e),async onSuccess(a,t,s){let{slug:r,paymentMethodId:l}=t;n.setQueriesData({queryKey:A.O.paymentMethods(r)},e=>e?{...e,defaultPaymentMethodId:l,data:e.data.map(e=>({...e,is_default:e.id===l}))}:e),await (null==e?void 0:e(a,t,s))},async onError(e,t,n){void 0===a?x.oR.error("Failed to mark payment method as default: ".concat(e.message)):a(e,t,n)},...t})};async function B(e,a){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:n,error:s}=await (0,b.Jt)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:t}},signal:a});if(s)throw(0,b.H4)(s);return n.tax_id}let D=function(e){let{slug:a}=e,{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{can:s}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.tax_ids");return(0,M.I)({queryKey:A.O.taxId(a),queryFn:e=>{let{signal:t}=e;return B({slug:a},t)},enabled:t&&void 0!==a&&s,...n})};async function R(e){let{slug:a,taxId:t}=e;if(!a)throw Error("Slug is required");if(null!=t){let{data:e,error:n}=await (0,b.yJ)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:a}},body:{type:t.type,value:t.value,country:t.country}});return n&&(0,b.H4)(n),e}{let{data:e,error:t}=await (0,b.yH)("/platform/organizations/{slug}/tax-ids",{params:{path:{slug:a}},headers:{Version:"2"}});return t&&(0,b.H4)(t),e}}let z=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,S.jE)();return(0,j.n)({mutationFn:e=>R(e),async onSuccess(a,t,s){let{slug:r}=t;n.setQueryData(A.O.taxId(r),a.tax_id),await (null==e?void 0:e(a,t,s))},async onError(e,t,n){void 0===a?x.oR.error("Failed to update tax id: ".concat(e.message)):a(e,t,n)},...t})};var U=t(84305),q=t.n(U),O=t(48156),G=t(883),K=t(99779),H=t(16488);let V=e=>{let{onCancel:a,onConfirm:t}=e,{data:r}=(0,d.s)(),{data:l,isLoading:i}=E({slug:null==r?void 0:r.slug}),[o,c]=(0,s.useState)(!1),[u,m]=(0,s.useState)(!0),[p,h]=(0,s.useState)(!0),g=(0,S.jE)(),{mutateAsync:y}=L(),{mutateAsync:f}=F(),{mutateAsync:j}=z(),{data:b,isLoading:N}=D({slug:null==r?void 0:r.slug}),w=(0,s.useRef)(null),_=async e=>{var a,n;e.preventDefault(),c(!0),void 0!==document&&document.body.classList.add("!pointer-events-auto");let s=await (null==(a=w.current)?void 0:a.confirmSetup());if(s){if(u&&r&&"string"==typeof(null==(n=s.setupIntent)?void 0:n.payment_method))try{await y({slug:r.slug,paymentMethodId:s.setupIntent.payment_method}),await g.invalidateQueries({queryKey:A.O.paymentMethods(r.slug)}),g.setQueriesData({queryKey:A.O.paymentMethods(r.slug)},e=>e?{...e,defaultPaymentMethodId:s.setupIntent.payment_method,data:e.data.map(e=>({...e,is_default:e.id===s.setupIntent.payment_method}))}:e)}catch(e){x.oR.error("Failed to set payment method as default")}else r&&await g.invalidateQueries({queryKey:A.O.paymentMethods(r.slug)});if(p)try{s.address&&(!q()(s.address,null==l?void 0:l.address)||(null==l?void 0:l.billing_name)!==s.customerName)&&await f({slug:null==r?void 0:r.slug,billing_name:s.customerName,address:s.address}),s.taxId&&!q()(s.taxId,b)&&await j({taxId:s.taxId,slug:null==r?void 0:r.slug})}catch(e){x.oR.error("Failed to update billing address")}c(!1),t()}else c(!1);void 0!==document&&document.body.classList.remove("!pointer-events-auto")};return i||N?(0,n.jsx)(v.A.Content,{children:(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(H.A,{}),(0,n.jsx)(H.A,{className:"w-3/4"}),(0,n.jsx)(H.A,{className:"w-1/2"}),(0,n.jsx)(H.A,{}),(0,n.jsx)(H.A,{}),(0,n.jsx)(H.A,{})]})}):(0,n.jsxs)("div",{"data-sentry-component":"AddPaymentMethodForm","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:[(0,n.jsxs)(v.A.Content,{className:"transition ".concat(o?"pointer-events-none opacity-75":"opacity-100"),"data-sentry-element":"Modal.Content","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:[(0,n.jsx)(C.S,{readOnly:o,email:null==r?void 0:r.billing_email,currentAddress:null==l?void 0:l.address,customerName:null==l?void 0:l.billing_name,currentTaxId:b,ref:w,"data-sentry-element":"NewPaymentMethodElement","data-sentry-source-file":"AddPaymentMethodForm.tsx"}),(0,n.jsxs)("div",{className:"flex items-center gap-x-2 mt-4 mb-2",children:[(0,n.jsx)(O.S,{id:"save-as-default",checked:u,onCheckedChange:e=>{"boolean"==typeof e&&m(e)},"data-sentry-element":"Checkbox_Shadcn_","data-sentry-source-file":"AddPaymentMethodForm.tsx"}),(0,n.jsx)(G.J,{htmlFor:"save-as-default",className:"text-foreground-light","data-sentry-element":"Label_Shadcn_","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:"Save as default payment method"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-x-2 mt-4 mb-2",children:[(0,n.jsx)(O.S,{id:"is-primary-billing-address",checked:p,onCheckedChange:e=>{"boolean"==typeof e&&h(e)},"data-sentry-element":"Checkbox_Shadcn_","data-sentry-source-file":"AddPaymentMethodForm.tsx"}),(0,n.jsx)(G.J,{htmlFor:"is-primary-billing-address",className:"text-foreground-light","data-sentry-element":"Label_Shadcn_","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:"Use the billing address as my organization's primary address"})]})]}),(0,n.jsx)(v.A.Separator,{"data-sentry-element":"Modal.Separator","data-sentry-source-file":"AddPaymentMethodForm.tsx"}),(0,n.jsxs)(v.A.Content,{className:"flex items-center space-x-2","data-sentry-element":"Modal.Content","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:[(0,n.jsx)(K.$,{htmlType:"button",size:"small",type:"default",onClick:a,block:!0,disabled:o,"data-sentry-element":"Button","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:"Cancel"}),(0,n.jsx)(K.$,{block:!0,htmlType:"button",size:"small",type:"primary",loading:o,disabled:o,onClick:_,"data-sentry-element":"Button","data-sentry-source-file":"AddPaymentMethodForm.tsx",children:"Add payment method"})]})]})};var Y=t(41687);let W=(0,y.c)(_.WS),$=e=>{let{visible:a,returnUrl:t,onCancel:r,onConfirm:l}=e,{resolvedTheme:i}=(0,f.D)(),[o,c]=(0,s.useState)(),{data:u}=(0,d.s)(),[m,p]=(0,s.useState)(null),[y,j]=(0,s.useState)(null),{mutate:b}=w({onSuccess:e=>{c(e)},onError:e=>{x.oR.error("Failed to setup intent: ".concat(e.message))}}),N=(0,s.useCallback)(e=>{j(e)},[]);(0,s.useEffect)(()=>{let e=async e=>{let a=null==u?void 0:u.slug;return a?e?void(c(void 0),b({slug:a,hcaptchaToken:e})):console.error("HCaptcha token required"):console.error("Slug is required")};(async()=>{if(a&&y){let a=m;try{if(!a){var t;let e=await y.execute({async:!0});a=null!=(t=null==e?void 0:e.response)?t:null}}catch(e){return}await e(null!=a?a:void 0),_()}})()},[a,y]);let _=()=>{p(null),null==y||y.resetCaptcha()},S={clientSecret:o?o.client_secret:"",appearance:(0,Y.D)(i)},C=()=>(c(void 0),r());return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.A,{ref:N,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{C(),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onVerify:e=>{p(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>{p(null)},"data-sentry-element":"HCaptcha","data-sentry-source-file":"AddNewPaymentMethodModal.tsx"}),(0,n.jsx)(v.A,{hideFooter:!0,size:"medium",visible:a&&void 0!==o,header:"Add new payment method",onCancel:C,className:"PAYMENT","data-sentry-element":"Modal","data-sentry-source-file":"AddNewPaymentMethodModal.tsx",children:(0,n.jsx)(g.Elements,{stripe:W,options:S,"data-sentry-element":"Elements","data-sentry-source-file":"AddNewPaymentMethodModal.tsx",children:(0,n.jsx)(V,{returnUrl:t,onCancel:C,onConfirm:()=>(c(void 0),l()),"data-sentry-element":"AddPaymentMethodForm","data-sentry-source-file":"AddNewPaymentMethodModal.tsx"})})})]})};var Q=t(27695),J=t(44168),Z=t(68840),X=t(79775),ee=t(39624),ea=t(29805),et=t(53931);async function en(e,a){let{slug:t}=e;if(!t)throw Error("slug is required");let{data:n,error:s}=await (0,b.Jt)("/platform/organizations/{slug}/payments",{params:{path:{slug:t}},headers:{Version:"2"},signal:a});return s&&(0,b.H4)(s),n}let es=function(e){let{slug:a}=e,{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{can:s}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.payment_methods");return(0,M.I)({queryKey:A.O.paymentMethods(a),queryFn:e=>{let{signal:t}=e;return en({slug:a},t)},enabled:t&&void 0!==a&&s,...n})};var er=t(98174),el=t(6436),ei=t(88845);let eo=e=>{var a,t;let{selectedPaymentMethod:s,onClose:l}=e,{slug:i}=(0,r.g)(),{mutate:o,isLoading:d}=L({onSuccess:()=>{x.oR.success("Successfully changed payment method to the card ending with ".concat(s.card.last4)),l()},onError:e=>{x.oR.error("Failed to change payment method: ".concat(e.message))}}),c=async()=>i?s?void o({slug:i,paymentMethodId:s.id}):console.error("Card ID is required"):console.error("Slug is required");return(0,n.jsx)(v.A,{visible:void 0!==s,size:"medium",header:"Confirm to use payment method ending with ".concat(null==s||null==(a=s.card)?void 0:a.last4),onCancel:()=>l(),customFooter:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(K.$,{type:"default",disabled:d,onClick:()=>l(),children:"Cancel"}),(0,n.jsx)(K.$,{type:"primary",disabled:d,loading:d,onClick:c,children:"Confirm"})]}),"data-sentry-element":"Modal","data-sentry-component":"ChangePaymentMethodModal","data-sentry-source-file":"ChangePaymentMethodModal.tsx",children:(0,n.jsx)(v.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"ChangePaymentMethodModal.tsx",children:(0,n.jsxs)("p",{className:"text-sm",children:["Upon clicking confirm, all future charges will be deducted from the card ending with"," ",null==s||null==(t=s.card)?void 0:t.last4,". There are no immediate charges."]})})})};var ed=t(66711),ec=t(13916),eu=t(21650),em=t(21162);let ep=e=>{var a,t,s,r;let{paymentMethod:l,canUpdatePaymentMethods:i=!0,paymentMethodType:o,subscriptionPlan:d,paymentMethodCount:c,setSelectedMethodForUse:u,setSelectedMethodToDelete:m}=e,p=l.is_default,x=!l.is_default||"free"===d&&1===c,h=null!=(s=null==(a=l.card)?void 0:a.exp_year)?s:0,g=null!=(r=null==(t=l.card)?void 0:t.exp_month)?r:0,y=new Date().getMonth()+1,f=new Date().getFullYear();return l.card?(0,n.jsxs)("div",{className:"flex items-center justify-between gap-8","data-sentry-component":"CreditCard","data-sentry-source-file":"CreditCard.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-8",children:[(0,n.jsx)("img",{alt:"Credit card brand",src:"".concat(_.o2,"/img/payment-methods/").concat(l.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),(0,n.jsxs)("p",{className:"prose text-sm font-mono",children:["**** **** **** ",l.card.last4]}),(0,n.jsxs)("p",{className:"text-sm tabular-nums",children:["Expires: ",l.card.exp_month,"/",l.card.exp_year]})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[h===f&&g===y&&(0,n.jsx)(eu.E,{variant:"warning",children:"Expiring soon"}),(h<f||h===f&&g<y)&&(0,n.jsx)(eu.E,{variant:"destructive",children:"Expired"}),p&&(0,n.jsx)(eu.E,{variant:"brand",children:"Active"}),i&&(0,n.jsxs)(em.rI,{children:[(0,n.jsx)(em.ty,{asChild:!0,children:(0,n.jsx)(K.$,{type:"outline",className:"hover:border-muted px-1",icon:(0,n.jsx)(ed.A,{}),"aria-label":"More options"})}),(0,n.jsxs)(em.SQ,{align:"end",className:"w-36",children:["card"===o&&!p&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(em._2,{onClick:()=>null==u?void 0:u(l),children:(0,n.jsx)("p",{children:"Use this card"})},"make-default"),(0,n.jsx)(em.mB,{})]}),(0,n.jsx)(ec.x,{disabled:!x,className:"!pointer-events-auto",onClick:()=>null==m?void 0:m(l),tooltip:{content:{side:"left",text:x?void 0:"Unable to delete a card that is currently active"}},children:(0,n.jsx)("p",{children:"Delete card"})},"delete-method")]})]})]})]},l.id):null};async function ex(e){let{slug:a,cardId:t}=e,{data:n,error:s}=await (0,b.yH)("/platform/organizations/{slug}/payments",{body:{card_id:t},params:{path:{slug:a}}});return s&&(0,b.H4)(s),n}let eh=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,S.jE)();return(0,j.n)({mutationFn:e=>ex(e),async onSuccess(a,t,s){let{slug:r}=t;await n.invalidateQueries({queryKey:A.O.paymentMethods(r)}),await (null==e?void 0:e(a,t,s))},async onError(e,t,n){void 0===a?x.oR.error("Failed to delete payment method: ".concat(e.message)):a(e,t,n)},...t})};var eg=t(44725);let ey=e=>{var a;let{selectedPaymentMethod:t,onClose:s}=e,{slug:l}=(0,r.g)(),{mutate:i,isLoading:o}=eh({onSuccess:()=>{var e;x.oR.success("Successfully removed payment method ending with ".concat(null==t||null==(e=t.card)?void 0:e.last4)),s()}}),d=async()=>l?t?void i({slug:l,cardId:t.id}):console.error("Card ID is required"):console.error("Slug is required");return(0,n.jsx)(v.A,{visible:void 0!==t,size:"medium",header:"Confirm to delete payment method ending with ".concat(null==t||null==(a=t.card)?void 0:a.last4),onCancel:()=>s(),customFooter:(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(K.$,{type:"default",disabled:o,onClick:()=>s(),children:"Cancel"}),(0,n.jsx)(K.$,{type:"primary",disabled:o,loading:o,onClick:d,children:"Confirm"})]}),"data-sentry-element":"Modal","data-sentry-component":"DeletePaymentMethodModal","data-sentry-source-file":"DeletePaymentMethodModal.tsx",children:(0,n.jsx)(v.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"DeletePaymentMethodModal.tsx",children:(0,n.jsx)(eg.Z,{type:"default",title:"This will permanently delete your payment method.",description:"You can re-add the payment method any time.","data-sentry-element":"Admonition","data-sentry-source-file":"DeletePaymentMethodModal.tsx"})})})},ef=()=>{var e,a,t;let{slug:o}=(0,r.g)(),{data:c}=(0,d.s)(),[h,g]=(0,s.useState)(),[y,f]=(0,s.useState)(),[v,j]=(0,s.useState)(!1),{data:b}=(0,i.j5)({orgSlug:o}),{data:N,error:w,isLoading:_,isError:S,isSuccess:C}=es({slug:o}),{can:A,isSuccess:M}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.payment_methods"),{can:P}=(0,I.Qp)(u.aG.BILLING_WRITE,"stripe.payment_methods");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"PaymentMethods.tsx",children:[(0,n.jsx)(l.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"PaymentMethods.tsx",children:(0,n.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,n.jsx)("p",{className:"text-foreground text-base m-0",children:"Payment Methods"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light mb-2 pr-4 m-0",children:"Payments for your subscription are made using the default card."})]})}),(0,n.jsx)(l.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"PaymentMethods.tsx",children:(null==c?void 0:c.managed_by)!==void 0&&(null==c?void 0:c.managed_by)!==er.Kf.SUPABASE?(0,n.jsx)(ea.A,{managedBy:null==c?void 0:c.managed_by,resource:"Payment Methods",cta:{installationId:null==c?void 0:c.partner_id}}):M&&!A?(0,n.jsx)(ee.A,{resourceText:"view this organization's payment methods"}):(0,n.jsxs)(n.Fragment,{children:[_&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(et.Ay,{}),(0,n.jsx)(et.Ay,{className:"w-3/4"}),(0,n.jsx)(et.Ay,{className:"w-1/2"})]}),S&&(0,n.jsx)(J.A,{subject:"Failed to retrieve payment methods",error:w}),C&&(0,n.jsxs)(n.Fragment,{children:[(null==b?void 0:b.payment_method_type)==="invoice"&&(0,n.jsx)(ei.F,{withIcon:!0,variant:"info",title:"Payment is currently by invoice",actions:[(0,n.jsx)(K.$,{asChild:!0,type:"default",children:(0,n.jsx)(Q.Y,{className:"ml-3",queryParams:{category:u.S.BILLING,subject:"Request to change payment method"},children:"Contact support"})},"payment-method-support")],children:"You get a monthly invoice and payment link via email. To change your payment method, please contact us via our support form."}),(0,n.jsx)(Z.lB,{footer:(0,n.jsxs)("div",{className:"flex items-center justify-between py-4 px-8",children:[P?(0,n.jsx)("div",{}):(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"You need additional permissions to manage payment methods"}),(0,n.jsx)(K.$,{type:"default",icon:(0,n.jsx)(m.A,{}),disabled:!P,onClick:()=>j(!0),children:"Add new card"})]}),children:(0,n.jsx)(X.y9,{children:(0,n.jsx)(X.DE,{fullWidth:!0,loading:!1,children:(null!=(t=null==N||null==(e=N.data)?void 0:e.length)?t:0)===0?(0,n.jsxs)("div",{className:"flex items-center gap-2 opacity-50",children:[(0,n.jsx)(p,{size:16,strokeWidth:1.5}),(0,n.jsx)("p",{className:"text-sm",children:"No payment methods"})]}):(0,n.jsx)("div",{className:"space-y-3",children:null==N||null==(a=N.data)?void 0:a.map(e=>{var a;return(0,n.jsx)(ep,{paymentMethod:e,canUpdatePaymentMethods:P,paymentMethodType:null==b?void 0:b.payment_method_type,setSelectedMethodForUse:g,setSelectedMethodToDelete:f,paymentMethodCount:null!=(a=null==N?void 0:N.data.length)?a:0,subscriptionPlan:null==b?void 0:b.plan.id},e.id)})})})})})]})]})})]}),(0,n.jsx)($,{visible:v,returnUrl:"".concat((0,el.AP)(),"/org/").concat(o,"/billing"),onCancel:()=>j(!1),onConfirm:()=>{j(!1),x.oR.success("Successfully added new payment method")},"data-sentry-element":"AddNewPaymentMethodModal","data-sentry-source-file":"PaymentMethods.tsx"}),(0,n.jsx)(eo,{selectedPaymentMethod:h,onClose:()=>g(void 0),"data-sentry-element":"ChangePaymentMethodModal","data-sentry-source-file":"PaymentMethods.tsx"}),(0,n.jsx)(ey,{selectedPaymentMethod:y,onClose:()=>f(void 0),"data-sentry-element":"DeletePaymentMethodModal","data-sentry-source-file":"PaymentMethods.tsx"})]})};var ev=t(53434),ej=t.n(ev),eb=t(30404),eN=function(e){return e.DRAFT="draft",e.PAID="paid",e.VOID="void",e.UNCOLLECTIBLE="uncollectible",e.OPEN="open",e.ISSUED="issued",e}({});let ew={[eN.DRAFT]:{label:"Upcoming",badgeVariant:"warning"},[eN.PAID]:{label:"Paid",badgeVariant:"brand"},[eN.VOID]:{label:"Forgiven",badgeVariant:"brand"},[eN.UNCOLLECTIBLE]:{label:"Outstanding",badgeVariant:"destructive"},[eN.OPEN]:{label:"Outstanding",badgeVariant:"destructive"},[eN.ISSUED]:{label:"Outstanding",badgeVariant:"destructive"}},e_=e=>{let{status:a,paymentAttempted:t}=e,s=ew[a];return(0,n.jsxs)(eb.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"InvoiceStatusBadge","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:[(0,n.jsx)(eb.k$,{"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:(0,n.jsx)(eu.E,{size:"small",className:"capitalize",variant:(null==s?void 0:s.badgeVariant)||"default","data-sentry-element":"Badge","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:(null==s?void 0:s.label)||a})}),(0,n.jsxs)(eb.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"InvoiceStatusBadge.tsx",children:[[eN.OPEN,eN.ISSUED,eN.UNCOLLECTIBLE].includes(a)&&(t?(0,n.jsx)("p",{className:"text-xs text-foreground",children:'We were not able to collect the payment. Make sure you have a valid payment method and enough funds. Outstanding invoices may cause restrictions. You can manually pay the invoice using the "Pay Now" button.'}):(0,n.jsx)("p",{className:"text-xs text-foreground",children:'The invoice will soon be charged for. In case you pay via invoice instead of card, please make sure to make the payment in a timely manner. You can also pay the invoice using your card now using the "Pay Now" button.'})),a===eN.DRAFT&&(0,n.jsx)("p",{className:"text-xs text-foreground",children:"The invoice will soon be finalized and charged for."}),a===eN.PAID&&(0,n.jsx)("p",{className:"text-xs text-foreground",children:"The invoice has been paid successfully. No action is required on your side."}),a===eN.VOID&&(0,n.jsx)("p",{className:"text-xs text-foreground",children:"This invoice has been forgiven. No action is required on your side."})]})]})};var eS=t(68856),eC=t(23729),eA=t(10921);async function eM(e,a){let{invoiceId:t,slug:n}=e;if(!t)throw Error("Invoice ID is required");if(!n)throw Error("Slug is required");let{data:s,error:r}=await (0,b.Jt)("/platform/organizations/{slug}/billing/invoices/{invoice_id}",{params:{path:{invoice_id:t,slug:n}},signal:a});return r&&(0,b.H4)(r),s}async function eI(e,a){let{slug:t}=e;if(!t)throw Error("Slug is required");let n=await (0,b.d5)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:t}},signal:a,parseAs:"text"});if(n.error)throw n.error;return Number(n.response.headers.get("X-Total-Count"))}let eP=function(e){let{slug:a}=e,{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,M.I)({queryKey:eA.x.count(a),queryFn:e=>{let{signal:t}=e;return eI({slug:a},t)},enabled:t&&void 0!==a,...n})};async function eE(e,a){let{slug:t,offset:n=0,limit:s=10}=e;if(!t)throw Error("Org slug is required");let{data:r,error:l}=await (0,b.Jt)("/platform/organizations/{slug}/billing/invoices",{params:{path:{slug:t},query:{offset:n,limit:s}},signal:a});return l&&(0,b.H4)(l),r}let ek=function(e){let{slug:a,offset:t,limit:n}=e,{enabled:s=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,M.I)({queryKey:eA.x.list(a,t),queryFn:e=>{let{signal:s}=e;return eE({slug:a,offset:t,limit:n},s)},enabled:s&&void 0!==a,...r})};var eF=t(2534),eT=t(29948),eL=t(23019),eB=t(76196);async function eD(e){let{slug:a,invoiceId:t}=e;if(!a)throw Error("Org slug is required");if(!t)throw Error("Invoice ID is required");let{data:n,error:s}=await (0,b.Jt)("/platform/organizations/{slug}/billing/invoices/{invoice_id}/payment-link",{params:{path:{slug:a,invoice_id:t}}});return s&&(0,b.H4)(s),n}let eR=function(){let{onError:e,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,S.jE)();return(0,j.n)({mutationFn:e=>eD(e),async onError(a,n,s){await Promise.all([t.invalidateQueries({queryKey:eA.x.listAndCount(n.slug)})]),void 0===e?x.oR.error(a.message):e(a,n,s)},...a})},ez=e=>{let{slug:a,invoiceId:t}=e,{mutate:s,isLoading:r}=eR({onSuccess(e){x.oR.success("Redirecting to payment gateway..."),window.location.href=e.redirectUrl}});return(0,n.jsx)(K.$,{onClick:function(){s({slug:a,invoiceId:t})},loading:r,disabled:r,"data-sentry-element":"Button","data-sentry-component":"InvoicePayButton","data-sentry-source-file":"InvoicePayButton.tsx",children:"Pay Now"})},eU=()=>{let[e,a]=(0,s.useState)(1),{data:t}=(0,d.s)(),r=null==t?void 0:t.slug,l=(e-1)*5,{data:i,isError:o}=eP({slug:r},{enabled:(null==t?void 0:t.managed_by)==="supabase"}),{data:c,error:u,isLoading:m,isError:p}=ek({slug:r,offset:l,limit:5},{enabled:(null==t?void 0:t.managed_by)==="supabase"}),h=c||[];(0,s.useEffect)(()=>{a(1)},[r]);let g=async e=>{try{let a=await eM({invoiceId:e,slug:r});(null==a?void 0:a.invoice_pdf)&&window.open(a.invoice_pdf,"_blank")}catch(e){x.oR.error("Failed to fetch the selected invoice: ".concat(e.message))}};return(null==t?void 0:t.managed_by)!==void 0&&(null==t?void 0:t.managed_by)!=="supabase"?(0,n.jsx)(ea.A,{managedBy:null==t?void 0:t.managed_by,resource:"Invoices",cta:(e=>e.managed_by===er.Kf.VERCEL_MARKETPLACE?{installationId:null==e?void 0:e.partner_id,path:"/invoices"}:e.managed_by===er.Kf.AWS_MARKETPLACE?{organizationSlug:null==e?void 0:e.slug,overrideUrl:"https://console.aws.amazon.com/billing/home#/bills"}:void 0)(t)}):(0,n.jsx)("div",{className:"overflow-hidden md:overflow-auto overflow-x-scroll","data-sentry-component":"InvoicesSettings","data-sentry-source-file":"InvoicesSettings.tsx",children:(0,n.jsx)(eS.A,{head:[(0,n.jsx)(eS.A.th,{},"header-icon"),(0,n.jsx)(eS.A.th,{children:"Date"},"header-date"),(0,n.jsx)(eS.A.th,{children:"Amount"},"header-amount"),(0,n.jsx)(eS.A.th,{children:"Invoice number"},"header-invoice"),(0,n.jsx)(eS.A.th,{className:"flex items-center",children:"Status"},"header-status"),(0,n.jsx)(eS.A.th,{className:"text-right"},"header-download")],body:m?Array(6).fill(0).map((e,a)=>(0,n.jsxs)(eS.A.tr,{children:[(0,n.jsx)(eS.A.td,{children:5!==a&&(0,n.jsx)(eF.A,{size:"24"})}),(0,n.jsx)(eS.A.td,{colSpan:5,children:(0,n.jsx)(H.A,{})})]},"loading-".concat(a))):p?(0,n.jsx)(eS.A.tr,{className:"rounded-b",children:(0,n.jsx)(eS.A.td,{colSpan:6,className:"!p-0 !rounded-b overflow-hidden",children:(0,n.jsx)(J.A,{className:"border-0 rounded-none",error:u,subject:"Failed to retrieve invoices"})})}):0===h.length?(0,n.jsx)(eS.A.tr,{children:(0,n.jsx)(eS.A.td,{colSpan:6,className:"p-3 py-12 text-center",children:(0,n.jsx)("p",{className:"text-foreground-light",children:m?"Checking for invoices":"No invoices for this organization yet"})})}):(0,n.jsxs)(n.Fragment,{children:[h.map(e=>(0,n.jsxs)(eS.A.tr,{children:[(0,n.jsx)(eS.A.td,{children:(0,n.jsx)(eF.A,{size:"24"})}),(0,n.jsx)(eS.A.td,{children:(0,n.jsx)("p",{children:ej()(1e3*e.period_end).format("MMM DD, YYYY")})}),(0,n.jsx)(eS.A.td,{translate:"no",children:(0,n.jsx)("p",{children:(0,el.vv)(e.amount_due/100)})}),(0,n.jsx)(eS.A.td,{children:(0,n.jsx)("p",{children:e.number})}),(0,n.jsx)(eS.A.td,{children:(0,n.jsx)(e_,{status:e.status,paymentAttempted:e.payment_attempted})}),(0,n.jsx)(eS.A.td,{className:"align-right",children:(0,n.jsxs)("div",{className:"flex items-center justify-end space-x-2",children:[e.amount_due>0&&[eN.UNCOLLECTIBLE,eN.OPEN,eN.ISSUED].includes(e.status)&&(0,n.jsx)(ez,{slug:r,invoiceId:e.id}),(0,n.jsx)(eC.G,{type:"outline",className:"w-7",icon:(0,n.jsx)(eT.A,{size:16,strokeWidth:1.5}),onClick:()=>g(e.id),tooltip:{content:{side:"bottom",text:"Download invoice"}}})]})})]},e.id)),(0,n.jsx)(eS.A.tr,{children:(0,n.jsx)(eS.A.td,{colSpan:6,children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("p",{className:"text-sm opacity-50",children:o?"Failed to retrieve total number of invoices":"Showing ".concat(l+1," to ").concat(l+h.length," out of ").concat(i," invoices")}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(K.$,{icon:(0,n.jsx)(eL.A,{}),type:"default",size:"tiny",disabled:1===e,onClick:async()=>a(e-1)}),(0,n.jsx)(K.$,{icon:(0,n.jsx)(eB.A,{}),type:"default",size:"tiny",disabled:5*e>=(null!=i?i:0),onClick:async()=>a(e+1)})]})]})})},"navigation")]}),"data-sentry-element":"Table","data-sentry-source-file":"InvoicesSettings.tsx"})})},eq=()=>{let{isSuccess:e,can:a}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.subscriptions");return(0,n.jsxs)(l.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"InvoicesSection","data-sentry-source-file":"InvoicesSection.tsx",children:[(0,n.jsx)(l.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"InvoicesSection.tsx",children:(0,n.jsxs)("div",{className:"sticky space-y-2 top-12 pr-6",children:[(0,n.jsx)("p",{className:"text-foreground text-base m-0",children:"Past Invoices"}),(0,n.jsx)("p",{className:"prose text-sm",children:"You get an invoice every time you change your plan or when your monthly billing cycle resets."})]})}),(0,n.jsx)(l.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"InvoicesSection.tsx",children:e&&!a?(0,n.jsx)(ee.A,{resourceText:"view this organization's upcoming invoice"}):(0,n.jsx)(eU,{})})]})};var eO=t(52555),eG=t.n(eO),eK=t(83994),eH=t(64634);async function eV(e,a){let{orgSlug:t}=e;if(!t)throw Error("orgSlug is required");let{data:n,error:s}=await (0,b.Jt)("/platform/organizations/{slug}/billing/invoices/upcoming",{params:{path:{slug:t}},headers:{Version:"2"},signal:a});return s&&(0,b.H4)(s),n}let eY=function(e){let{orgSlug:a}=e,{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,M.I)({queryKey:eA.x.orgUpcomingPreview(a),queryFn:e=>{let{signal:t}=e;return eV({orgSlug:a},t)},enabled:t&&void 0!==a,...n})};var eW=t(78511),e$=t(4969),eQ=t(74381);let eJ={[eH.Lb.MONTHLY_ACTIVE_USERS]:"".concat(_.aq,"/guides/platform/manage-your-usage/monthly-active-users"),[eH.Lb.MONTHLY_ACTIVE_SSO_USERS]:"".concat(_.aq,"/guides/platform/manage-your-usage/monthly-active-users-sso"),[eH.Lb.MONTHLY_ACTIVE_THIRD_PARTY_USERS]:"".concat(_.aq,"/guides/platform/manage-your-usage/monthly-active-users-third-party"),[eH.Lb.AUTH_MFA_PHONE]:"".concat(_.aq,"/guides/platform/manage-your-usage/advanced-mfa-phone"),[eH.Lb.EGRESS]:"".concat(_.aq,"/guides/platform/manage-your-usage/egress"),[eH.Lb.CACHED_EGRESS]:"".concat(_.aq,"/guides/platform/manage-your-usage/egress"),[eH.Lb.FUNCTION_INVOCATIONS]:"".concat(_.aq,"/guides/platform/manage-your-usage/edge-function-invocations"),[eH.Lb.STORAGE_SIZE]:"".concat(_.aq,"/guides/platform/manage-your-usage/storage-size"),[eH.Lb.STORAGE_IMAGES_TRANSFORMED]:"".concat(_.aq,"/guides/platform/manage-your-usage/storage-image-transformations"),[eH.Lb.REALTIME_MESSAGE_COUNT]:"".concat(_.aq,"/guides/platform/manage-your-usage/realtime-messages"),[eH.Lb.REALTIME_PEAK_CONNECTIONS]:"".concat(_.aq,"/guides/platform/manage-your-usage/realtime-peak-connections"),[eH.Lb.CUSTOM_DOMAIN]:"".concat(_.aq,"/guides/platform/manage-your-usage/custom-domains"),[eH.Lb.IPV4]:"".concat(_.aq,"/guides/platform/manage-your-usage/ipv4"),[eH.Lb.PITR_7]:"".concat(_.aq,"/guides/platform/manage-your-usage/point-in-time-recovery"),[eH.Lb.PITR_14]:"".concat(_.aq,"/guides/platform/manage-your-usage/point-in-time-recovery"),[eH.Lb.PITR_28]:"".concat(_.aq,"/guides/platform/manage-your-usage/point-in-time-recovery"),[eH.Lb.DISK_SIZE_GB_HOURS_GP3]:"".concat(_.aq,"/guides/platform/manage-your-usage/disk-size"),[eH.Lb.DISK_SIZE_GB_HOURS_IO2]:"".concat(_.aq,"/guides/platform/manage-your-usage/disk-size"),[eH.Lb.DISK_IOPS_GP3]:"".concat(_.aq,"/guides/platform/manage-your-usage/disk-iops"),[eH.Lb.DISK_IOPS_IO2]:"".concat(_.aq,"/guides/platform/manage-your-usage/disk-iops"),[eH.Lb.DISK_THROUGHPUT_GP3]:"".concat(_.aq,"/guides/platform/manage-your-usage/disk-throughput"),[eH.Lb.LOG_DRAIN]:"".concat(_.aq,"/guides/platform/manage-your-usage/log-drains")};function eZ(e){let{amountBeforeDiscount:a,amount:t}=e;return a&&t<a?(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{className:"text-foreground-light line-through mr-2",translate:"no",children:(0,el.vv)(a)}),(0,n.jsx)("span",{translate:"no",children:(0,el.vv)(t)})]}):(0,n.jsx)("span",{translate:"no",children:(0,el.vv)(t)})}function eX(e){var a;let{computeItems:t,tooltip:s,title:r,computeCredits:l}=e,i=t.flatMap(e=>e.breakdown.map(a=>({...a,computeType:e.description,computeCosts:a.amount}))).sort((e,a)=>a.computeCosts-e.computeCosts),o=Math.max(0,t.reduce((e,a)=>e+a.amount_before_discount,0)),d=Math.max(0,t.reduce((e,a)=>{var t;return e+(null!=(t=a.amount)?t:0)},0)+(null!=(a=null==l?void 0:l.amount)?a:0));return t.length?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(eW.Hj,{"data-sentry-element":"TableRow","data-sentry-source-file":"UpcomingInvoice.tsx",children:[(0,n.jsxs)(eW.nA,{className:"!py-2 px-0 flex items-center gap-1","data-sentry-element":"TableCell","data-sentry-source-file":"UpcomingInvoice.tsx",children:[(0,n.jsx)("span",{children:r}),(0,n.jsx)(e$.I,{className:"max-w-sm","data-sentry-element":"InfoTooltip","data-sentry-source-file":"UpcomingInvoice.tsx",children:s})]}),(0,n.jsx)(eW.nA,{className:"text-right py-2 px-0","data-sentry-element":"TableCell","data-sentry-source-file":"UpcomingInvoice.tsx",children:(0,n.jsx)(eZ,{amount:d,amountBeforeDiscount:o,"data-sentry-element":"InvoiceLineItemAmount","data-sentry-source-file":"UpcomingInvoice.tsx"})})]}),i.map(e=>(0,n.jsxs)(eW.Hj,{className:"text-foreground-light text-xs",children:[(0,n.jsxs)(eW.nA,{className:"!py-2 px-0 pl-6",children:[e.project_name," (",e.computeType," - ",e.usage," Hours)"]}),(0,n.jsx)(eW.nA,{className:"!py-2 px-0 text-right",translate:"no",children:(0,el.vv)(e.computeCosts)})]},e.project_ref)),l&&(0,n.jsxs)(eW.Hj,{className:"text-foreground-light text-xs",children:[(0,n.jsx)(eW.nA,{className:"!py-2 px-0 pl-6",children:"Compute Credits"}),(0,n.jsx)(eW.nA,{className:"!py-2 px-0 text-right",translate:"no",children:(0,el.vv)(l.amount)})]})]}):null}let e0=e=>{var a,t,s,r,l,i,o;let{slug:d}=e,{data:c,error:u,isLoading:m,isError:p,isSuccess:x}=eY({orgSlug:d}),h=(null==c||null==(a=c.lines)?void 0:a.filter(e=>{var a,t;return(null==(a=e.description)?void 0:a.toLowerCase().includes("compute"))&&e.breakdown&&(null==(t=e.breakdown)?void 0:t.length)>0}))||[],g=null!=(l=null==c||null==(t=c.lines)?void 0:t.find(e=>e.description.startsWith("Compute Credits")))?l:null,y=null==c||null==(s=c.lines)?void 0:s.find(e=>{var a;return null==(a=e.description)?void 0:a.toLowerCase().includes("plan")}),f=h.filter(e=>{var a,t;return!(null==(a=e.metadata)?void 0:a.is_branch)&&!(null==(t=e.metadata)?void 0:t.is_read_replica)}),v=h.filter(e=>{var a;return null==(a=e.metadata)?void 0:a.is_branch}),j=h.filter(e=>{var a;return null==(a=e.metadata)?void 0:a.is_read_replica}),b=(null==c||null==(r=c.lines)?void 0:r.filter(e=>{var a,t;return!(null==(a=e.description)?void 0:a.toLowerCase().includes("compute"))&&!(null==(t=e.description)?void 0:t.toLowerCase().includes("plan"))}))||[];return(0,n.jsxs)(n.Fragment,{children:[m&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(et.Ay,{}),(0,n.jsx)(et.Ay,{className:"w-3/4"}),(0,n.jsx)(et.Ay,{className:"w-1/2"})]}),p&&(0,n.jsx)(J.A,{subject:"Failed to retrieve upcoming invoice",error:u}),x&&(0,n.jsx)("div",{children:(0,n.jsx)("div",{children:(0,n.jsxs)(eW.XI,{className:"w-full text-sm",children:[(0,n.jsxs)(eW.BF,{children:[(0,n.jsxs)(eW.Hj,{children:[(0,n.jsx)(eW.nA,{className:"!py-2 px-0",children:null==y?void 0:y.description}),(0,n.jsx)(eW.nA,{className:"text-right py-2 px-0",children:null==y?"-":(0,n.jsx)(eZ,{amount:y.amount,amountBeforeDiscount:y.amount_before_discount})})]}),(0,n.jsx)(eX,{computeItems:f,title:"Compute",computeCredits:g,tooltip:(0,n.jsxs)("p",{className:"prose text-xs",children:["The first project is covered by Compute Credits. Additional projects incur compute costs starting at ",(0,n.jsx)("span",{translate:"no",children:"$10"}),"/month, independent of activity. See"," ",(0,n.jsx)(eG(),{href:"".concat(_.aq,"/guides/platform/manage-your-usage/compute"),target:"_blank",children:"docs"}),"."]})}),(0,n.jsx)(eX,{title:"Replica Compute",computeItems:j,tooltip:(0,n.jsxs)("p",{className:"prose text-xs",children:["Each Read Replica is a dedicated database. You are charged for its resources: Compute, Disk Size, provisioned Disk IOPS, provisioned Disk Throughput, and IPv4. See"," ",(0,n.jsx)(eG(),{href:"".concat(_.aq,"/guides/platform/manage-your-usage/read-replicas"),target:"_blank",children:"docs"}),"."]})}),v.length>0&&(0,n.jsxs)(eW.Hj,{children:[(0,n.jsx)(eW.nA,{className:"py-2 px-0",children:(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("span",{children:"Branching"}),(0,n.jsxs)(e$.I,{className:"max-w-sm",children:[(0,n.jsx)("ul",{className:"ml-6 list-disc",children:v.flatMap(e=>e.breakdown).map(e=>(0,n.jsxs)("li",{children:[e.project_name," (",e.usage," Hours)"]},"branching-breakdown-".concat(e.project_ref)))}),(0,n.jsxs)("p",{className:"mt-2",children:["See"," ",(0,n.jsx)(eG(),{className:"underline",href:"".concat(_.aq,"/guides/platform/manage-your-usage/branching"),target:"_blank",children:"docs"})," ","on how billing for Branching works."]})]})]})}),(0,n.jsx)(eW.nA,{className:"text-right py-2 px-0",children:(0,n.jsx)(eZ,{amount:v.reduce((e,a)=>e+a.amount,0),amountBeforeDiscount:v.reduce((e,a)=>{var t;return e+(null!=(t=a.amount_before_discount)?t:0)},0)})})]}),b.map(e=>{var a;return(0,n.jsxs)(eW.Hj,{children:[(0,n.jsx)(eW.nA,{className:"py-2 px-0",children:(0,n.jsxs)("div",{className:"gap-1 flex items-center",children:[(0,n.jsx)("span",{children:null!=(a=e.description)?a:"Unknown"}),(e.breakdown&&e.breakdown.length>0||null!=e.usage_metric)&&(0,n.jsxs)(e$.I,{className:"max-w-sm",children:[e.unit_price_desc&&(0,n.jsxs)("p",{className:"mb-2",translate:"no",children:["Pricing: ",e.unit_price_desc]}),e.breakdown&&e.breakdown.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("p",{children:["Projects using ",e.description,":"]}),(0,n.jsx)("ul",{className:"ml-6 list-disc",children:e.breakdown.map(a=>(0,n.jsxs)("li",{children:[(0,n.jsx)(eG(),{className:"underline",href:"/project/".concat(a.project_ref),target:"_blank",children:a.project_name})," ",e.usage_metric&&(0,n.jsxs)("span",{children:["(",(0,eQ.pK)(e.usage_metric,a)," ",(0,eQ.mX)(e.usage_metric),")"]})]},"".concat(e.description,"-breakdown-").concat(a.project_ref)))})]}),e.usage_metric&&null!=eJ[e.usage_metric]&&(0,n.jsxs)("p",{className:"mt-2",children:["See"," ",(0,n.jsx)(eG(),{className:"underline",href:eJ[e.usage_metric],target:"_blank",children:"docs"})," ","on how billing for ",e.description," works and"," ",(0,n.jsx)(eG(),{className:"underline",href:"/organization/".concat(d,"/usage"),children:"usage page"})," ","for a detailed breakdown."]})]})]})}),(0,n.jsx)(eW.nA,{className:"text-right py-2 px-0",children:(0,n.jsx)(eZ,{amount:e.amount,amountBeforeDiscount:e.amount_before_discount})})]},e.description)})]}),(0,n.jsxs)(eW.Gg,{children:[(0,n.jsxs)(eW.Hj,{children:[(0,n.jsxs)(eW.nA,{className:"font-medium py-2 px-0 flex items-center",children:[(0,n.jsx)("span",{className:"mr-2",children:"Current Costs"}),(0,n.jsx)(e$.I,{children:"Costs accumulated from the beginning of the billing cycle up to now."})]}),(0,n.jsx)(eW.nA,{className:"text-right font-medium py-2 px-0",translate:"no",children:null!=(i=(0,el.vv)(null==c?void 0:c.amount_total))?i:"-"})]}),(0,n.jsxs)(eW.Hj,{children:[(0,n.jsxs)(eW.nA,{className:"font-medium py-2 px-0 flex items-center",children:[(0,n.jsx)("span",{className:"mr-2",children:"Projected Costs"}),(0,n.jsx)(e$.I,{className:"max-w-xs",children:"Projected costs at the end of the billing cycle. Includes predictable costs for Compute Hours, IPv4, Custom Domain and Point-In-Time-Recovery, but no costs for metrics like MAU, storage or function invocations. Final amounts may vary depending on your usage."})]}),(0,n.jsx)(eW.nA,{className:"text-right font-medium py-2 px-0",translate:"no",children:null!=(o=(0,el.vv)(null==c?void 0:c.amount_projected))?o:"-"})]})]})]})})})]})},e1=()=>{var e,a;let{slug:t}=(0,r.g)(),{data:s}=(0,d.s)(),{isSuccess:c,can:m}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.subscriptions"),{data:p,error:x,isLoading:h,isError:g}=(0,i.j5)({orgSlug:t},{enabled:m}),y=(0,o.x)("billing:invoices"),f=ej().unix(null!=(e=null==p?void 0:p.current_period_start)?e:0).utc(),v=ej().unix(null!=(a=null==p?void 0:p.current_period_end)?a:0).utc(),j=v.diff(ej()(),"days"),b=v.diff(f,"days");return(0,n.jsxs)(l.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"BillingBreakdown","data-sentry-source-file":"BillingBreakdown.tsx",children:[(0,n.jsx)(l.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"BillingBreakdown.tsx",children:(0,n.jsxs)("div",{className:"sticky space-y-2 top-12 pr-6",children:[(0,n.jsx)("p",{className:"text-foreground text-base m-0",children:"Upcoming Invoice"}),(0,n.jsx)("div",{className:"py-2",children:(null==s?void 0:s.managed_by)!==er.Kf.AWS_MARKETPLACE&&(0,n.jsx)(eK.A,{type:"horizontal",value:b-j,max:b,barClass:"bg-foreground",labelBottom:"".concat(f.format("MMMM DD")," - ").concat(v.format("MMMM DD")),bgClass:"bg-surface-300",labelBottomClass:"!text-foreground-light p-1 m-0",labelTop:p?"".concat(j," ").concat(1===j?"day":"days"," left"):"",labelTopClass:"p-1 m-0"})}),(0,n.jsx)("p",{className:"prose text-sm",children:(null==s?void 0:s.managed_by)===er.Kf.AWS_MARKETPLACE?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{children:"AWS Marketplace sends two invoices each month: one for your fixed subscription fee, billed on the day you subscribed, and one for your usage charges from the previous month, billed by the 3rd."}),(0,n.jsxs)("p",{children:["For a more detailed breakdown, visit the"," ",(0,n.jsx)(eG(),{href:"/org/".concat(t,"/usage"),children:"usage page."})]})]}):(0,n.jsxs)(n.Fragment,{children:["Your upcoming invoice (excluding credits) will continue to update until the end of your billing cycle on ",v.format("MMMM DD"),". For a more detailed breakdown, visit the ",(0,n.jsx)(eG(),{href:"/org/".concat(t,"/usage"),children:"usage page."})]})}),(0,n.jsx)("br",{}),(0,n.jsx)("p",{className:"text-sm text-foreground-light mt-4",children:"Add-on changes or new projects may take up to an hour to appear."})]})}),(0,n.jsx)(l.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"BillingBreakdown.tsx",children:c&&!m?(0,n.jsx)(ee.A,{resourceText:"view this organization's upcoming invoice"}):(0,n.jsxs)(n.Fragment,{children:[h&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(et.Ay,{}),(0,n.jsx)(et.Ay,{className:"w-3/4"}),(0,n.jsx)(et.Ay,{className:"w-1/2"})]}),g&&(0,n.jsx)(J.A,{subject:"Failed to retrieve subscription",error:x}),y&&(0,n.jsx)(e0,{slug:t})]})})]})};var e2=t(78039),e4=t(65887),e5=t(32157),e3=t(23892),e8=t(68152),e6=t(10663),e9=t(27371),e7=t(61548),ae=t(29244),aa=t(44053);let at=[{code:"AF",name:"Afghanistan"},{code:"AL",name:"Albania"},{code:"DZ",name:"Algeria"},{code:"AS",name:"American Samoa"},{code:"AD",name:"Andorra"},{code:"AO",name:"Angola"},{code:"AI",name:"Anguilla"},{code:"AQ",name:"Antarctica"},{code:"AG",name:"Antigua and Barbuda"},{code:"AR",name:"Argentina"},{code:"AM",name:"Armenia"},{code:"AW",name:"Aruba"},{code:"AU",name:"Australia"},{code:"AT",name:"Austria"},{code:"AZ",name:"Azerbaijan"},{code:"BS",name:"Bahamas"},{code:"BH",name:"Bahrain"},{code:"BD",name:"Bangladesh"},{code:"BB",name:"Barbados"},{code:"BY",name:"Belarus"},{code:"BE",name:"Belgium"},{code:"BZ",name:"Belize"},{code:"BJ",name:"Benin"},{code:"BM",name:"Bermuda"},{code:"BT",name:"Bhutan"},{code:"BO",name:"Bolivia"},{code:"BA",name:"Bosnia and Herzegovina"},{code:"BW",name:"Botswana"},{code:"BV",name:"Bouvet Island"},{code:"BR",name:"Brazil"},{code:"IO",name:"British Indian Ocean Territory"},{code:"VG",name:"British Virgin Islands"},{code:"BN",name:"Brunei Darussalam"},{code:"BG",name:"Bulgaria"},{code:"BF",name:"Burkina Faso"},{code:"BI",name:"Burundi"},{code:"KH",name:"Cambodia"},{code:"CM",name:"Cameroon"},{code:"CA",name:"Canada"},{code:"CV",name:"Cape Verde"},{code:"KY",name:"Cayman Islands"},{code:"CF",name:"Central African Republic"},{code:"TD",name:"Chad"},{code:"CL",name:"Chile"},{code:"CN",name:"China"},{code:"CX",name:"Christmas Island"},{code:"CC",name:"Cocos (Keeling) Islands"},{code:"CO",name:"Colombia"},{code:"KM",name:"Comoros"},{code:"CG",name:"Congo"},{code:"CK",name:"Cook Islands"},{code:"CR",name:"Costa Rica"},{code:"HR",name:"Croatia"},{code:"CU",name:"Cuba"},{code:"CW",name:"Cura\xe7ao"},{code:"CY",name:"Cyprus"},{code:"CZ",name:"Czech Republic"},{code:"CI",name:"C\xf4te d'Ivoire"},{code:"DK",name:"Denmark"},{code:"DJ",name:"Djibouti"},{code:"DM",name:"Dominica"},{code:"DO",name:"Dominican Republic"},{code:"EC",name:"Ecuador"},{code:"EG",name:"Egypt"},{code:"SV",name:"El Salvador"},{code:"GQ",name:"Equatorial Guinea"},{code:"ER",name:"Eritrea"},{code:"EE",name:"Estonia"},{code:"SZ",name:"Eswatini"},{code:"ET",name:"Ethiopia"},{code:"FK",name:"Falkland Islands"},{code:"FO",name:"Faroe Islands"},{code:"FJ",name:"Fiji"},{code:"FI",name:"Finland"},{code:"FR",name:"France"},{code:"GF",name:"French Guiana"},{code:"PF",name:"French Polynesia"},{code:"TF",name:"French Southern Territories"},{code:"GA",name:"Gabon"},{code:"GM",name:"Gambia"},{code:"GE",name:"Georgia"},{code:"DE",name:"Germany"},{code:"GH",name:"Ghana"},{code:"GI",name:"Gibraltar"},{code:"GR",name:"Greece"},{code:"GL",name:"Greenland"},{code:"GD",name:"Grenada"},{code:"GP",name:"Guadeloupe"},{code:"GU",name:"Guam"},{code:"GT",name:"Guatemala"},{code:"GG",name:"Guernsey"},{code:"GN",name:"Guinea"},{code:"GW",name:"Guinea-Bissau"},{code:"GY",name:"Guyana"},{code:"HT",name:"Haiti"},{code:"HM",name:"Heard & McDonald Islands"},{code:"HN",name:"Honduras"},{code:"HK",name:"Hong Kong"},{code:"HU",name:"Hungary"},{code:"IS",name:"Iceland"},{code:"IN",name:"India"},{code:"ID",name:"Indonesia"},{code:"IR",name:"Iran"},{code:"IQ",name:"Iraq"},{code:"IE",name:"Ireland"},{code:"IM",name:"Isle of Man"},{code:"IL",name:"Israel"},{code:"IT",name:"Italy"},{code:"JM",name:"Jamaica"},{code:"JP",name:"Japan"},{code:"JE",name:"Jersey"},{code:"JO",name:"Jordan"},{code:"KZ",name:"Kazakhstan"},{code:"KE",name:"Kenya"},{code:"KI",name:"Kiribati"},{code:"KW",name:"Kuwait"},{code:"KG",name:"Kyrgyzstan"},{code:"LA",name:"Laos"},{code:"LV",name:"Latvia"},{code:"LB",name:"Lebanon"},{code:"LS",name:"Lesotho"},{code:"LR",name:"Liberia"},{code:"LY",name:"Libya"},{code:"LI",name:"Liechtenstein"},{code:"LT",name:"Lithuania"},{code:"LU",name:"Luxembourg"},{code:"MO",name:"Macao"},{code:"MG",name:"Madagascar"},{code:"MW",name:"Malawi"},{code:"MY",name:"Malaysia"},{code:"MV",name:"Maldives"},{code:"ML",name:"Mali"},{code:"MT",name:"Malta"},{code:"MH",name:"Marshall Islands"},{code:"MQ",name:"Martinique"},{code:"MR",name:"Mauritania"},{code:"MU",name:"Mauritius"},{code:"YT",name:"Mayotte"},{code:"MX",name:"Mexico"},{code:"FM",name:"Micronesia"},{code:"MD",name:"Moldova"},{code:"MC",name:"Monaco"},{code:"MN",name:"Mongolia"},{code:"ME",name:"Montenegro"},{code:"MS",name:"Montserrat"},{code:"MA",name:"Morocco"},{code:"MZ",name:"Mozambique"},{code:"MM",name:"Myanmar"},{code:"NA",name:"Namibia"},{code:"NR",name:"Nauru"},{code:"NP",name:"Nepal"},{code:"NL",name:"Netherlands"},{code:"NC",name:"New Caledonia"},{code:"NZ",name:"New Zealand"},{code:"NI",name:"Nicaragua"},{code:"NE",name:"Niger"},{code:"NG",name:"Nigeria"},{code:"NU",name:"Niue"},{code:"NF",name:"Norfolk Island"},{code:"KP",name:"North Korea"},{code:"MK",name:"North Macedonia"},{code:"MP",name:"Northern Mariana Islands"},{code:"NO",name:"Norway"},{code:"OM",name:"Oman"},{code:"PK",name:"Pakistan"},{code:"PW",name:"Palau"},{code:"PS",name:"Palestinian Territories"},{code:"PA",name:"Panama"},{code:"PG",name:"Papua New Guinea"},{code:"PY",name:"Paraguay"},{code:"PE",name:"Peru"},{code:"PH",name:"Philippines"},{code:"PN",name:"Pitcairn Islands"},{code:"PL",name:"Poland"},{code:"PT",name:"Portugal"},{code:"PR",name:"Puerto Rico"},{code:"QA",name:"Qatar"},{code:"RO",name:"Romania"},{code:"RU",name:"Russia"},{code:"RW",name:"Rwanda"},{code:"RE",name:"R\xe9union"},{code:"BL",name:"Saint Barth\xe9lemy"},{code:"WS",name:"Samoa"},{code:"SM",name:"San Marino"},{code:"ST",name:"Sao Tome and Principe"},{code:"SA",name:"Saudi Arabia"},{code:"SN",name:"Senegal"},{code:"RS",name:"Serbia"},{code:"SC",name:"Seychelles"},{code:"SL",name:"Sierra Leone"},{code:"SG",name:"Singapore"},{code:"SX",name:"Sint Maarten"},{code:"SK",name:"Slovakia"},{code:"SI",name:"Slovenia"},{code:"SB",name:"Solomon Islands"},{code:"SO",name:"Somalia"},{code:"ZA",name:"South Africa"},{code:"GS",name:"South Georgia and the South Sandwich Islands"},{code:"KR",name:"South Korea"},{code:"SS",name:"South Sudan"},{code:"ES",name:"Spain"},{code:"LK",name:"Sri Lanka"},{code:"SH",name:"St Helena"},{code:"KN",name:"St Kitts and Nevis"},{code:"LC",name:"St Lucia"},{code:"MF",name:"St Martin"},{code:"PM",name:"St Pierre and Miquelon"},{code:"VC",name:"St Vincent and the Grenadines"},{code:"SD",name:"Sudan"},{code:"SR",name:"Suriname"},{code:"SJ",name:"Svalbard & Jan Mayen"},{code:"SE",name:"Sweden"},{code:"CH",name:"Switzerland"},{code:"SY",name:"Syria"},{code:"TW",name:"Taiwan"},{code:"TJ",name:"Tajikistan"},{code:"TZ",name:"Tanzania"},{code:"TH",name:"Thailand"},{code:"TL",name:"Timor-Leste"},{code:"TG",name:"Togo"},{code:"TK",name:"Tokelau"},{code:"TO",name:"Tonga"},{code:"TT",name:"Trinidad & Tobago"},{code:"TN",name:"Tunisia"},{code:"TR",name:"Turkey"},{code:"TM",name:"Turkmenistan"},{code:"TC",name:"Turks & Caicos Islands"},{code:"TV",name:"Tuvalu"},{code:"VI",name:"US Virgin Islands"},{code:"UG",name:"Uganda"},{code:"UA",name:"Ukraine"},{code:"AE",name:"United Arab Emirates"},{code:"GB",name:"United Kingdom"},{code:"US",name:"United States of America"},{code:"UY",name:"Uruguay"},{code:"UZ",name:"Uzbekistan"},{code:"VU",name:"Vanuatu"},{code:"VA",name:"Vatican City"},{code:"VE",name:"Venezuela"},{code:"VN",name:"Vietnam"},{code:"WF",name:"Wallis & Futuna"},{code:"EH",name:"Western Sahara"},{code:"YE",name:"Yemen"},{code:"ZM",name:"Zambia"},{code:"ZW",name:"Zimbabwe"},{code:"AX",name:"\xc5land Islands"}];var an=t(61155);let as=e6.Ik({billing_name:e6.Yj().min(3,"Name must be at least 3 letters long"),line1:e6.Yj().trim().min(3,"Address line 1 is required"),line2:e6.Yj().optional(),city:e6.Yj().trim().min(2,"City is required"),state:e6.Yj().trim(),postal_code:e6.Yj().trim().min(1,"Postal code is required"),country:e6.Yj().trim().min(1,"Country is required"),tax_id_type:e6.Yj(),tax_id_value:e6.Yj(),tax_id_name:e6.Yj()}),ar=e=>{let{form:a,disabled:t=!1,className:r}=e,[l,i]=(0,s.useState)(!1),[o,d]=(0,s.useState)(!1),{tax_id_name:u,country:m}=a.watch(),p=an.X.find(e=>e.name===u),x=(0,s.useMemo)(()=>an.X.filter(e=>!m||e.countryIso2===m).sort((e,a)=>e.country.localeCompare(a.country)),[m]);return(0,n.jsxs)("div",{className:(0,c.cn)("flex flex-col space-y-4",r),"data-sentry-component":"BillingCustomerDataForm","data-sentry-source-file":"BillingCustomerDataForm.tsx",children:[(0,n.jsx)(e4.zB,{control:a.control,name:"billing_name",render:e=>{let{field:a}=e;return(0,n.jsxs)(aa.M,{hideMessage:!0,label:"Name",children:[(0,n.jsx)(e4.MJ,{children:(0,n.jsx)(e9.p,{...a,disabled:t})}),(0,n.jsx)(e4.C5,{})]})},"data-sentry-element":"FormField","data-sentry-source-file":"BillingCustomerDataForm.tsx"}),(0,n.jsx)(e4.zB,{control:a.control,name:"line1",render:e=>{let{field:a}=e;return(0,n.jsxs)(aa.M,{hideMessage:!0,label:"Address line 1",children:[(0,n.jsx)(e4.MJ,{children:(0,n.jsx)(e9.p,{...a,placeholder:"123 Main Street",disabled:t})}),(0,n.jsx)(e4.C5,{})]})},"data-sentry-element":"FormField","data-sentry-source-file":"BillingCustomerDataForm.tsx"}),(0,n.jsx)(e4.zB,{control:a.control,name:"line2",render:e=>{let{field:a}=e;return(0,n.jsxs)(aa.M,{hideMessage:!0,label:"Address line 2 (optional)",children:[(0,n.jsx)(e4.MJ,{children:(0,n.jsx)(e9.p,{...a,placeholder:"Apartment, suite, unit, building, floor, etc.",disabled:t})}),(0,n.jsx)(e4.C5,{})]})},"data-sentry-element":"FormField","data-sentry-source-file":"BillingCustomerDataForm.tsx"}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsx)(e4.zB,{control:a.control,name:"country",render:e=>{var s;let{field:r}=e;return(0,n.jsxs)(aa.M,{hideMessage:!0,label:"Country",children:[(0,n.jsxs)(e7.AM,{open:l,onOpenChange:i,children:[(0,n.jsx)(e7.Wv,{asChild:!0,children:(0,n.jsx)(e4.MJ,{children:(0,n.jsx)(K.$,{type:"default",role:"combobox",size:"medium",disabled:t,className:(0,c.cn)("w-full justify-between h-[34px]",!r.value&&"text-muted"),iconRight:(0,n.jsx)(e5.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50",strokeWidth:1.5}),children:r.value&&(null==(s=at.find(e=>e.code===r.value))?void 0:s.name)||"Select country"})})}),(0,n.jsx)(e7.hl,{portal:!0,sameWidthAsTrigger:!0,className:"p-0",align:"start",children:(0,n.jsxs)(ae.uB,{children:[(0,n.jsx)(ae.G7,{placeholder:"Search country..."}),(0,n.jsxs)(ae.oI,{children:[(0,n.jsx)(ae.xL,{children:"No country found."}),(0,n.jsx)(ae.L$,{children:at.map(e=>(0,n.jsxs)(ae.h_,{value:e.name,onSelect:()=>{a.setValue("country",e.code,{shouldDirty:!0,shouldTouch:!0,shouldValidate:!0}),i(!1)},children:[(0,n.jsx)(e3.A,{className:(0,c.cn)("mr-2 h-4 w-4",r.value===e.code?"opacity-100":"opacity-0")}),e.name]},e.code))})]})]})})]}),(0,n.jsx)(e4.C5,{})]})},"data-sentry-element":"FormField","data-sentry-source-file":"BillingCustomerDataForm.tsx"}),(0,n.jsx)(e4.zB,{control:a.control,name:"postal_code",render:e=>{let{field:a}=e;return(0,n.jsxs)(aa.M,{hideMessage:!0,label:"Postal code",children:[(0,n.jsx)(e4.MJ,{children:(0,n.jsx)(e9.p,{...a,placeholder:"12345",disabled:t})}),(0,n.jsx)(e4.C5,{})]})},"data-sentry-element":"FormField","data-sentry-source-file":"BillingCustomerDataForm.tsx"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,n.jsx)(e4.zB,{control:a.control,name:"city",render:e=>{let{field:a}=e;return(0,n.jsxs)(aa.M,{hideMessage:!0,label:"City",children:[(0,n.jsx)(e4.MJ,{children:(0,n.jsx)(e9.p,{...a,disabled:t})}),(0,n.jsx)(e4.C5,{})]})},"data-sentry-element":"FormField","data-sentry-source-file":"BillingCustomerDataForm.tsx"}),(0,n.jsx)(e4.zB,{control:a.control,name:"state",render:e=>{let{field:a}=e;return(0,n.jsxs)(aa.M,{hideMessage:!0,label:"State / Province",children:[(0,n.jsx)(e4.MJ,{children:(0,n.jsx)(e9.p,{...a,disabled:t})}),(0,n.jsx)(e4.C5,{})]})},"data-sentry-element":"FormField","data-sentry-source-file":"BillingCustomerDataForm.tsx"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-x-2 w-full items-end",children:[(0,n.jsx)(e4.zB,{name:"tax_id_name",control:a.control,render:()=>(0,n.jsxs)(aa.M,{hideMessage:!0,layout:"vertical",label:"Tax ID",children:[(0,n.jsxs)(e7.AM,{open:o,onOpenChange:d,children:[(0,n.jsx)(e7.Wv,{asChild:!0,children:(0,n.jsx)(e4.MJ,{children:(0,n.jsx)(K.$,{type:"default",role:"combobox",size:"medium",disabled:t,className:(0,c.cn)("w-full justify-between h-[34px] pr-2",!p&&"text-muted"),iconRight:(0,n.jsx)(e5.A,{className:"h-4 w-4 shrink-0 opacity-50",strokeWidth:1.5}),children:p?"".concat(p.country," - ").concat(p.name):"Select tax ID"})})}),(0,n.jsx)(e7.hl,{portal:!0,sameWidthAsTrigger:!0,className:"p-0",align:"start",children:(0,n.jsxs)(ae.uB,{children:[(0,n.jsx)(ae.G7,{placeholder:"Search tax ID..."}),(0,n.jsxs)(ae.oI,{children:[(0,n.jsx)(ae.xL,{children:"No tax ID found."}),(0,n.jsx)(ae.L$,{children:x.map(e=>(0,n.jsxs)(ae.h_,{value:"".concat(e.country," - ").concat(e.name),onSelect:()=>{(e=>{let t=an.X.find(a=>a.name===e);t&&(a.setValue("tax_id_type",t.type),a.setValue("tax_id_value",""),a.setValue("tax_id_name",e))})(e.name),d(!1)},children:[(0,n.jsx)(e3.A,{className:(0,c.cn)("mr-2 h-4 w-4",(null==p?void 0:p.name)===e.name?"opacity-100":"opacity-0")}),e.country," - ",e.name]},e.name))})]})]})})]}),(0,n.jsx)(e4.C5,{})]}),"data-sentry-element":"FormField","data-sentry-source-file":"BillingCustomerDataForm.tsx"}),p&&(0,n.jsxs)("div",{className:"flex items-center space-x-2 [&>div]:w-full",children:[(0,n.jsx)(e4.zB,{name:"tax_id_value",control:a.control,render:e=>{let{field:a}=e;return(0,n.jsx)(aa.M,{hideMessage:!0,children:(0,n.jsx)(e4.MJ,{children:(0,n.jsx)(e9.p,{...a,disabled:t,placeholder:null==p?void 0:p.placeholder})})})}}),(0,n.jsx)(K.$,{type:"text",className:"px-1",icon:(0,n.jsx)(e8.A,{}),onClick:()=>void(a.setValue("tax_id_name","",{shouldDirty:!0}),a.setValue("tax_id_type","",{shouldDirty:!0}),a.setValue("tax_id_value","",{shouldDirty:!0}))})]})]})]})};var al=t(32981),ai=t(87494);let ao=()=>{let{slug:e}=(0,r.g)(),{data:a}=(0,d.s)(),{can:t,isSuccess:i}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.customer"),{can:o}=(0,I.Qp)(u.aG.BILLING_WRITE,"stripe.customer"),{data:c,error:m,isLoading:p,isSuccess:h}=E({slug:e},{enabled:t}),{data:g,error:y,isLoading:f,isSuccess:v}=D({slug:e}),j=(0,s.useMemo)(()=>{var e,a,t,n,s,r,l,i,o,d,u;return{city:null!=(i=null==c||null==(e=c.address)?void 0:e.city)?i:void 0,country:null==c||null==(a=c.address)?void 0:a.country,line1:null==c||null==(t=c.address)?void 0:t.line1,line2:null!=(o=null==c||null==(n=c.address)?void 0:n.line2)?o:void 0,postal_code:null!=(d=null==c||null==(s=c.address)?void 0:s.postal_code)?d:void 0,state:null!=(u=null==c||null==(r=c.address)?void 0:r.state)?u:void 0,billing_name:null==c?void 0:c.billing_name,tax_id_type:null==g?void 0:g.type,tax_id_value:null==g?void 0:g.value,tax_id_name:g&&(null==(l=an.X.find(e=>e.type===g.type&&e.countryIso2===g.country))?void 0:l.name)||""}},[c,g]),{mutateAsync:b}=F(),{mutateAsync:N}=z(),[w,_]=(0,s.useState)(!1),{form:S,handleSubmit:C,handleReset:A,isDirty:M}=function(e){let{initialCustomerData:a,onCustomerDataChange:t}=e,n=(0,ai.mN)({resolver:(0,al.u)(as),defaultValues:{billing_name:(null==a?void 0:a.billing_name)||"",line1:(null==a?void 0:a.line1)||"",line2:(null==a?void 0:a.line2)||"",city:(null==a?void 0:a.city)||"",state:(null==a?void 0:a.state)||"",postal_code:(null==a?void 0:a.postal_code)||"",country:(null==a?void 0:a.country)||"",tax_id_type:(null==a?void 0:a.tax_id_type)||"",tax_id_value:(null==a?void 0:a.tax_id_value)||"",tax_id_name:(null==a?void 0:a.tax_id_name)||""}});(0,s.useEffect)(()=>{a&&n.reset({billing_name:a.billing_name||"",line1:a.line1||"",line2:a.line2||"",city:a.city||"",state:a.state||"",postal_code:a.postal_code||"",country:a.country||"",tax_id_type:(null==a?void 0:a.tax_id_type)||"",tax_id_value:(null==a?void 0:a.tax_id_value)||"",tax_id_name:(null==a?void 0:a.tax_id_name)||""})},[a]);let r=async e=>{var a,s;let r=Object.entries(e).reduce((e,a)=>{let[t,n]=a;return e[t]="string"==typeof n?n.trim():n,e},{}),l=r.line1?r:null,i=an.X.find(a=>a.name===e.tax_id_name);t({address:l?{line1:r.line1,line2:r.line2,city:r.city,state:r.state,postal_code:r.postal_code,country:r.country}:void 0,billing_name:r.billing_name,tax_id:i&&(null==(a=e.tax_id_type)?void 0:a.length)&&(null==(s=e.tax_id_value)?void 0:s.length)?{type:e.tax_id_type,value:(e=>{let a=an.X.find(a=>a.name===e.name),t=null==a?void 0:a.vatPrefix;return t&&!e.value.startsWith(t)?"".concat(t).concat(e.value):e.value})({value:e.tax_id_value,name:n.getValues().tax_id_name}),country:null==i?void 0:i.countryIso2}:null})};return{form:n,handleSubmit:r,handleReset:()=>{a?n.reset({billing_name:a.billing_name||"",line1:a.line1||"",line2:a.line2||"",city:a.city||"",state:a.state||"",postal_code:a.postal_code||"",country:a.country||"",tax_id_type:(null==a?void 0:a.tax_id_type)||"",tax_id_value:(null==a?void 0:a.tax_id_value)||"",tax_id_name:(null==a?void 0:a.tax_id_name)||""}):n.reset({line1:"",line2:"",city:"",state:"",postal_code:"",country:"",tax_id_type:"",tax_id_value:"",tax_id_name:""})},isDirty:n.formState.isDirty}}({initialCustomerData:j,onCustomerDataChange:async a=>{_(!0);try{await b({slug:e,address:a.address,billing_name:a.billing_name}),await N({slug:e,taxId:a.tax_id}),x.oR.success("Successfully updated billing data"),_(!1)}catch(e){x.oR.error("Failed updating billing data: ".concat(e.message)),_(!1)}}}),P=!M||!o||w;return(0,n.jsxs)(l.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"BillingCustomerData","data-sentry-source-file":"BillingCustomerData.tsx",children:[(0,n.jsx)(l.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"BillingCustomerData.tsx",children:(0,n.jsxs)("div",{className:"sticky space-y-2 top-12 pr-3",children:[(0,n.jsx)("p",{className:"text-foreground text-base m-0",children:"Billing Address & Tax ID"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Changes will be reflected in every upcoming invoice, past invoices are not affected"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"A Tax ID is only required for registered businesses."})]})}),(0,n.jsx)(l.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"BillingCustomerData.tsx",children:(null==a?void 0:a.managed_by)!==void 0&&(null==a?void 0:a.managed_by)!=="supabase"?(0,n.jsx)(ea.A,{managedBy:null==a?void 0:a.managed_by,resource:"Billing Addresses",cta:{installationId:null==a?void 0:a.partner_id}}):i&&!t?(0,n.jsx)(ee.A,{resourceText:"view this organization's billing address"}):(0,n.jsxs)(n.Fragment,{children:[(p||f)&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(et.Ay,{}),(0,n.jsx)(et.Ay,{className:"w-3/4"}),(0,n.jsx)(et.Ay,{className:"w-1/2"})]}),(m||y)&&(0,n.jsx)(J.A,{subject:"Failed to retrieve organization customer profile",error:m||y}),h&&v&&(0,n.jsx)(e2.Zp,{children:(0,n.jsx)(e4.lV,{...S,children:(0,n.jsxs)("form",{onSubmit:S.handleSubmit(C),children:[(0,n.jsx)(ar,{className:"p-8",form:S,disabled:!o}),(0,n.jsxs)(e2.wL,{className:"border-t justify-end px-8",children:[!o&&(0,n.jsx)("span",{className:"text-sm text-foreground-lighter mr-auto",children:"You need additional permissions to manage this organization's billing address"}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(K.$,{type:"default",onClick:A,disabled:P,children:"Cancel"}),(0,n.jsx)(K.$,{type:"primary",htmlType:"submit",disabled:P,loading:w,children:"Save"})]})]})]})})})]})})]})};var ad=t(50795),ac=t(15020),au=t(49742);let am="org-billing-email",ap=e6.Ik({billingEmail:e6.Yj().email("Please provide a valid email address").optional(),additionalBillingEmails:e6.Yj().email({message:"invalid_email"}).array().default([])}),ax=()=>{var e,a;let{slug:t}=(0,r.g)(),{data:i}=(0,d.s)(),{name:o,billing_email:c}=null!=i?i:{},{can:m,isSuccess:p}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.subscriptions"),{can:h}=(0,I.Qp)(u.aG.UPDATE,"organizations"),{data:g,isLoading:y}=E({slug:t},{enabled:m}),f=(0,ai.mN)({resolver:(0,al.u)(ap),defaultValues:{billingEmail:null!=c?c:"",additionalBillingEmails:null!=(e=null==g?void 0:g.additional_emails)?e:[]}}),{additionalBillingEmails:v}=f.watch(),{errors:j}=f.formState,b=null!=(a=j.additionalBillingEmails)?a:[],{mutate:N,isLoading:w}=(0,ac.N)(),_=async e=>h?t?o?void N({slug:t,name:o,billing_email:e.billingEmail,additional_billing_emails:e.additionalBillingEmails},{onSuccess:()=>{x.oR.success("Successfully saved settings"),f.reset(e)}}):console.error("Organization name is required"):console.error("Slug is required"):x.oR.error("You do not have the required permissions to update this organization");return(0,s.useEffect)(()=>{if(g){var e;f.reset({billingEmail:null!=c?c:"",additionalBillingEmails:null!=(e=g.additional_emails)?e:[]})}},[g]),(0,n.jsxs)(l.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"BillingEmail","data-sentry-source-file":"BillingEmail.tsx",children:[(0,n.jsx)(l.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"BillingEmail.tsx",children:(0,n.jsxs)("div",{className:"sticky space-y-2 top-12",children:[(0,n.jsx)("p",{className:"text-foreground text-base m-0",children:"Email Recipient"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"All billing correspondence will go to this email"})]})}),(0,n.jsx)(l.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"BillingEmail.tsx",children:p&&!m?(0,n.jsx)(ee.A,{resourceText:"view this organization's email recipients"}):(0,n.jsx)(e4.lV,{...f,children:(0,n.jsx)("form",{id:am,onSubmit:f.handleSubmit(_),children:(0,n.jsx)(Z.lB,{footer:(0,n.jsx)("div",{className:"flex py-4 px-8",children:(0,n.jsx)(ad.I,{form:am,isSubmitting:w,hasChanges:f.formState.isDirty,handleReset:f.reset,disabled:!h,helper:h?void 0:"You need additional permissions to update billing emails"})}),children:(0,n.jsx)(X.y9,{children:(0,n.jsxs)(X.DE,{fullWidth:!0,loading:y,children:[(0,n.jsx)(e4.zB,{control:f.control,name:"billingEmail",render:e=>{let{field:a}=e;return(0,n.jsxs)(aa.M,{label:"Email address",children:[(0,n.jsx)(e4.MJ,{children:(0,n.jsx)(e9.p,{type:"email",...a,placeholder:"Email",disabled:!h})}),(0,n.jsx)(e4.C5,{})]})}}),(0,n.jsx)(e4.zB,{control:f.control,name:"additionalBillingEmails",render:e=>{let{field:a}=e;return(0,n.jsxs)(aa.M,{hideMessage:!0,label:(0,n.jsxs)("div",{className:"flex items-center gap-x-1",children:[(0,n.jsx)("span",{children:"Additional emails"}),(0,n.jsx)(e$.I,{side:"bottom",children:"These email addresses will be CC'd in automated invoice or payment failure emails. Payment receipts will still only go to the primary billing address."})]}),children:[(0,n.jsx)(e4.MJ,{children:(0,n.jsxs)(au.xf,{values:a.value,onValuesChange:a.onChange,children:[(0,n.jsx)(au.hw,{deletableBadge:!0,showIcon:!1,mode:"inline-combobox",label:"Add additional recipients",badgeLimit:"wrap"}),(0,n.jsx)(au.sD,{children:(0,n.jsx)(au.DG,{creatable:!0})})]})}),Array.isArray(b)&&b.length>0&&(0,n.jsx)("div",{className:"flex flex-col gap-y-1 mt-2",children:b.map((e,a)=>(0,n.jsxs)("p",{className:"text-sm text-destructive",children:['"',v[a],'" is not a valid email address']},"email-error-".concat(a)))})]})}})]})})})})})})]})};var ah=t(86510),ag=t(90652),ay=t.n(ag),af=t(77477),av=t(56028),aj=t(12532);let ab=(0,av.BX)({panelKey:void 0,setPanelKey:e=>{ab.panelKey=e}}),aN=e=>(0,aj.s)(ab,e);var aw=t(20033),a_=t(354),aS=t(49092),aC=t(63523);async function aA(e){let{slug:a,tier:t,paymentMethod:n,address:s,tax_id:r,billing_name:l}=e;if(!a)throw Error("slug is required");if(!t)throw Error("tier is required");let i={tier:t};void 0!==n&&(i.payment_method=n);let{error:o,data:d}=await (0,b.yJ)("/platform/organizations/{slug}/billing/subscription",{body:{payment_method:i.payment_method,tier:i.tier,address:null!=s?s:void 0,tax_id:null!=r?r:void 0,billing_name:l},params:{path:{slug:a}}});return o&&(0,b.H4)(o),d}let aM=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,S.jE)();return(0,j.n)({mutationFn:e=>aA(e),async onSuccess(a,t,s){let{slug:r}=t;!a.pending_payment_intent_secret&&(await new Promise(e=>setTimeout(e,2e3)),await Promise.all([n.invalidateQueries({queryKey:aC.s.orgSubscription(r)}),n.invalidateQueries({queryKey:aC.s.orgPlans(r)}),n.invalidateQueries({queryKey:aS.E.orgUsage(r)}),n.invalidateQueries({queryKey:eA.x.orgUpcomingPreview(r)}),n.invalidateQueries({queryKey:A.O.detail(r)}),n.invalidateQueries({queryKey:A.O.list()}),n.invalidateQueries({queryKey:A.O.entitlements(r)})]),t.paymentMethod&&n.setQueriesData({queryKey:A.O.paymentMethods(r)},e=>e?{...e,defaultPaymentMethodId:t.paymentMethod,data:e.data.map(e=>({...e,is_default:e.id===t.paymentMethod}))}:e)),await (null==e?void 0:e(a,t,s))},async onError(e,t,n){void 0===a?x.oR.error(e.message,{dismissible:!0,duration:1e4}):a(e,t,n)},...t})};var aI=t(29117),aP=t(79861),aE=t(14561);let ak=[{name:"Spend cap enabled",value:"on",imageUrl:"".concat(_.o2,"/img/spend-cap-on.png"),imageUrlLight:"".concat(_.o2,"/img/spend-cap-on--light.png")},{name:"Spend cap disabled",value:"off",imageUrl:"".concat(_.o2,"/img/spend-cap-off.png"),imageUrlLight:"".concat(_.o2,"/img/spend-cap-off--light.png")}],aF=()=>{var e;let{slug:a}=(0,r.g)(),{resolvedTheme:t}=(0,f.D)(),[l,o]=(0,s.useState)(!1),[d,m]=(0,s.useState)(),{can:p}=(0,I.Qp)(u.aG.BILLING_WRITE,"stripe.subscriptions"),h=aN(),g="costControl"===h.panelKey,y=()=>h.setPanelKey(void 0),{data:v,isLoading:j}=(0,i.j5)({orgSlug:a}),{mutate:b,isLoading:N}=aM({onSuccess:()=>{x.oR.success("Successfully ".concat(C?"enabled":"disabled"," spend cap")),y()},onError:e=>{x.oR.error("Failed to toggle spend cap: ".concat(e.message))}}),w=(null==v||null==(e=v.plan)?void 0:e.id)==="free",S=!(null==v?void 0:v.usage_billing_enabled),C=!S&&"on"===d,A=d!==(S?"on":"off");(0,s.useEffect)(()=>{g&&void 0!==v&&m(S?"on":"off")},[g,j,v,S]);let M=async()=>{if(!a)return console.error("Org slug is required");b({slug:a,tier:"on"===d?_.V$.PRO:_.V$.PAYG})};return(0,n.jsx)(aP.Ay,{size:"large",loading:j||N,disabled:w||j||!A||N||!p,visible:g,onCancel:y,onConfirm:M,header:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("h4",{children:"Spend cap"}),(0,n.jsx)(K.$,{asChild:!0,type:"default",icon:(0,n.jsx)(ah.A,{strokeWidth:1.5}),children:(0,n.jsx)(eG(),{href:"".concat(_.aq,"/guides/platform/cost-control#spend-cap"),target:"_blank",rel:"noreferrer",children:"About spend cap"})})]}),tooltip:p?void 0:"You do not have permission to update spend cap","data-sentry-element":"SidePanel","data-sentry-component":"SpendCapSidePanel","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,n.jsx)(aP.Ay.Content,{"data-sentry-element":"SidePanel.Content","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,n.jsxs)("div",{className:"py-6 space-y-4",children:[(0,n.jsx)("p",{className:"text-sm",children:"Use the spend cap to manage project usage and costs, and control whether the project can exceed the included quota allowance of any billed line item in a billing cycle"}),(0,n.jsxs)(aE.Ay,{open:l,onOpenChange:o,"data-sentry-element":"Collapsible","data-sentry-source-file":"SpendCapSidePanel.tsx",children:[(0,n.jsx)(aE.Ay.Trigger,{asChild:!0,"data-sentry-element":"Collapsible.Trigger","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2 cursor-pointer",children:[(0,n.jsx)(eB.A,{strokeWidth:1.5,size:16,className:l?"rotate-90":"","data-sentry-element":"ChevronRight","data-sentry-source-file":"SpendCapSidePanel.tsx"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"How are each resource charged after exceeding the included quota?"})]})}),(0,n.jsx)(aE.Ay.Content,{asChild:!0,"data-sentry-element":"Collapsible.Content","data-sentry-source-file":"SpendCapSidePanel.tsx",children:(0,n.jsx)(eS.A,{className:"mt-4",head:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eS.A.th,{children:(0,n.jsx)("p",{className:"text-xs",children:"Item"})}),(0,n.jsx)(eS.A.th,{children:(0,n.jsx)("p",{className:"text-xs",children:"Rate"})})]}),body:["database","auth","storage","realtime","edge_functions"].map(e=>{let a=aI.z[e],t=a.features.filter(e=>e.usage_based);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(eS.A.tr,{children:[(0,n.jsx)(eS.A.td,{children:(0,n.jsx)("p",{className:"text-xs text-foreground",children:a.title})}),(0,n.jsx)(eS.A.td,{children:null})]},e),t.map(e=>(0,n.jsxs)(eS.A.tr,{children:[(0,n.jsx)(eS.A.td,{children:(0,n.jsx)("p",{className:"text-xs pl-4",children:e.title})}),(0,n.jsx)(eS.A.td,{children:(0,n.jsx)("p",{className:"text-xs pl-4",children:e.plans.pro})})]},e.title))]})}),"data-sentry-element":"Table","data-sentry-source-file":"SpendCapSidePanel.tsx"})})]}),w&&(0,n.jsx)(ei.F,{withIcon:!0,variant:"info",title:"Toggling of the spend cap is only available on the Pro Plan",actions:(0,n.jsx)(K.$,{type:"default",onClick:()=>h.setPanelKey("subscriptionPlan"),children:"View available plans"}),children:"Upgrade your plan to disable the spend cap"}),(0,n.jsx)("div",{className:"!mt-8 pb-4",children:(0,n.jsx)("div",{className:"flex gap-3",children:ak.map(e=>{let a=d===e.value;return(0,n.jsxs)("div",{className:(0,c.cn)("col-span-4 group space-y-1",w&&"opacity-75"),onClick:()=>!w&&m(e.value),children:[(0,n.jsx)(ay(),{alt:"Spend Cap",className:(0,c.cn)("relative rounded-xl transition border bg-no-repeat bg-center bg-cover w-[160px] h-[96px]",a?"border-foreground":"border-foreground-muted opacity-50 group-hover:border-foreground-lighter group-hover:opacity-100",!w&&"cursor-pointer",!w&&!a&&"group-hover:border-foreground-light"),width:160,height:96,src:(null==t?void 0:t.includes("dark"))?e.imageUrl:e.imageUrlLight}),(0,n.jsx)("p",{className:(0,c.cn)("text-sm transition",!w&&"group-hover:text-foreground",a?"text-foreground":"text-foreground-light"),children:e.name})]},e.value)})})}),"on"===d?(0,n.jsx)(ei.F,{withIcon:!0,variant:"warning",title:"Your projects could become unresponsive or enter read only mode",children:"Exceeding the included quota allowance with spend cap enabled can cause your projects to become unresponsive or enter read only mode."}):(0,n.jsx)(ei.F,{withIcon:!0,variant:"info",title:"Charges apply for usage beyond included quota allowance",children:"Your projects will always remain responsive and active, and charges only apply when exceeding the included quota limit."}),A&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-sm",children:"on"===d?"Upon clicking confirm, spend cap will be enabled for your organization and you will no longer be charged any extra for usage.":"Upon clicking confirm, spend cap will be disabled for your organization and you will be charged for any usage beyond the included quota."}),(0,n.jsx)("p",{className:"text-sm",children:"Toggling spend cap triggers an invoice and there might be prorated charges for any usage beyond the Pro Plans quota during this billing cycle."})]})]})})})},aT=e=>{var a;let{}=e,{slug:t}=(0,r.g)(),{resolvedTheme:s}=(0,f.D)(),{data:o}=(0,d.s)(),{isSuccess:c,can:m}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.subscriptions"),p=aN(),x=(0,r._P)("disableProjectCreationAndUpdate"),{data:h,error:g,isLoading:y,isSuccess:v,isError:j}=(0,i.j5)({orgSlug:t},{enabled:m}),b=null==h?void 0:h.plan,N=null!=(a=null==h?void 0:h.usage_billing_enabled)&&a,w=!x&&!["team","enterprise"].includes((null==b?void 0:b.id)||""),S=(null==o?void 0:o.managed_by)===er.Kf.AWS_MARKETPLACE;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"CostControl.tsx",children:[(0,n.jsx)(l.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"CostControl.tsx",children:(0,n.jsxs)("div",{className:"sticky space-y-6 top-12",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("p",{className:"text-foreground text-base m-0",children:"Cost Control"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light m-0",children:["Allow scaling beyond your plan's"," ",(0,n.jsx)(eG(),{href:"/org/".concat(t,"/usage"),className:"text-green-900 transition hover:text-green-1000","data-sentry-element":"Link","data-sentry-source-file":"CostControl.tsx",children:"included quota"}),"."]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"More information"}),(0,n.jsx)("div",{children:(0,n.jsx)(eG(),{href:"".concat(_.aq,"/guides/platform/cost-control#spend-cap"),target:"_blank",rel:"noreferrer","data-sentry-element":"Link","data-sentry-source-file":"CostControl.tsx",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2 opacity-50 hover:opacity-100 transition",children:[(0,n.jsx)("p",{className:"text-sm m-0",children:"Spend cap"}),(0,n.jsx)(ah.A,{size:16,strokeWidth:1.5,"data-sentry-element":"ExternalLink","data-sentry-source-file":"CostControl.tsx"})]})})})]})]})}),(0,n.jsx)(l.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"CostControl.tsx",children:c&&!m?(0,n.jsx)(ee.A,{resourceText:"update this organization's cost control"}):(0,n.jsxs)(n.Fragment,{children:[y&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(et.Ay,{}),(0,n.jsx)(et.Ay,{className:"w-3/4"}),(0,n.jsx)(et.Ay,{className:"w-1/2"})]}),j&&(0,n.jsx)(J.A,{subject:"Failed to retrieve subscription",error:g}),v&&S&&(0,n.jsxs)(aw.Fc,{className:"flex flex-col items-center gap-y-2 border-0 rounded-none",children:[(0,n.jsx)(af.A,{organization:{managed_by:null==o?void 0:o.managed_by},showTooltip:!1,size:"large"}),(0,n.jsxs)(aw.XL,{className:"text-sm",children:["The Spend Cap is not available for organizations managed by"," ",ea.N[null==o?void 0:o.managed_by],"."]})]}),v&&!S&&(0,n.jsxs)("div",{className:"space-y-6",children:[["team","enterprise"].includes((null==b?void 0:b.id)||"")?(0,n.jsxs)(ei.F,{withIcon:!0,variant:"info",title:"You will be charged for any additional usage on the ".concat((null==b?void 0:b.name)||""," plan"),children:[(null==b?void 0:b.name)||""," plan requires you to have spend cap off at all times. Your projects will never become unresponsive. Only when your"," ",(0,n.jsx)(eG(),{href:"/org/".concat(t,"/usage"),className:"text-green-900 transition hover:text-green-1000",children:"included usage"})," ","is exceeded will you be charged for any additional usage."]}):(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"If you need to go beyond the included quota, simply switch off your spend cap to pay for additional usage."}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,n.jsx)("div",{children:(0,n.jsx)("div",{className:"rounded-md bg-surface-200 w-[160px] h-[96px] shadow",children:(0,n.jsx)(ay(),{alt:"Spend Cap",width:160,height:96,src:N?"".concat(_.o2,"/img/spend-cap-off").concat((null==s?void 0:s.includes("dark"))?"":"--light",".png?v=3"):"".concat(_.o2,"/img/spend-cap-on").concat((null==s?void 0:s.includes("dark"))?"":"--light",".png?v=3")})})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"mb-1",children:["Spend cap is ",N?"disabled":"enabled"]}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:N?(0,n.jsx)("span",{children:"You will be charged for usage beyond the included quota."}):(0,n.jsx)("span",{children:"You won't be charged any extra for usage. However, your projects could become unresponsive or enter read only mode if you exceed the included quota."})}),(0,n.jsx)(a_.A,{projectUpdateDisabled:x,children:(0,n.jsx)(K.$,{type:"default",className:"mt-4 pointer-events-auto",disabled:!w,onClick:()=>p.setPanelKey("costControl"),children:"Change spend cap"})})]})]})]})]})})]}),(0,n.jsx)(aF,{"data-sentry-element":"SpendCapSidePanel","data-sentry-source-file":"CostControl.tsx"})]})};var aL=t(12123),aB=t(80356),aD=t(24092),aR=t(1680);async function az(e){let{payment_method_id:a,amount:t,slug:n,hcaptchaToken:s,address:r,tax_id:l,billing_name:i}=e;if(!a)throw Error("Payment method id required");if(!s)throw Error("Captcha not submitted");if(!n)throw Error("Slug is required");let{data:o,error:d}=await (0,b.bE)("/platform/organizations/{slug}/billing/credits/top-up",{params:{path:{slug:n}},body:{payment_method_id:a,amount:t,hcaptcha_token:s,address:null!=r?r:void 0,tax_id:null!=l?l:void 0,billing_name:null!=i?i:void 0}});return d&&(0,b.H4)(d),o}let aU=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,j.n)({mutationFn:e=>az(e),async onSuccess(a,t,n){await (null==e?void 0:e(a,t,n))},async onError(e,t,n){void 0===a?x.oR.error("Failed to top up credits: ".concat(e.message)):a(e,t,n)},...t})};var aq=t(95137),aO=t(54831),aG=t(40314);let aK=(0,y.c)(_.WS),aH=(0,s.forwardRef)(function(e,a){var t;let{selectedPaymentMethod:l,onSelectPaymentMethod:i,layout:o="vertical",readOnly:c}=e,{slug:u}=(0,r.g)(),{data:p}=(0,d.s)(),[y,v]=(0,s.useState)(null),[j,b]=(0,s.useState)(null),[N,S]=(0,s.useState)(void 0),[A,M]=(0,s.useState)(!0),{resolvedTheme:I}=(0,f.D)(),P=(0,s.useRef)(null),[k,F]=(0,s.useState)(null),{data:T,isLoading:L}=E({slug:u}),{data:B,isLoading:R}=D({slug:u}),{data:z,isLoading:U}=es({slug:u}),q=(0,s.useMemo)(()=>z?{data:(null==T?void 0:T.address)==null?[]:z.data,defaultPaymentMethodId:z.data.some(e=>e.id===z.defaultPaymentMethodId)?z.defaultPaymentMethodId:null}:{data:[],defaultPaymentMethodId:null},[z,T]),G=(0,s.useCallback)(e=>{b(e)},[]),{mutate:K,isLoading:V}=w({onSuccess:e=>{S(e)},onError:e=>{x.oR.error("Failed to setup intent: ".concat(e.message))}});(0,s.useEffect)(()=>{(null==q?void 0:q.data)&&0===q.data.length&&null==k&&F(!0)},[q]),(0,s.useEffect)(()=>{let e=async e=>{let a=null==p?void 0:p.slug;return a?e?void(S(void 0),K({slug:a,hcaptchaToken:e})):console.error("HCaptcha token required"):console.error("Slug is required")};(async()=>{if(k&&j){let t=y;try{if(!t){var a;let e=await j.execute({async:!0});t=null!=(a=null==e?void 0:e.response)?a:null}}catch(e){return}await e(null!=t?t:void 0),W()}})()},[j,k]);let W=()=>{v(null),null==j||j.resetCaptcha()},$=(0,s.useMemo)(()=>({clientSecret:N?N.client_secret:"",appearance:(0,Y.D)(I),paymentMethodCreation:"manual"}),[N,I]);(0,s.useEffect)(()=>{if((null==q?void 0:q.data)&&q.data.length>0){let e=q.data.some(e=>e.id===l);if(!l||!e){let e=q.data.find(e=>e.is_default);void 0!==e?i(e.id):i(q.data[0].id)}}},[l,q,i]);let Q=async()=>{var e,a;if(!k&&(null==q||!q.data||0!==q.data.length))return{paymentMethod:{id:l},customerName:A?(null==T?void 0:T.billing_name)||"":null,address:A&&null!=(a=null==T?void 0:T.address)?a:null,taxId:A&&null!=B?B:null};{let a=await (null==(e=P.current)?void 0:e.createPaymentMethod());return a?{paymentMethod:a.paymentMethod,customerName:A?a.customerName:null,address:A?a.address:null,taxId:A?a.taxId:null}:a}};return(0,s.useImperativeHandle)(a,()=>({createPaymentMethod:Q})),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(h.A,{ref:G,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{S(void 0),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onVerify:e=>{v(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>{v(null)}}),(0,n.jsxs)("div",{children:[U||L?(0,n.jsxs)("div",{className:"flex items-center px-4 py-2 space-x-4 border rounded-md border-strong bg-surface-200",children:[(0,n.jsx)(aO.A,{className:"animate-spin",size:14}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Retrieving payment methods"})]}):(null==q?void 0:q.data)&&(null==q?void 0:q.data.length)>0&&!k?(0,n.jsxs)(aG.A,{layout:o,label:"Payment method",value:l,onChange:i,className:"flex items-center",children:[null==q?void 0:q.data.map(e=>{let a="   ".concat(e.card.last4);return(0,n.jsx)(aG.A.Option,{label:a,value:e.id,addOnBefore:()=>(0,n.jsx)("img",{alt:"Credit Card Brand",src:"".concat(_.o2,"/img/payment-methods/").concat(e.card.brand.replace(" ","-").toLowerCase(),".png"),width:"32"}),children:(0,n.jsx)("div",{children:a})},e.id)}),(0,n.jsxs)("div",{className:"flex items-center px-3 py-2 space-x-2 transition cursor-pointer group hover:bg-surface-300",onClick:()=>{F(!0)},children:[(0,n.jsx)(m.A,{size:16}),(0,n.jsx)("p",{className:"transition text-foreground-light group-hover:text-foreground",children:"Add new payment method"})]})]}):null,aK&&N&&T&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.Elements,{stripe:aK,options:$,children:(0,n.jsx)(C.S,{ref:P,email:null!=(t=null==p?void 0:p.billing_email)?t:void 0,readOnly:c,customerName:null==T?void 0:T.billing_name,currentAddress:null==T?void 0:T.address,currentTaxId:B})}),(null==T?void 0:T.address)!=null&&(0,n.jsxs)("div",{className:"flex items-center space-x-2 mt-4",children:[(0,n.jsx)(O.S,{id:"defaultBillingAddress",checked:A,onCheckedChange:()=>M(!A)}),(0,n.jsx)("label",{htmlFor:"defaultBillingAddress",className:"text-sm leading-none text-foreground-light",children:"Use address as my org's billing address"})]})]}),(V||L||R)&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(H.A,{className:"h-10"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsx)(H.A,{className:"h-10"}),(0,n.jsx)(H.A,{className:"h-10"})]}),(0,n.jsx)(H.A,{className:"h-10"})]})]})]})});aH.displayName="PaymentMethodSelection";let aV=(0,y.c)(_.WS),aY=e6.Ik({amount:e6.au.number().gte(100,"Amount must be between $100 - $2000.").lte(2e3,"Amount must be between $100 - $2000.").int("Amount must be a whole number."),paymentMethod:e6.Yj()}),aW=e=>{let{slug:a}=e,{resolvedTheme:t}=(0,f.D)(),r=(0,S.jE)(),l=(0,s.useRef)(null),{can:i,isSuccess:o}=(0,I.Qp)(u.aG.BILLING_WRITE,"stripe.subscriptions"),{mutateAsync:d,isLoading:c,error:m}=aU({}),p=(0,ai.mN)({resolver:(0,al.u)(aY),defaultValues:{amount:100,paymentMethod:""}}),[y,v]=(0,s.useState)(!1),[j,b]=(0,s.useState)(!1),[N,w]=(0,s.useState)(null),[_,C]=(0,s.useState)(null),A=(0,s.useCallback)(e=>{C(e)},[]),M=async()=>{if(y&&_){let a=N;try{if(!a){var e;let t=await _.execute({async:!0});a=null!=(e=null==t?void 0:t.response)?e:null,w(a)}}catch(e){}return a}};(0,s.useEffect)(()=>{M()},[y,_]);let[P,E]=(0,s.useState)(""),[k,F]=(0,s.useState)(),T=async e=>{var t,n;let{amount:s,paymentMethod:r}=e;F(void 0);let i=await M(),o=await (null==(t=l.current)?void 0:t.createPaymentMethod());o&&await d({slug:a,amount:s,payment_method_id:o.paymentMethod.id,hcaptchaToken:i,address:o.address,tax_id:null!=(n=o.taxId)?n:void 0,billing_name:o.customerName},{onSuccess:e=>{"succeeded"===e.status?D():E(e.payment_intent_secret||""),w(null),null==_||_.resetCaptcha()}})},L=(0,s.useMemo)(()=>({clientSecret:P,appearance:(0,Y.D)(t)}),[P,t]),B=e=>{v(e),e||(C(null),F(void 0),E(""))},D=async()=>{B(!1),await r.invalidateQueries({queryKey:aC.s.orgSubscription(a)}),x.oR.success("Successfully topped up balance. It may take a minute to reflect in your account.")};return(0,n.jsx)("div",{className:"flex items-center justify-end py-4 px-8","data-sentry-component":"CreditTopUp","data-sentry-source-file":"CreditTopUp.tsx",children:(0,n.jsxs)(aq.lG,{open:y,onOpenChange:e=>B(e),"data-sentry-element":"Dialog","data-sentry-source-file":"CreditTopUp.tsx",children:[(0,n.jsx)(aq.zM,{asChild:!0,"data-sentry-element":"DialogTrigger","data-sentry-source-file":"CreditTopUp.tsx",children:(0,n.jsx)(eC.G,{type:"default",className:"pointer-events-auto",disabled:!i||!o,tooltip:{content:{side:"bottom",text:o&&!i?"You need additional permissions to top up credits":void 0}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"CreditTopUp.tsx",children:"Top Up"})}),(0,n.jsxs)(aq.Cf,{onInteractOutside:e=>e.preventDefault(),"data-sentry-element":"DialogContent","data-sentry-source-file":"CreditTopUp.tsx",children:[(0,n.jsx)(h.A,{ref:A,sitekey:"4ca1fdb9-c9c9-4495-ba50-c85fc0e7ec1f",size:"invisible",onOpen:()=>{void 0!==document&&document.body.classList.add("!pointer-events-auto")},onClose:()=>{void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onVerify:e=>{w(e),void 0!==document&&document.body.classList.remove("!pointer-events-auto")},onExpire:()=>{w(null)},"data-sentry-element":"HCaptcha","data-sentry-source-file":"CreditTopUp.tsx"}),(0,n.jsxs)(aq.c7,{"data-sentry-element":"DialogHeader","data-sentry-source-file":"CreditTopUp.tsx",children:[(0,n.jsx)(aq.L3,{"data-sentry-element":"DialogTitle","data-sentry-source-file":"CreditTopUp.tsx",children:"Top Up Credits"}),(0,n.jsxs)(aq.rr,{className:"space-y-2","data-sentry-element":"DialogDescription","data-sentry-source-file":"CreditTopUp.tsx",children:[(0,n.jsx)("p",{className:"prose text-sm",children:"On successful payment, an invoice will be issued and you'll be granted credits. Credits will be applied to future invoices only and are not refundable. The topped up credits do not expire."}),(0,n.jsxs)("p",{className:"prose text-sm",children:["For larger discounted credit packages, please reach out to us via"," ",(0,n.jsx)(Q.Y,{queryParams:{orgSlug:a,projectRef:aR.pJ,subject:"I would like to inquire about larger credit packages",category:u.S.SALES_ENQUIRY},"data-sentry-element":"SupportLink","data-sentry-source-file":"CreditTopUp.tsx",children:"support"}),"."]})]})]}),(0,n.jsx)(aq.pf,{"data-sentry-element":"DialogSectionSeparator","data-sentry-source-file":"CreditTopUp.tsx"}),(0,n.jsx)(e4.lV,{...p,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreditTopUp.tsx",children:(0,n.jsxs)("form",{id:"credit-top-up",onSubmit:p.handleSubmit(T),children:[(0,n.jsxs)(aq.OO,{className:"flex flex-col gap-2","data-sentry-element":"DialogSection","data-sentry-source-file":"CreditTopUp.tsx",children:[(0,n.jsx)(e4.zB,{control:p.control,name:"amount",render:e=>{let{field:a}=e;return(0,n.jsx)(aa.M,{label:"Amount (USD)",className:"gap-1",children:(0,n.jsx)(e9.p,{...a,type:"number",placeholder:"100"})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreditTopUp.tsx"}),(0,n.jsx)(e4.zB,{control:p.control,name:"paymentMethod",render:()=>(0,n.jsx)(aH,{ref:l,onSelectPaymentMethod:e=>p.setValue("paymentMethod",e),selectedPaymentMethod:p.getValues("paymentMethod"),readOnly:c||j}),"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreditTopUp.tsx"}),k&&k.error&&(0,n.jsxs)(aw.Fc,{variant:"destructive",children:[(0,n.jsx)(aL.A,{className:"h-4 w-4"}),(0,n.jsx)(aw.XL,{children:"Error confirming payment"}),(0,n.jsx)(aw.TN,{children:k.error.message})]}),(null==k?void 0:k.paymentIntent)&&"processing"===k.paymentIntent.status&&(0,n.jsxs)(aw.Fc,{variant:"default",children:[(0,n.jsx)(aB.A,{className:"h-4 w-4"}),(0,n.jsx)(aw.XL,{children:"Payment processing"}),(0,n.jsx)(aw.TN,{children:"Your payment is processing and we are waiting for a confirmation from your card issuer. If the payment goes through you'll automatically be credited. Please check back later."})]}),m&&(0,n.jsxs)(aw.Fc,{variant:"destructive",children:[(0,n.jsx)(aL.A,{className:"h-4 w-4"}),(0,n.jsx)(aw.XL,{children:"Error topping up balance"}),(0,n.jsx)(aw.TN,{children:m.message})]})]}),!(null==k?void 0:k.paymentIntent)&&(0,n.jsx)(aq.Es,{children:(0,n.jsx)(K.$,{htmlType:"submit",type:"primary",loading:c||j,children:"Top Up"})})]})}),aV&&P&&(0,n.jsx)(g.Elements,{stripe:aV,options:L,children:(0,n.jsx)(aD.i,{paymentIntentSecret:P,onPaymentIntentConfirm:e=>(e=>{var a;E(""),F(e),(null==(a=e.paymentIntent)?void 0:a.status)==="succeeded"&&D()})(e),onLoadingChange:e=>b(e)})})]})]})})},a$=()=>{var e;let{slug:a}=(0,r.g)(),{isSuccess:t,can:s}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.subscriptions"),{data:o,error:d,isLoading:c,isError:m,isSuccess:p}=(0,i.j5)({orgSlug:a},{enabled:s}),x=(null!=(e=null==o?void 0:o.customer_balance)?e:0)/100,h=x<0,g=x>0,y=h&&0!==x?x.toFixed(2).toString().replace("-",""):x.toFixed(2);return(0,n.jsxs)(l.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-component":"CreditBalance","data-sentry-source-file":"CreditBalance.tsx",children:[(0,n.jsx)(l.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"CreditBalance.tsx",children:(0,n.jsxs)("div",{className:"sticky space-y-2 top-12 pr-3",children:[(0,n.jsx)("div",{className:"flex items-center space-x-2",children:(0,n.jsx)("p",{className:"text-foreground text-base m-0",children:"Credit Balance"})}),(0,n.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Credits will be applied to future invoices, before charging your payment method. If your credit balance runs out, your default payment method will be charged."})]})}),(0,n.jsx)(l.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"CreditBalance.tsx",children:t&&!s?(0,n.jsx)(ee.A,{resourceText:"view this organization's credits"}):(0,n.jsx)(Z.lB,{footer:(null==o?void 0:o.billing_via_partner)?void 0:(0,n.jsx)(aW,{slug:a}),children:(0,n.jsx)(X.y9,{children:(0,n.jsxs)(X.DE,{fullWidth:!0,loading:c,children:[m&&(0,n.jsx)(J.A,{subject:"Failed to retrieve organization customer profile",error:d}),p&&(0,n.jsxs)("div",{className:"flex w-full justify-between items-center",children:[(0,n.jsx)("span",{children:"Balance"}),(0,n.jsxs)("div",{className:"flex items-center space-x-1",children:[g&&(0,n.jsx)("h4",{className:"opacity-50",children:"-"}),(0,n.jsx)("h4",{className:"opacity-50",children:"$"}),(0,n.jsx)("h1",{className:"relative",children:y}),h&&(0,n.jsx)("h4",{className:"opacity-50",children:"/credits"})]})]})]})})})})]})};var aQ=t(47873),aJ=t(33312),aZ=t.n(aJ),aX=t(80814),a0=t(86759),a1=t(56409);async function a2(e){let{organizationSlug:a,tier:t}=e;if(!a)throw Error("organizationSlug is required");if(!t)throw Error("tier is required");let{data:n,error:s}=await (0,b.bE)("/platform/organizations/{slug}/billing/subscription/preview",{params:{path:{slug:a}},body:{tier:t},headers:{Version:"2"}});return s&&(0,b.H4)(s),n}let a4=function(e){let{organizationSlug:a,tier:t}=e,{enabled:n=!0,...s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,M.I)({queryKey:A.O.subscriptionPreview(a,t),queryFn:()=>a2({organizationSlug:a,tier:t}),enabled:n&&void 0!==a&&void 0!==t,...s})};async function a5(e,a){var t;let{slug:n}=e;if(!n)throw Error("Organization slug is required");let{data:s,error:r}=await (0,b.Jt)("/platform/organizations/{slug}",{params:{path:{slug:n}},signal:a});return r&&(0,b.H4)(r),{...s,billing_email:null!=(t=s.billing_email)?t:"Unknown",managed_by:s.slug.startsWith("vercel_icfg_")?"vercel-marketplace":"supabase",partner_id:s.slug.startsWith("vercel_")?s.slug.replace("vercel_",""):void 0}}let a3=function(e){let{slug:a}=e,{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,M.I)({queryKey:A.O.detail(a),queryFn:e=>{let{signal:t}=e;return a5({slug:a},t)},enabled:t&&void 0!==a,...n,staleTime:18e5})};var a8=t(21890);async function a6(e,a){let{orgSlug:t}=e;if(!t)throw Error("orgSlug is required");let{error:n,data:s}=await (0,b.Jt)("/platform/organizations/{slug}/billing/plans",{params:{path:{slug:t}},signal:a});return n&&(0,b.H4)(n),s}let a9=function(e){let{orgSlug:a}=e,{enabled:t=!0,...n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{can:s}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.subscriptions");return(0,M.I)({queryKey:aC.s.orgPlans(a),queryFn:e=>{let{signal:t}=e;return a6({orgSlug:a},t)},enabled:t&&void 0!==a&&s,...n})};var a7=t(36261),te=t(42807),ta=t(13655),tt=t(16097);let tn=e=>{let{projectAddon:a}=e,t=a.addons.find(e=>"compute_instance"===e.type),s=a.addons.filter(e=>!["log_drain","auth_mfa_phone"].includes(e.type)).map(e=>"compute_instance"===e.type?"".concat(e.variant.name," Compute Instance"):e.variant.name);return(0,n.jsxs)("li",{className:"list-disc ml-6","data-sentry-component":"ProjectDowngradeListItem","data-sentry-source-file":"DowngradeModal.tsx",children:[a.name,": ",s.join(", ")," will be removed.",t?(0,n.jsxs)(n.Fragment,{children:[" ","Project will also ",(0,n.jsx)("span",{className:"font-bold",children:"need to be restarted"})," due to change in compute instance"]}):""]})},ts=e=>{var a;let{visible:t,subscription:r,onClose:l,onConfirm:i,projects:o}=e,d=(0,s.useMemo)(()=>te.v.find(e=>"tier_free"===e.id),[]),c=(null==r?void 0:r.project_addons.flatMap(e=>{let a=e.addons.filter(e=>"ci_micro"!==e.variant.identifier);return a.length?{...e,addons:a}:[]}))||[],u=o.some(e=>"micro"===(0,a8.Vw)(e));return(0,n.jsx)(v.A,{size:"large",alignFooter:"right",variant:"warning",visible:t,onCancel:l,onConfirm:i,header:"Confirm to downgrade to ".concat(null==d?void 0:d.name," plan"),"data-sentry-element":"Modal","data-sentry-component":"DowngradeModal","data-sentry-source-file":"DowngradeModal.tsx",children:(0,n.jsxs)(v.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"DowngradeModal.tsx",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(eg.Z,{type:"warning",title:"Downgrading to the Free Plan will lead to reductions in your organization's quota",description:"If you're already past the limits of the Free Plan, your projects could become unresponsive or enter read only mode.","data-sentry-element":"Admonition","data-sentry-source-file":"DowngradeModal.tsx"}),((null!=(a=c.length)?a:0)>0||u)&&(0,n.jsx)(eg.Z,{type:"warning",title:"Projects affected by the downgrade",children:(0,n.jsxs)("ul",{className:"space-y-1 max-h-[100px] overflow-y-auto",children:[c.map(e=>(0,n.jsx)(tn,{projectAddon:e},e.ref)),o.filter(e=>"micro"===(0,a8.Vw)(e)).map(e=>(0,n.jsxs)("li",{className:"list-disc ml-6",children:[e.name,": Compute will be downgraded. Project will also"," ",(0,n.jsx)("span",{className:"font-bold",children:"need to be restarted"}),"."]},e.ref))]})})]}),(0,n.jsxs)("ul",{className:"mt-4 space-y-5 text-sm",children:[(0,n.jsxs)("li",{className:"flex items-center gap-3",children:[(0,n.jsx)(ta.A,{size:18,"data-sentry-element":"PauseCircle","data-sentry-source-file":"DowngradeModal.tsx"}),(0,n.jsx)("span",{children:"Projects will be paused after a week of inactivity"})]}),(0,n.jsxs)("li",{className:"flex items-center gap-3 mb-2",children:[(0,n.jsx)(tt.A,{size:18,"data-sentry-element":"MinusCircle","data-sentry-source-file":"DowngradeModal.tsx"}),(0,n.jsx)("span",{children:"Add ons from all projects under this organization will be removed."})]}),(0,n.jsx)("li",{className:"flex gap-3",children:(0,n.jsxs)("div",{children:[(0,n.jsxs)("strong",{children:["Before you downgrade to the ",null==d?void 0:d.name," plan, consider:"]}),(0,n.jsxs)("ul",{className:"space-y-2 mt-2",children:[(0,n.jsx)("li",{className:"list-disc ml-6 text-foreground-light",children:"Your projects no longer require their respective add ons."}),(0,n.jsxs)("li",{className:"list-disc ml-6 text-foreground-light",children:["Your resource consumption are well within the ",null==d?void 0:d.name," plan's quota."]}),(0,n.jsx)("li",{className:"list-disc ml-6 text-foreground-light",children:"Alternatively, you may also transfer projects across organizations."})]})]})})]}),(null==r?void 0:r.billing_via_partner)===!0&&"fly"===r.billing_partner&&(0,n.jsx)("p",{className:"mt-4 text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]})})},tr=e=>{let{plan:a,isCurrentPlan:t}=e,{data:s}=(0,d.s)(),r=null==s?void 0:s.slug,l=a.features,i=null==s?void 0:s.plan.name,{mutate:o}=(0,a7.h)();return(0,n.jsxs)("div",{className:(0,c.cn)("grid grid-cols-1 md:grid-cols-3 border rounded-md bg-studio","py-4 col-span-12 justify-between gap-x-8"),"data-sentry-component":"EnterpriseCard","data-sentry-source-file":"EnterpriseCard.tsx",children:[(0,n.jsxs)("div",{className:"flex flex-col justify-center px-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("p",{className:(0,c.cn)("text-brand text-sm uppercase"),children:a.name}),t?(0,n.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):a.nameBadge?(0,n.jsx)("div",{className:"text-xs bg-surface-200 text-brand rounded px-2 py-0.5",children:a.nameBadge}):null]}),(0,n.jsx)("p",{className:"text-sm mt-2 mb-4",children:a.description}),(0,n.jsx)(K.$,{block:!0,asChild:!0,type:"default",size:"tiny",onClick:()=>o({action:"studio_pricing_plan_cta_clicked",properties:{selectedPlan:"Enterprise",currentPlan:i},groups:{organization:null!=r?r:"Unknown"}}),"data-sentry-element":"Button","data-sentry-source-file":"EnterpriseCard.tsx",children:(0,n.jsx)("a",{href:a.href,className:"hidden md:block",target:"_blank",children:a.cta})})]}),(0,n.jsxs)("div",{className:"flex flex-col justify-center col-span-2 px-4 md:px-0",children:[(0,n.jsx)("ul",{role:"list",className:"text-xs text-foreground-light md:grid md:grid-cols-2 md:gap-x-10",children:l.map(e=>(0,n.jsxs)("li",{className:"flex items-center py-2 first:mt-0",children:[(0,n.jsx)(e3.A,{className:"text-brand h-4 w-4","aria-hidden":"true",strokeWidth:3}),(0,n.jsx)("span",{className:"text-foreground mb-0 ml-3 ",children:"string"==typeof e?e:e[0]})]},"string"==typeof e?e:e[0]))}),(0,n.jsx)(K.$,{block:!0,asChild:!0,type:"default",size:"tiny",onClick:()=>o({action:"studio_pricing_plan_cta_clicked",properties:{selectedPlan:"Enterprise",currentPlan:i},groups:{organization:null!=r?r:"Unknown"}}),"data-sentry-element":"Button","data-sentry-source-file":"EnterpriseCard.tsx",children:(0,n.jsx)("a",{href:a.href,className:"visible md:hidden mt-8",target:"_blank",children:a.cta})})]})]},a.id)};var tl=t(58375),ti=t(51058),to=t(80421);let td=e=>{let{visible:a,projects:t,onClose:l}=e,{slug:i}=(0,r.g)(),[o,d]=(0,s.useState)(""),[u,m]=(0,s.useState)([]),p=(0,r._P)("disableProjectCreationAndUpdate"),{mutate:h,isLoading:g}=aM({onError:e=>{x.oR.error("Failed to downgrade project: ".concat(e.message))}}),{mutateAsync:y,isLoading:f}=(0,ti.$)(),j=g||f,b=t.filter(e=>"nano"!==(0,a8.Vw)(e)),N=b.length>0,[w]=(0,s.useState)(()=>[...tl.U.sort(()=>Math.random()-.5),{value:"None of the above"}]),_=(e=>{let a=tl.U.find(a=>a.value===e);return(null==a?void 0:a.label)||"What can we improve on?"})(u[0]),S=async()=>{if(0===u.length)return x.oR.error("Please select a reason for canceling your subscription");await C()},C=async()=>{if(!i)return console.error("Slug is required");h({slug:i,tier:"tier_free"},{onSuccess:async()=>{try{await y({orgSlug:i,reasons:u.reduce((e,a)=>"".concat(e,"- ").concat(a,"\n"),""),message:o,exitAction:"downgrade"})}catch(e){}finally{x.oR.success(N?"Successfully downgraded organization to the Free Plan. Your projects are currently restarting to update their compute instances.":"Successfully downgraded organization to the Free Plan",{duration:N?8e3:4e3}),l(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})}}})};return(0,n.jsxs)(v.A,{hideFooter:!0,size:"xlarge",visible:a,onCancel:l,header:"Help us improve","data-sentry-element":"Modal","data-sentry-component":"ExitSurveyModal","data-sentry-source-file":"ExitSurveyModal.tsx",children:[(0,n.jsx)(v.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"ExitSurveyModal.tsx",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Share with us why you're downgrading your plan."}),(0,n.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,n.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:w.map(e=>{let a=u[0]===e.value;return(0,n.jsxs)("label",{className:(0,c.cn)("flex cursor-pointer items-center space-x-2 rounded-md py-1","pl-2 pr-3 text-center text-sm","shadow-sm transition-all duration-100",a?"bg-foreground text-background opacity-100 hover:bg-opacity-75":"bg-border-strong text-foreground opacity-75 hover:opacity-100"),children:[(0,n.jsx)("input",{type:"radio",name:"options",value:e.value,className:"hidden",checked:a,onChange:()=>{m([e.value])}}),(0,n.jsx)("div",{children:e.value})]},e.value)})}),(0,n.jsxs)("div",{className:"text-area-text-sm flex flex-col gap-y-2",children:[(0,n.jsx)("label",{className:"text-sm whitespace-pre-line break-words",children:_}),(0,n.jsx)(to.A.TextArea,{id:"message",name:"message",value:o,onChange:e=>d(e.target.value),rows:3,"data-sentry-element":"Input.TextArea","data-sentry-source-file":"ExitSurveyModal.tsx"})]})]}),N&&(0,n.jsxs)(ei.F,{withIcon:!0,variant:"warning",title:"".concat(b.length," of your projects will be restarted upon clicking confirm,"),children:["This is due to changes in compute instances from the downgrade. Affected projects include ",b.map(e=>e.name).join(", "),"."]})]})}),(0,n.jsxs)("div",{className:"flex items-center justify-between border-t px-4 py-4",children:[(0,n.jsx)("p",{className:"text-xs text-foreground-lighter",children:"The unused amount for the remaining time of your billing cycle will be refunded as credits"}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)(K.$,{type:"default",onClick:()=>l(),"data-sentry-element":"Button","data-sentry-source-file":"ExitSurveyModal.tsx",children:"Cancel"}),(0,n.jsx)(a_.A,{projectUpdateDisabled:p,"data-sentry-element":"ProjectUpdateDisabledTooltip","data-sentry-source-file":"ExitSurveyModal.tsx",children:(0,n.jsx)(K.$,{type:"danger",className:"pointer-events-auto",loading:j,disabled:p||j,onClick:S,"data-sentry-element":"Button","data-sentry-source-file":"ExitSurveyModal.tsx",children:"Confirm downgrade"})})]})]})]})},tc=e=>{let{visible:a,onClose:t}=e,{data:s}=(0,d.s)(),r=null==s?void 0:s.slug,{data:l}=(0,a1.A)({slug:r},{enabled:a});return(0,n.jsxs)(v.A,{hideFooter:!0,visible:a,size:"medium",header:"Your organization has members who have exceeded their free project limits",onCancel:t,"data-sentry-element":"Modal","data-sentry-component":"MembersExceedLimitModal","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:[(0,n.jsx)(v.A.Content,{"data-sentry-element":"Modal.Content","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"The following members have reached their maximum limits for the number of active free plan projects within organizations where they are an administrator or owner:"}),(0,n.jsx)("ul",{className:"pl-5 text-sm list-disc text-foreground-light",children:(l||[]).map((e,a)=>(0,n.jsxs)("li",{children:[e.username||e.primary_email," (Limit: ",e.free_project_limit," free projects)"]},"member-".concat(a)))}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"These members will need to either delete, pause, or upgrade one or more of these projects before you're able to downgrade this project."})]})}),(0,n.jsx)(v.A.Separator,{"data-sentry-element":"Modal.Separator","data-sentry-source-file":"MembersExceedLimitModal.tsx"}),(0,n.jsx)(v.A.Content,{className:"flex items-center gap-2","data-sentry-element":"Modal.Content","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:(0,n.jsx)(K.$,{htmlType:"button",type:"default",onClick:t,block:!0,"data-sentry-element":"Button","data-sentry-source-file":"MembersExceedLimitModal.tsx",children:"Understood"})})]})};async function tu(e){let{payment_intent_id:a,slug:t}=e;if(!t)throw Error("Organization slug is required to confirm pending subscription change");let{data:n,error:s}=await (0,b.bE)("/platform/organizations/{slug}/billing/subscription/confirm",{params:{path:{slug:t}},body:{payment_intent_id:a}});return s&&(0,b.H4)(s),n}let tm=function(){let{onSuccess:e,onError:a,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,S.jE)();return(0,j.n)({mutationFn:e=>tu(e),async onSuccess(a,t,s){let{slug:r}=t;if(a&&"message"in a)return void x.oR.success(a.message,{dismissible:!0,duration:1e4});await new Promise(e=>setTimeout(e,2e3)),await Promise.all([n.invalidateQueries({queryKey:aC.s.orgSubscription(r)}),n.invalidateQueries({queryKey:aC.s.orgPlans(r)}),n.invalidateQueries({queryKey:aS.E.orgUsage(r)}),n.invalidateQueries({queryKey:eA.x.orgUpcomingPreview(r)}),n.invalidateQueries({queryKey:A.O.detail(r)}),n.invalidateQueries({queryKey:A.O.list()}),n.invalidateQueries({queryKey:A.O.paymentMethods(r)})]),await (null==e?void 0:e(a,t,s))},async onError(e,t,n){void 0===a?x.oR.error(e.message,{dismissible:!0,duration:1e4}):a(e,t,n)},...t})},tp=(0,y.c)(_.WS),tx={tier_pro:"the Pro plan to unlock unlimited projects, daily backups, and email support whenever you need it",tier_team:"the Team plan for SOC2, SSO, priority support and greater data and log retention",default:"to a new plan"},th={tier_free:"the Free plan with limited resources and active projects",tier_pro:"the Pro plan",default:"to a lower plan"},tg=e=>{var a,t,r,l,i,o,c,u,m,p;let{selectedTier:h,onClose:y,planMeta:v,subscriptionPreviewError:j,subscriptionPreviewIsLoading:b,subscriptionPreviewInitialized:N,subscriptionPreview:w,subscription:S,currentPlanMeta:C,projects:A}=e,{resolvedTheme:M}=(0,f.D)(),{data:I}=(0,d.s)(),[P,E]=(0,s.useState)(),[k,F]=(0,s.useState)(null),[T,L]=(0,s.useState)(!1),B=(0,s.useRef)(null),D=(null==S?void 0:S.billing_via_partner)===!0,R=null==S?void 0:S.billing_partner,z=(0,s.useMemo)(()=>({clientSecret:k,appearance:(0,Y.D)(M)}),[k,M]),U=(0,s.useMemo)(()=>{var e;return(0,a0.O8)(null==S||null==(e=S.plan)?void 0:e.id,null==v?void 0:v.id)},[v,S]),q=(0,s.useMemo)(()=>te.v.find(e=>e.id===h),[h]),O=()=>{L(!1),x.oR.success("Successfully ".concat("downgrade"===U?"downgraded":"upgraded"," subscription to ").concat(null==q?void 0:q.name,"!")),y(),window.scrollTo({top:0,left:0,behavior:"smooth"})},{mutate:G,isLoading:H}=aM({onSuccess:e=>{if(e.pending_payment_intent_secret)return void F(e.pending_payment_intent_secret);O()},onError:e=>{L(!1),x.oR.error("Unable to update subscription: ".concat(e.message))}}),{mutate:V,isLoading:W}=tm({onSuccess:()=>{O()},onError:e=>{x.oR.error("Unable to update subscription: ".concat(e.message))}}),$=async e=>{var a;F(""),(null==(a=e.paymentIntent)?void 0:a.status)==="succeeded"?await V({slug:null==I?void 0:I.slug,payment_intent_id:e.paymentIntent.id}):(L(!1),x.oR.error("Could not confirm payment. Please try again or use a different card."))},Q=async()=>{var e,a,t,n,s;if(!(null==I?void 0:I.slug))return console.error("org slug is required");if(!h)return console.error("Selected plan is required");L(!0);let r=await (null==(e=B.current)?void 0:e.createPaymentMethod());if(r?E(r.paymentMethod.id):L(!1),!r&&(null==S?void 0:S.payment_method_type)!=="invoice"&&"upgrade"===U)return;let l=(null==S||null==(a=S.plan)?void 0:a.id)==="team"&&h===_.V$.PRO?_.V$.PAYG:h;G({slug:null==I?void 0:I.slug,tier:l,paymentMethod:null==r||null==(t=r.paymentMethod)?void 0:t.id,address:null==r?void 0:r.address,tax_id:null!=(n=null==r?void 0:r.taxId)?n:void 0,billing_name:null!=(s=null==r?void 0:r.customerName)?s:void 0})},Z=(null==q?void 0:q.features)||[],X=(null==C?void 0:C.features)||[],ee="downgrade"===U?X.filter(e=>{let a="string"==typeof e?e:e[0];return!Z.some(e=>("string"==typeof e?e:e[0])===a)}):[],ea=Math.floor(Date.now()/1e3),en=(null==S?void 0:S.current_period_end)-ea,es=(null==S?void 0:S.current_period_end)-(null==S?void 0:S.current_period_start),er=(null!=(i=null==C?void 0:C.price)?i:0)*(en/es),ei=null!=(o=Number(null==q?void 0:q.priceMonthly))?o:0,eo=-((null!=(c=null==S?void 0:S.customer_balance)?c:0)/100*1),ed=Math.max(0,ei-er-eo);return(0,n.jsx)(aq.lG,{open:void 0!==h&&"tier_free"!==h,onOpenChange:e=>{H||T||W||e||y()},"data-sentry-element":"Dialog","data-sentry-component":"SubscriptionPlanUpdateDialog","data-sentry-source-file":"SubscriptionPlanUpdateDialog.tsx",children:(0,n.jsxs)(aq.Cf,{onOpenAutoFocus:e=>e.preventDefault(),size:"xlarge",className:"p-0 overflow-y-auto max-h-[1000px]","data-sentry-element":"DialogContent","data-sentry-source-file":"SubscriptionPlanUpdateDialog.tsx",children:[(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-5 h-full items-stretch",children:[(0,n.jsxs)("div",{className:"p-8 pb-8 flex flex-col xl:col-span-3",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{children:[!D&&null!=w&&"upgrade"===U&&(0,n.jsx)("div",{className:"space-y-2 mb-4",children:(0,n.jsx)(aH,{ref:B,selectedPaymentMethod:P,onSelectPaymentMethod:e=>E(e),readOnly:T||W||H})}),D&&(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsxs)("p",{className:"text-sm",children:["This organization is billed through our partner"," ",(0,a0.mS)(R),"."," ","aws"===R?(0,n.jsx)(n.Fragment,{children:"The organization's credit balance will be decreased accordingly."}):(0,n.jsx)(n.Fragment,{children:"You will be charged by them directly."})]}),D&&"fly"===R&&(null==w?void 0:w.plan_change_type)==="downgrade"&&(0,n.jsx)("p",{className:"text-sm",children:"Your organization will be downgraded at the end of your current billing cycle."})]})]}),b&&(0,n.jsxs)("div",{className:"space-y-2 mb-4 mt-2",children:[(0,n.jsx)(et.Ay,{}),(0,n.jsx)(et.Ay,{className:"w-3/4"}),(0,n.jsx)(et.Ay,{className:"w-1/2"})]}),N&&(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)("div",{className:"mt-2 mb-4 text-foreground-light text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2 border-b border-muted text-foreground",children:[(0,n.jsx)("div",{className:"py-2 pl-0",children:"Charge today"}),(0,n.jsxs)("div",{className:"py-2 pr-0 text-right",translate:"no",children:[(0,el.vv)(ed),(null==S||null==(a=S.plan)?void 0:a.id)!=="free"&&(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(eG(),{href:"/org/".concat(null==I?void 0:I.slug,"/billing#breakdown"),className:"text-sm text-brand hover:text-brand-600 transition",target:"_blank",children:"+ current spend"})]})]})]}),(null==S||null==(t=S.plan)?void 0:t.id)!=="free"&&(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2 border-b border-muted text-xs",children:[(0,n.jsxs)("div",{className:"py-2 pl-0 flex items-center gap-1",children:[(0,n.jsxs)("span",{children:["Unused Time on ",null==S||null==(r=S.plan)?void 0:r.name," Plan"]}),(0,n.jsx)(e$.I,{className:"max-w-sm",children:"Your previous plan was charged upfront, so a plan change will prorate any unused time in credits. If the prorated credits exceed the new plan charge, the excessive credits are added to your organization for future use."})]}),(0,n.jsxs)("div",{className:"py-2 pr-0 text-right",translate:"no",children:["-",(0,el.vv)(er)]})]}),eo>0&&(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2 border-b border-muted text-xs",children:[(0,n.jsxs)("div",{className:"py-2 pl-0 flex items-center gap-1",children:[(0,n.jsx)("span",{children:"Credits"}),(0,n.jsx)(e$.I,{children:"Credits will be used first before charging your card."})]}),(0,n.jsx)("div",{className:"py-2 pr-0 text-right",translate:"no",children:(0,el.vv)(eo)})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between gap-2 text-foreground-lighter text-xs",children:[(0,n.jsxs)("div",{className:"py-2 pl-0 flex items-center gap-1",children:[(0,n.jsx)("span",{children:"Monthly invoice estimate"}),(0,n.jsx)(e$.I,{side:"right",children:(0,n.jsxs)("div",{className:"w-[520px] p-6",children:[(0,n.jsx)("h3",{className:"font-medium mb-2",children:"Your new monthly invoice"}),(0,n.jsxs)("p",{className:"prose text-xs mb-2",children:["Paid projects run 24/7 without pausing. First project uses Compute Credits; additional projects start at ",(0,n.jsx)("span",{translate:"no",children:"$10"}),"/month regardless of usage."," ",(0,n.jsx)(eG(),{href:"".concat(_.aq,"/guides/platform/manage-your-usage/compute"),target:"_blank",children:"Learn more"}),"."]}),j&&(0,n.jsx)(J.A,{error:j,subject:"Failed to preview subscription."}),b&&(0,n.jsxs)("div",{className:"space-y-2 p-6",children:[(0,n.jsx)("span",{className:"text-sm",children:"Estimating monthly costs..."}),(0,n.jsx)(et.Ay,{}),(0,n.jsx)(et.Ay,{className:"w-3/4"}),(0,n.jsx)(et.Ay,{className:"w-1/2"})]}),N&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(eW.XI,{className:"[&_tr:last-child]:border-t font-mono text-xs",children:(0,n.jsxs)(eW.BF,{children:[(()=>{var e,a,t,s,r,l;let i=(null==w||null==(e=w.breakdown)?void 0:e.filter(e=>{var a;return(null==(a=e.description)?void 0:a.toLowerCase().includes("compute"))&&e.breakdown&&e.breakdown.length>0}))||[],o=null!=(r=null==w||null==(a=w.breakdown)?void 0:a.find(e=>e.description.startsWith("Compute Credits")))?r:null,d=null==w||null==(t=w.breakdown)?void 0:t.find(e=>{var a;return null==(a=e.description)?void 0:a.toLowerCase().includes("plan")}),c=i.flatMap(e=>(e.breakdown||[]).map(a=>({...a,computeType:e.description,computeCosts:Math.round(e.total_price/e.breakdown.length)}))),u=(null==w||null==(s=w.breakdown)?void 0:s.filter(e=>{var a,t;return!(null==(a=e.description)?void 0:a.toLowerCase().includes("compute"))&&!(null==(t=e.description)?void 0:t.toLowerCase().includes("plan"))}))||[];return(0,n.jsxs)(n.Fragment,{children:[c.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(eW.Hj,{className:"text-foreground-light",children:[(0,n.jsx)(eW.nA,{className:"!py-2 px-0",children:null==d?void 0:d.description}),(0,n.jsx)(eW.nA,{className:"text-right py-2 px-0",translate:"no",children:(0,el.vv)(null==d?void 0:d.total_price)})]}),(0,n.jsxs)(eW.Hj,{className:"text-foreground-light",children:[(0,n.jsx)(eW.nA,{className:"!py-2 px-0 flex items-center gap-1",children:(0,n.jsx)("span",{children:"Compute"})}),(0,n.jsx)(eW.nA,{className:"text-right py-2 px-0",translate:"no",children:(0,el.vv)(i.reduce((e,a)=>e+a.total_price,0)+(null!=(l=null==o?void 0:o.total_price)?l:0))})]}),c.map(e=>(0,n.jsx)(eW.Hj,{className:"text-foreground-light",children:(0,n.jsxs)(eW.nA,{className:"!py-2 px-0 pl-6",translate:"no",children:[e.project_name," (",e.computeType,") |"," ",(0,el.vv)(e.computeCosts)]})},e.project_ref)),o&&(0,n.jsx)(eW.Hj,{className:"text-foreground-light",children:(0,n.jsxs)(eW.nA,{className:"!py-2 px-0 pl-6",translate:"no",children:["Compute Credits |"," ",(0,el.vv)(o.total_price)]})})]}),u.map(e=>{var a;return(0,n.jsxs)(eW.Hj,{className:"text-foreground-light",children:[(0,n.jsx)(eW.nA,{className:"text-xs py-2 px-0",children:(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("span",{children:null!=(a=e.description)?a:"Unknown"}),e.breakdown&&e.breakdown.length>0&&(0,n.jsxs)(e$.I,{className:"max-w-sm",children:[(0,n.jsxs)("p",{children:["Projects using ",e.description,":"]}),(0,n.jsx)("ul",{className:"ml-6 list-disc",children:e.breakdown.map(a=>(0,n.jsx)("li",{children:a.project_name},"".concat(e.description,"-breakdown-").concat(a.project_ref)))})]})]})}),(0,n.jsx)(eW.nA,{className:"text-right text-xs py-2 px-0",translate:"no",children:(0,el.vv)(e.total_price)})]},e.description)})]})})(),(0,n.jsxs)(eW.Hj,{children:[(0,n.jsx)(eW.nA,{className:"font-medium py-2 px-0",children:"Total per month (excluding other usage)"}),(0,n.jsx)(eW.nA,{className:"text-right font-medium py-2 px-0",translate:"no",children:(0,el.vv)(null!=(m=Math.round(null!=(u=null==w||null==(l=w.breakdown)?void 0:l.reduce((e,a)=>e+a.total_price,0))?u:0))?m:0)})]})]})})})]})})]}),(0,n.jsx)("div",{className:"py-2 pr-0 text-right",translate:"no",children:(0,el.vv)(Math.round(null!=(p=null==w?void 0:w.breakdown.reduce((e,a)=>e+a.total_price,0))?p:0))})]})]})})]}),(0,n.jsxs)("div",{className:"pt-4",children:[5===A.filter(e=>e.status===_.BU.ACTIVE_HEALTHY||e.status===_.BU.COMING_UP).length&&(null==w?void 0:w.plan_change_type)!=="downgrade"&&(0,n.jsx)("div",{className:"pb-2",children:(0,n.jsx)(eg.Z,{title:"Empty organization",type:"warning",children:"This organization has no active projects. Did you select the correct organization?"})}),1===A.filter(e=>e.status===_.BU.ACTIVE_HEALTHY||e.status===_.BU.COMING_UP).length&&(null==q?void 0:q.planId)==="pro"&&"upgrade"===U&&(0,n.jsx)("div",{className:"pb-2",children:(0,n.jsxs)(eg.Z,{type:"note",children:[(0,n.jsxs)("div",{className:"text-sm prose",children:["Paid projects run 24/7 without pausing. First project uses Compute Credits; additional projects cost ",(0,n.jsx)("span",{translate:"no",children:"$10+"}),"/month regardless of usage."," "]}),(0,n.jsx)(eG(),{href:"".concat(_.aq,"/guides/platform/manage-your-usage/compute"),target:"_blank",className:"underline",children:"Learn more"})]})}),(0,n.jsx)("div",{className:"flex space-x-2",children:(0,n.jsxs)(K.$,{loading:H||T||W,disabled:b,type:"primary",onClick:Q,className:"flex-1",size:"small","data-sentry-element":"Button","data-sentry-source-file":"SubscriptionPlanUpdateDialog.tsx",children:["Confirm ","downgrade"===U?"downgrade":"upgrade"]})})]})]}),(0,n.jsxs)("div",{className:"bg-surface-100 p-8 flex flex-col border-l xl:col-span-2",children:[(0,n.jsxs)("h3",{className:"mb-8",children:["downgrade"===U?"Downgrade":"Upgrade"," ",(0,n.jsx)("span",{className:"font-bold",children:null==I?void 0:I.name})," to"," ","downgrade"===U?th[h||"default"]:tx[h||"default"]]}),"downgrade"===U?ee.length>0&&(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm mb-1",children:"Features you'll lose"}),(0,n.jsx)("p",{className:"text-xs text-foreground-light mb-4",children:"Please review carefully before downgrading."}),(0,n.jsx)("div",{className:"space-y-2 mb-4 text-foreground-light",children:ee.map(e=>(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"w-4",children:(0,n.jsx)(aB.A,{className:"h-3 w-3 text-amber-900",strokeWidth:3})}),(0,n.jsx)("p",{className:"text-sm",children:"string"==typeof e?e:e[0]})]},"string"==typeof e?e:e[0]))})]}):Z.length>0&&(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("h3",{className:"text-sm mb-4",children:"Upgrade features"}),(0,n.jsx)("div",{className:"space-y-2 mb-4 text-foreground-light",children:Z.map(e=>(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("div",{className:"w-4",children:(0,n.jsx)(e3.A,{className:"h-3 w-3 text-brand",strokeWidth:3})}),(0,n.jsxs)("div",{className:"text-sm",children:[(0,n.jsx)("p",{children:"string"==typeof e?e:e[0]}),Array.isArray(e)&&e.length>1&&(0,n.jsx)("p",{className:"text-foreground-lighter text-xs",children:e[1]})]})]},"string"==typeof e?e:e[0]))}),"free"===C.id&&"tier_free"!==h&&(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsx)(eg.Z,{type:"note",children:(0,n.jsx)("p",{children:"Please note: Existing support cases will remain in the Free support queue after your subscription is upgraded. For faster assistance under your new plan, please open a new support case once the upgrade is complete."})})})]})]})]}),tp&&k&&(0,n.jsx)(g.Elements,{stripe:tp,options:z,children:(0,n.jsx)(aD.i,{paymentIntentSecret:k,onPaymentIntentConfirm:e=>$(e),onLoadingChange:e=>L(e)})})]})})};var ty=t(86926),tf=t.n(ty),tv=t(37253),tj=t.n(tv);async function tb(e){let{orgSlug:a,prevPlan:t,currentPlan:n,reasons:s,message:r}=e,{data:l,error:i}=await (0,b.bE)("/platform/feedback/upgrade",{body:{...void 0!==a&&{orgSlug:a},...void 0!==t&&{prevPlan:t},...void 0!==n&&{currentPlan:n},reasons:s,...void 0!==r&&{additionalFeedback:r}}});return i&&(0,b.H4)(i),l}let tN=function(){let{onError:e,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,j.n)({mutationFn:e=>tb(e),async onError(a,t,n){void 0===e?x.oR.error("Failed to submit upgrade survey: ".concat(a.message)):e(a,t,n)},...a})},tw=e=>{let{visible:a,originalPlan:t,subscription:l,onClose:i}=e,{slug:o}=(0,r.g)(),[d,c]=(0,s.useState)(""),[u,m]=(0,s.useReducer)(function(e,a){return tf()(e,a.target.value)?tj()(e,a.target.value):[...e,a.target.value]},[]),p=(0,eQ.bg)(t,null==l?void 0:l.plan.id),{mutate:h,isLoading:g}=tN({onError:e=>{x.oR.error("Failed to submit survey: ".concat(e.message))},onSuccess:()=>{i(!0),window.scrollTo({top:0,left:0,behavior:"smooth"})}}),y=async()=>{var e;if(0===u.length)return x.oR.error("Please select at least one reason for upgrading your subscription");h({orgSlug:o,prevPlan:t,currentPlan:null==l||null==(e=l.plan)?void 0:e.id,reasons:u,message:d.trim()||void 0})};return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(v.A,{alignFooter:"right",size:"xlarge",loading:g,visible:a,onCancel:i,onConfirm:y,cancelText:"Skip",header:"We're excited for your upgrade","data-sentry-element":"Modal","data-sentry-source-file":"UpgradeModal.tsx",children:(0,n.jsxs)(v.A.Content,{className:"space-y-4","data-sentry-element":"Modal.Content","data-sentry-source-file":"UpgradeModal.tsx",children:[(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"What reasons motivated your decision to upgrade? Your feedback helps us improve Supabase as much as we can."}),(0,n.jsxs)("div",{className:"space-y-8 mt-6",children:[(0,n.jsx)("div",{className:"flex flex-wrap gap-2","data-toggle":"buttons",children:p.map(e=>{let a=u.find(a=>a===e);return(0,n.jsxs)("label",{className:"\n                      flex cursor-pointer items-center space-x-2 rounded-md py-1 \n                      pl-2 pr-3 text-center text-sm\n                      shadow-sm transition-all duration-100\n                      ".concat(a?" bg-foreground text-background opacity-100 hover:bg-opacity-75":" bg-border-strong text-foreground opacity-25 hover:opacity-50","\n                  "),children:[(0,n.jsx)("input",{type:"checkbox",name:"options",value:e,className:"hidden",onClick:m}),(0,n.jsx)("div",{children:e})]},e)})}),(0,n.jsx)("div",{className:"text-area-text-sm",children:(0,n.jsx)(to.A.TextArea,{id:"message",name:"message",value:d,onChange:e=>c(e.target.value),label:"Anything else that we can improve on?","data-sentry-element":"Input.TextArea","data-sentry-source-file":"UpgradeModal.tsx"})})]})]})})})},t_=()=>{var e,a;let t=(0,aX.useRouter)(),{slug:l}=(0,r.g)(),{data:o}=(0,d.s)(),{mutate:m}=(0,a7.h)(),p=(0,s.useRef)(),[x,h]=(0,s.useState)(!1),[g,y]=(0,s.useState)(!1),[f,v]=(0,s.useState)(!1),[j,b]=(0,s.useState)(),{can:N}=(0,I.Qp)(u.aG.BILLING_WRITE,"stripe.subscriptions"),{data:w}=(0,a8.C0)({slug:l}),_=(0,s.useMemo)(()=>null==w?void 0:w.pages.flatMap(e=>e.projects),[null==w?void 0:w.pages])||[],{data:S}=a3({slug:l}),C=!!(null==S?void 0:S.has_oriole_project),A=aN(),M="subscriptionPlan"===A.panelKey,P=()=>{let{panel:e,...a}=t.query;t.push({pathname:t.pathname,query:a},void 0,{shallow:!0}),A.setPanelKey(void 0)},{data:E,isSuccess:k}=(0,i.j5)({orgSlug:l}),{data:F,isLoading:T}=a9({orgSlug:l}),{data:L}=(0,a1.A)({slug:l}),{data:B,error:D,isLoading:R,isSuccess:z}=a4({tier:j,organizationSlug:l}),U=null!=(a=null==F?void 0:F.plans)?a:[],q=(L||[]).length>0&&_.filter(e=>"INACTIVE"!==e.status&&"GOING_DOWN"!==e.status).length>0;(0,s.useEffect)(()=>{if(M){var e;b(void 0);let a=Array.isArray(t.query.source)?t.query.source[0]:t.query.source,n={currentPlan:null==E||null==(e=E.plan)?void 0:e.name};a&&(n.origin=a),m({action:"studio_pricing_side_panel_opened",properties:n,groups:{organization:null!=l?l:"Unknown"}})}},[M]),(0,s.useEffect)(()=>{M&&k&&(p.current=E.plan.id)},[M,k]);let O=j?U.find(e=>e.id===j.split("tier_")[1]):null;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(aP.Ay,{hideFooter:!0,size:"xxlarge",visible:M,onCancel:()=>P(),header:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("h4",{children:["Change subscription plan for ",null==o?void 0:o.name]}),(0,n.jsx)(K.$,{asChild:!0,type:"default",icon:(0,n.jsx)(ah.A,{}),children:(0,n.jsx)("a",{href:"https://supabase.com/pricing",target:"_blank",rel:"noreferrer",children:"Pricing"})})]}),"data-sentry-element":"SidePanel","data-sentry-source-file":"PlanUpdateSidePanel.tsx",children:[o&&o.managed_by!==er.Kf.SUPABASE&&(0,n.jsx)(ea.A,{managedBy:o.managed_by,resource:"Organization plans",cta:(e=>e.managed_by===er.Kf.VERCEL_MARKETPLACE?{installationId:null==e?void 0:e.partner_id,path:"/settings",message:"Change Plan on Vercel Marketplace"}:e.managed_by===er.Kf.AWS_MARKETPLACE?{organizationSlug:null==e?void 0:e.slug}:void 0)(o)}),(0,n.jsx)(aP.Ay.Content,{"data-sentry-element":"SidePanel.Content","data-sentry-source-file":"PlanUpdateSidePanel.tsx",children:(0,n.jsx)("div",{className:"py-6 grid grid-cols-12 gap-3",children:te.v.map(e=>{var a,s,r,i;let d=U.find(a=>a.id===e.id.split("tier_")[1]),u=null!=(i=null==d?void 0:d.price)?i:0,p="downgrade"===(0,a0.O8)(null==E?void 0:E.plan.id,null==e?void 0:e.planId),x=(null==d?void 0:d.id)===(null==E||null==(a=E.plan)?void 0:a.id),h=e.features,g=e.footer,y="log-drains-empty-state"===(Array.isArray(t.query.source)?t.query.source[0]:t.query.source)&&"tier_team"===e.id;return"tier_enterprise"===e.id?(0,n.jsx)(tr,{plan:e,isCurrentPlan:x},e.id):(0,n.jsxs)("div",{className:(0,c.cn)("px-4 py-4 flex flex-col items-start justify-between","border rounded-md col-span-12 md:col-span-4 bg-surface-200",y&&"ring-4 ring-brand animate-[pulse_1.5s_ease-in-out_1] shadow-md shadow-brand/40"),children:[(0,n.jsxs)("div",{className:"w-full",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("p",{className:"text-brand text-sm uppercase",children:e.name}),x?(0,n.jsx)("div",{className:"text-xs bg-surface-300 text-foreground-light rounded px-2 py-0.5",children:"Current plan"}):e.nameBadge?(0,n.jsx)("div",{className:"text-xs bg-brand-400 text-brand-600 rounded px-2 py-0.5",children:e.nameBadge}):null]}),(0,n.jsxs)("div",{className:"mt-4 flex items-center space-x-1 mb-4",children:[(null!=u?u:0)>0&&(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:"From"}),T?(0,n.jsx)("div",{className:"h-[28px] flex items-center justify-center",children:(0,n.jsx)(et.Ay,{className:"w-[30px] h-[24px]"})}):(0,n.jsx)("p",{className:"text-foreground text-lg",translate:"no",children:(0,el.vv)(u)}),(0,n.jsx)("p",{className:"text-foreground-light text-sm",children:e.costUnit})]}),x?(0,n.jsx)(K.$,{block:!0,disabled:!0,type:"default",children:"Current plan"}):(0,n.jsxs)(eC.G,{block:!0,type:p?"default":"primary",disabled:(null==E||null==(s=E.plan)?void 0:s.id)==="enterprise"||(null==o?void 0:o.managed_by)!==er.Kf.SUPABASE&&"tier_free"!==e.id||(null==o?void 0:o.managed_by)===er.Kf.AWS_MARKETPLACE||C||!N,onClick:()=>{var a;b(e.id),m({action:"studio_pricing_plan_cta_clicked",properties:{selectedPlan:e.name,currentPlan:null==E||null==(a=E.plan)?void 0:a.name},groups:{organization:null!=l?l:"Unknown"}})},tooltip:{content:{side:"bottom",className:C?"w-96 text-center":"",text:(null==E||null==(r=E.plan)?void 0:r.id)==="enterprise"?"Reach out to us via support to update your plan from Enterprise":C?"Your organization has projects that are using the OrioleDB extension which is only available on the Free plan. Remove all OrioleDB projects before changing your plan.":N?(null==o?void 0:o.managed_by)===er.Kf.AWS_MARKETPLACE?"You cannot change the plan for an organization managed by AWS Marketplace":void 0:"You do not have permission to change the subscription plan"}},children:[p?"Downgrade":"Upgrade"," to ",e.name]}),(0,n.jsx)("div",{className:"border-t my-4"}),(0,n.jsx)("ul",{role:"list",children:h.map(e=>(0,n.jsxs)("li",{className:"flex py-2",children:[(0,n.jsx)("div",{className:"w-[12px]",children:(0,n.jsx)(e3.A,{className:"h-3 w-3 text-brand translate-y-[2.5px]","aria-hidden":"true",strokeWidth:3})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"ml-3 text-xs text-foreground-light",children:"string"==typeof e?e:e[0]}),aZ()(e)&&(0,n.jsx)("p",{className:"ml-3 text-xs text-foreground-lighter",children:e[1]})]})]},"string"==typeof e?e:e[0]))})]}),g&&(0,n.jsx)("div",{className:"border-t pt-4 mt-4",children:(0,n.jsx)("p",{className:"text-foreground-light text-xs",children:g})})]},e.id)})})})]}),(0,n.jsx)(ts,{visible:"tier_free"===j,subscription:E,onClose:()=>b(void 0),onConfirm:()=>{b(void 0),q?v(!0):h(!0)},projects:_,"data-sentry-element":"DowngradeModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"}),(0,n.jsx)(tg,{selectedTier:j,onClose:()=>b(void 0),planMeta:O,subscriptionPreviewError:D,subscriptionPreviewIsLoading:R,subscriptionPreviewInitialized:z,subscriptionPreview:B,subscription:E,projects:_,currentPlanMeta:{...U.find(e=>{var a;return e.id===(null==E||null==(a=E.plan)?void 0:a.id)}),features:(null==(e=te.v.find(e=>{var a;return e.id==="tier_".concat(null==E||null==(a=E.plan)?void 0:a.id)}))?void 0:e.features)||[]},"data-sentry-element":"SubscriptionPlanUpdateDialog","data-sentry-source-file":"PlanUpdateSidePanel.tsx"}),(0,n.jsx)(tc,{visible:f,onClose:()=>v(!1),"data-sentry-element":"MembersExceedLimitModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"}),(0,n.jsx)(td,{visible:x,projects:_,onClose:e=>{h(!1),e&&P()},"data-sentry-element":"ExitSurveyModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"}),(0,n.jsx)(tw,{visible:g,originalPlan:p.current,subscription:E,onClose:e=>{y(!1),e&&P()},"data-sentry-element":"UpgradeSurveyModal","data-sentry-source-file":"PlanUpdateSidePanel.tsx"})]})},tS=()=>{var e,a,t;let{slug:s}=(0,r.g)(),o=aN(),d=(0,r._P)("disableProjectCreationAndUpdate"),{isSuccess:c,can:m}=(0,I.Qp)(u.aG.BILLING_READ,"stripe.subscriptions"),{data:p,error:x,isLoading:h,isError:g,isSuccess:y}=(0,i.j5)({orgSlug:s},{enabled:m}),f=null==p?void 0:p.plan,v=null!=(e=null==f?void 0:f.name)?e:"Unknown",j=!d&&!["enterprise"].includes(null!=(a=null==f?void 0:f.id)?a:"");return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(l.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"Subscription.tsx",children:[(0,n.jsx)("div",{className:"col-span-12 pb-2",children:(0,n.jsx)(aQ.R,{"data-sentry-element":"Restriction","data-sentry-source-file":"Subscription.tsx"})}),(0,n.jsx)(l.xp,{"data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"Subscription.tsx",children:(0,n.jsx)("div",{className:"sticky space-y-6 top-12",children:(0,n.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,n.jsx)("p",{className:"text-foreground text-base m-0",children:"Subscription Plan"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light m-0",children:"Each organization has it's own subscription plan, billing cycle, payment methods and usage quotas."})]})})}),(0,n.jsx)(l.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"Subscription.tsx",children:c&&!m?(0,n.jsx)(ee.A,{resourceText:"view this organization's subscription"}):(0,n.jsxs)(n.Fragment,{children:[h&&(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(et.Ay,{}),(0,n.jsx)(et.Ay,{className:"w-3/4"}),(0,n.jsx)(et.Ay,{className:"w-1/2"})]}),g&&(0,n.jsx)(J.A,{subject:"Failed to retrieve subscription",error:x}),y&&(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsx)("div",{children:(0,n.jsxs)("p",{className:"text-2xl text-brand",children:[null!=(t=null==f?void 0:f.name)?t:"Unknown"," Plan"]})}),(0,n.jsxs)("div",{children:[(0,n.jsx)(a_.A,{projectUpdateDisabled:d,children:(0,n.jsx)(K.$,{type:"default",className:"pointer-events-auto",disabled:!j,onClick:()=>o.setPanelKey("subscriptionPlan"),children:"Change subscription plan"})}),!j&&(d?(0,n.jsx)(ei.F,{className:"mt-2",withIcon:!0,variant:"info",title:"Unable to update plan from ".concat(v),children:"We have temporarily disabled project and subscription changes - our engineers are working on a fix."}):(0,n.jsx)(ei.F,{withIcon:!0,className:"mt-2",variant:"info",title:"Unable to update plan from ".concat(v),actions:[(0,n.jsx)(K.$,{asChild:!0,type:"default",children:(0,n.jsx)(Q.Y,{queryParams:{category:u.S.SALES_ENQUIRY,subject:"Change plan away from ".concat(v)},children:"Contact support"})},"contact-support")],children:"Please contact us if you'd like to change your plan."}))]}),!(null==p?void 0:p.usage_billing_enabled)&&(0,n.jsx)(eg.Z,{type:"default",title:"This organization is limited by the included usage",children:(0,n.jsxs)("div",{className:"[&>p]:!leading-normal prose text-sm",children:["Projects may become unresponsive when this organization exceeds its"," ",(0,n.jsx)(eG(),{href:"/org/".concat(s,"/usage"),children:"included usage quota"}),". To scale seamlessly,"," ",(null==f?void 0:f.id)==="free"?"upgrade to a paid plan.":"you can disable Spend Cap under the Cost Control settings."]})})]})]})})]}),(0,n.jsx)(t_,{"data-sentry-element":"PlanUpdateSidePanel","data-sentry-source-file":"Subscription.tsx"})]})},tC=()=>{let{billingAccountData:e,billingPaymentMethods:a,billingCredits:t,billingInvoices:s}=(0,o.x)(["billing:account_data","billing:payment_methods","billing:credits","billing:invoices"]),{data:r}=(0,d.s)(),{data:u}=(0,i.j5)({orgSlug:null==r?void 0:r.slug}),m=!(null==u?void 0:u.billing_via_partner),p=e&&m,x=a&&m;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Vw,{"data-sentry-element":"ScaffoldContainerLegacy","data-sentry-source-file":"BillingSettings.tsx",children:(0,n.jsx)(l.Dm,{"data-sentry-element":"ScaffoldTitle","data-sentry-source-file":"BillingSettings.tsx",children:"Billing"})}),(0,n.jsx)(l.eh,{id:"subscription",className:(0,c.cn)("[&>div]:!pt-0"),"data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"BillingSettings.tsx",children:(0,n.jsx)(tS,{"data-sentry-element":"Subscription","data-sentry-source-file":"BillingSettings.tsx"})}),(0,n.jsx)(l.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"BillingSettings.tsx"}),(0,n.jsx)(l.eh,{id:"cost-control","data-sentry-element":"ScaffoldContainer","data-sentry-source-file":"BillingSettings.tsx",children:(0,n.jsx)(aT,{"data-sentry-element":"CostControl","data-sentry-source-file":"BillingSettings.tsx"})}),(0,n.jsx)(l.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"BillingSettings.tsx"}),r&&"free"!==r.plan.id&&(0,n.jsx)(l.eh,{id:"breakdown",children:(0,n.jsx)(e1,{})}),s&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.cJ,{}),(0,n.jsx)(l.eh,{id:"invoices",children:(0,n.jsx)(eq,{})})]}),x&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.cJ,{}),(0,n.jsx)(l.eh,{id:"payment-methods",children:(0,n.jsx)(ef,{})})]}),t&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.cJ,{}),(0,n.jsx)(l.eh,{id:"credits-balance",children:(0,n.jsx)(a$,{})})]}),p&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.cJ,{}),(0,n.jsx)(l.eh,{id:"email",children:(0,n.jsx)(ax,{})}),(0,n.jsx)(l.cJ,{}),(0,n.jsx)(l.eh,{id:"address",children:(0,n.jsx)(ao,{})})]})]})};var tA=t(10508),tM=t(33132),tI=t(42459);let tP=()=>{let{panel:e,slug:a}=(0,r.g)(),t=aN(),l=(0,o.x)("billing:all");return((0,s.useEffect)(()=>{if(e&&"string"==typeof e&&["subscriptionPlan","costControl"].includes(e)){var a;t.setPanelKey(e),null==(a=document.getElementById("billing-page-top"))||a.scrollIntoView({behavior:"smooth"})}},[e]),l)?(0,n.jsx)(tC,{"data-sentry-element":"BillingSettings","data-sentry-component":"OrgBillingSettings","data-sentry-source-file":"billing.tsx"}):(0,n.jsx)(tI.c,{urlBack:"/org/".concat(a)})};tP.getLayout=e=>(0,n.jsx)(tA.A,{children:(0,n.jsx)(tM.A,{children:e})});let tE=tP},79775:(e,a,t)=>{"use strict";t.d(a,{DE:()=>o,sj:()=>l,y9:()=>r});var n=t(80263),s=t(53239);let r=e=>{let{children:a,id:t,header:s,disabled:r,className:l}=e;return(0,n.jsxs)("div",{id:t,className:["grid grid-cols-12 gap-6 px-4 md:px-8 py-4 md:py-8","".concat(r?" opacity-30":" opacity-100"),"".concat(l)].join(" "),"data-sentry-component":"FormSection","data-sentry-source-file":"FormSection.tsx",children:[s,a]})},l=e=>{let{children:a,className:t="",description:s}=e;return void 0!==s?(0,n.jsxs)("div",{className:"flex flex-col space-y-2 col-span-12 lg:col-span-5 ".concat(t),children:[(0,n.jsx)("label",{className:"text-foreground text-sm",children:a}),s]}):(0,n.jsx)("label",{className:"text-foreground col-span-12 text-sm lg:col-span-5 ".concat(t),children:a})},i=()=>(0,n.jsxs)("div",{className:"flex w-full flex-col gap-2","data-sentry-component":"Shimmer","data-sentry-source-file":"FormSection.tsx",children:[(0,n.jsx)("div",{className:"shimmering-loader h-2 w-1/3 rounded"}),(0,n.jsx)("div",{className:"flex flex-col justify-between space-y-2",children:(0,n.jsx)("div",{className:"shimmering-loader h-[34px] w-2/3 rounded"})})]}),o=e=>{let{children:a,loading:t=!0,loaders:r,fullWidth:l,className:o}=e;return(0,n.jsx)("div",{className:"\n        relative col-span-12 flex flex-col gap-6 @lg:col-span-7\n        ".concat(l&&"!col-span-12","\n        ").concat(o,"\n      "),"data-sentry-component":"FormSectionContent","data-sentry-source-file":"FormSection.tsx",children:t?r?Array(r).fill(0).map((e,a)=>(0,n.jsx)(i,{},a)):s.Children.map(a,(e,a)=>(0,n.jsx)(i,{},a)):a})}},86926:(e,a,t)=>{var n=t(35902),s=t(89527),r=t(22442),l=t(80544),i=t(61741),o=Math.max;e.exports=function(e,a,t,d){e=s(e)?e:i(e),t=t&&!d?l(t):0;var c=e.length;return t<0&&(t=o(c+t,0)),r(e)?t<=c&&e.indexOf(a,t)>-1:!!c&&n(e,a,t)>-1}},88845:(e,a,t)=>{"use strict";t.d(a,{F:()=>m});var n=t(80263),s=t(53239),r=t(7981),l=t(8e3),i=t(31626),o=t(60656),d=t(80356),c=t(68152);let u={danger:(0,n.jsx)(l.A,{strokeWidth:1.5,size:18}),success:(0,n.jsx)(i.A,{strokeWidth:1.5,size:18}),warning:(0,n.jsx)(o.A,{strokeWidth:1.5,size:18}),info:(0,n.jsx)(d.A,{strokeWidth:1.5,size:18}),neutral:(0,n.jsx)(n.Fragment,{})};function m(e){let{variant:a="neutral",className:t,title:l,withIcon:i,closable:o,children:d,icon:m,actions:p}=e,x=(0,r.A)("alert"),[h,g]=(0,s.useState)(!0),y=[x.base];y.push(x.variant[a].base),t&&y.push(t);let f=[x.description,x.variant[a].description],v=[x.close];return(0,n.jsx)(n.Fragment,{children:h&&(0,n.jsxs)("div",{className:y.join(" "),children:[i?(0,n.jsx)("div",{className:x.variant[a].icon,children:i&&u[a]}):null,m&&m,(0,n.jsxs)("div",{className:"flex flex-1 items-center justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:[x.variant[a].header,x.header].join(" "),children:l}),(0,n.jsx)("div",{className:f.join(" "),children:d})]}),p]}),o&&(0,n.jsx)("button",{"aria-label":"Close alert",onClick:()=>g(!1),className:v.join(" "),children:(0,n.jsx)(c.A,{strokeWidth:2,size:16})})]})})}},94821:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/org/[slug]/billing",function(){return t(78228)}])}},e=>{e.O(0,[60858,15599,16110,44952,36538,43833,83458,27803,76984,72391,74004,40545,596,10508,48340,49510,18822,90636,46593,38792],()=>e(e.s=94821)),_N_E=e.O()}]);